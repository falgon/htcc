<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE BangPatterns, LambdaCase, OverloadedStrings, ScopedTypeVariables,
             TupleSections #-}</span><span>
</span><span id="line-3"></span><span class="hs-comment">{-|
Module      : Htcc.Parser.Parsing.Type
Description : The C languge parser and AST constructor
Copyright   : (c) roki, 2019
License     : MIT
Maintainer  : falgon53@yahoo.co.jp
Stability   : experimental
Portability : POSIX

The module of the Type parsing
-}</span><span>
</span><span id="line-14"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Htcc.Parser.Parsing.Type</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-15"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Constant</span></span><span>
</span><span id="line-16"></span><span>    </span><span class="annot"><a href="Htcc.Parser.Parsing.Type.html#ConstantResult"><span class="hs-identifier">ConstantResult</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-17"></span><span>    </span><span class="annot"><a href="Htcc.Parser.Parsing.Type.html#constantExp"><span class="hs-identifier">constantExp</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-18"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Utilities</span></span><span>
</span><span id="line-19"></span><span>    </span><span class="annot"><a href="Htcc.Parser.Parsing.Type.html#isTypeName"><span class="hs-identifier">isTypeName</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-20"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Structure and Enum</span></span><span>
</span><span id="line-21"></span><span>    </span><span class="annot"><a href="Htcc.Parser.Parsing.Type.html#takeStructFields"><span class="hs-identifier">takeStructFields</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-22"></span><span>    </span><span class="annot"><a href="Htcc.Parser.Parsing.Type.html#takeEnumFiels"><span class="hs-identifier">takeEnumFiels</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Declarations</span></span><span>
</span><span id="line-24"></span><span>    </span><span class="annot"><a href="Htcc.Parser.Parsing.Type.html#arrayDeclSuffix"><span class="hs-identifier">arrayDeclSuffix</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-25"></span><span>    </span><span class="annot"><a href="Htcc.Parser.Parsing.Type.html#absDeclaration"><span class="hs-identifier">absDeclaration</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-26"></span><span>    </span><span class="annot"><a href="Htcc.Parser.Parsing.Type.html#declaration"><span class="hs-identifier">declaration</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-27"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Type</span></span><span>
</span><span id="line-28"></span><span>    </span><span class="annot"><a href="Htcc.Parser.Parsing.Type.html#takePreType"><span class="hs-identifier">takePreType</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-29"></span><span>    </span><span class="annot"><a href="Htcc.Parser.Parsing.Type.html#takeType"><span class="hs-identifier">takeType</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-30"></span><span>    </span><span class="annot"><a href="Htcc.Parser.Parsing.Type.html#takeTypeName"><span class="hs-identifier">takeTypeName</span></a></span><span>
</span><span id="line-31"></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-32"></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Bits</span></span><span>                                       </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">shift</span></span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Bool</span></span><span>                                       </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">bool</span></span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map.Strict</span></span><span>                                 </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">M</span></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span>                                      </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fromJust</span></span><span class="hs-special">,</span><span>
</span><span id="line-37"></span><span>                                                                  </span><span class="annot"><span class="hs-identifier">fromMaybe</span></span><span class="hs-special">,</span><span>
</span><span id="line-38"></span><span>                                                                  </span><span class="annot"><span class="hs-identifier">isJust</span></span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span>                                       </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Tuple.Extra</span></span><span>                                </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">dupe</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">first</span></span><span class="hs-special">,</span><span>
</span><span id="line-41"></span><span>                                                                  </span><span class="annot"><span class="hs-identifier">uncurry3</span></span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Prelude</span></span><span>                                         </span><span class="hs-keyword">hiding</span><span>
</span><span id="line-43"></span><span>                                                                  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">toInteger</span></span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Htcc.CRules.Types.html"><span class="hs-identifier">Htcc.CRules.Types</span></a></span><span>                               </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">CT</span></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Htcc.Parser.AST.html"><span class="hs-identifier">Htcc.Parser.AST</span></a></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Htcc.Parser.ConstructionData.html"><span class="hs-identifier">Htcc.Parser.ConstructionData</span></a></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Htcc.Parser.ConstructionData.Scope.ManagedScope.html"><span class="hs-identifier">Htcc.Parser.ConstructionData.Scope.ManagedScope</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Htcc.Parser.ConstructionData.Scope.ManagedScope.html#ASTError"><span class="hs-identifier">ASTError</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Htcc.Parser.ConstructionData.Scope.Tag.html"><span class="hs-identifier">Htcc.Parser.ConstructionData.Scope.Tag</span></a></span><span>          </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">PST</span></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Htcc.Parser.ConstructionData.Scope.Typedef.html"><span class="hs-identifier">Htcc.Parser.ConstructionData.Scope.Typedef</span></a></span><span>      </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">PSD</span></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Htcc.Parser.ConstructionData.Scope.Utils.html"><span class="hs-identifier">Htcc.Parser.ConstructionData.Scope.Utils</span></a></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Htcc.Parser.ConstructionData.Scope.Utils.html#internalCE"><span class="hs-identifier">internalCE</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="hs-pragma">{-# SOURCE</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="annot"><a href="Htcc.Parser.Parsing.Core.html"><span class="hs-identifier">Htcc.Parser.Parsing.Core</span></a></span><span>                        </span><span class="hs-special">(</span><span class="annot"><a href="Htcc.Parser.Parsing.Core.html#conditional"><span class="hs-identifier">conditional</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Htcc.Parser.Utils.html"><span class="hs-identifier">Htcc.Parser.Utils</span></a></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Htcc.Tokenizer.html"><span class="hs-identifier">Htcc.Tokenizer</span></a></span><span>                                  </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">HT</span></span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Htcc.Utils.html"><span class="hs-identifier">Htcc.Utils</span></a></span><span>                                      </span><span class="hs-special">(</span><span class="annot"><a href="Htcc.Utils.Tuple.html#dropFst3"><span class="hs-identifier">dropFst3</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-56"></span><span>                                                                  </span><span class="annot"><a href="Htcc.Utils.Tuple.html#dropFst4"><span class="hs-identifier">dropFst4</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-57"></span><span>                                                                  </span><span class="annot"><a href="Htcc.Utils.Tuple.html#dropSnd3"><span class="hs-identifier">dropSnd3</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-58"></span><span>                                                                  </span><span class="annot"><a href="Htcc.Utils.Tuple.html#first3"><span class="hs-identifier">first3</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-59"></span><span>                                                                  </span><span class="annot"><a href="Htcc.Utils.html#maybe%27"><span class="hs-identifier">maybe'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-60"></span><span>                                                                  </span><span class="annot"><a href="Htcc.Utils.NaturalTransformations.html#maybeToRight"><span class="hs-identifier">maybeToRight</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-61"></span><span>                                                                  </span><span class="annot"><a href="Htcc.Utils.List.html#spanLen"><span class="hs-identifier">spanLen</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-62"></span><span>                                                                  </span><span class="annot"><a href="Htcc.Utils.html#toInteger"><span class="hs-identifier">toInteger</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-63"></span><span>                                                                  </span><span class="annot"><a href="Htcc.Utils.html#toNatural"><span class="hs-identifier">toNatural</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-64"></span><span>                                                                  </span><span class="annot"><a href="Htcc.Utils.Text.html#tshow"><span class="hs-identifier">tshow</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span>
</span><span id="line-66"></span><span class="hs-comment">-- | \[</span><span>
</span><span id="line-67"></span><span class="hs-comment">-- \begin{array}{ccc}</span><span>
</span><span id="line-68"></span><span class="hs-comment">-- \text{struct-decl}&amp;=&amp;\text{&quot;struct&quot;}\ \text{ident?}\ \left(\text{&quot;\{&quot;}\ \text{struct-member}\ \text{&quot;\}&quot;}\right)\text{?}\\</span><span>
</span><span id="line-69"></span><span class="hs-comment">-- \text{struct-member}&amp;=&amp;\text{pre-type}\ \text{declaration}\ \text{array-decl-suffix}\ \text{&quot;;&quot;}</span><span>
</span><span id="line-70"></span><span class="hs-comment">-- \end{array}</span><span>
</span><span id="line-71"></span><span class="hs-comment">-- \]</span><span>
</span><span id="line-72"></span><span id="local-6989586621679290567"><span class="annot"><a href="Htcc.Parser.Parsing.Type.html#takeStructFields"><span class="hs-identifier hs-type">takeStructFields</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621679290567"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679290567"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Read</span></span><span> </span><span class="annot"><a href="#local-6989586621679290567"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bits</span></span><span> </span><span class="annot"><a href="#local-6989586621679290567"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Htcc.Tokenizer.Token.html#TokenLC"><span class="hs-identifier hs-type">HT.TokenLC</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679290567"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Htcc.Parser.ConstructionData.Core.html#ConstructionData"><span class="hs-identifier hs-type">ConstructionData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679290567"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Htcc.Parser.ConstructionData.Scope.ManagedScope.html#ASTError"><span class="hs-identifier hs-type">ASTError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679290567"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Htcc.CRules.Types.TypeKind.html#StructMember"><span class="hs-identifier hs-type">CT.StructMember</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679290567"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Htcc.Parser.ConstructionData.Core.html#ConstructionData"><span class="hs-identifier hs-type">ConstructionData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679290567"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-73"></span><span id="takeStructFields"><span class="annot"><span class="annottext">takeStructFields :: [TokenLC i]
-&gt; ConstructionData i
-&gt; Either
     (ASTError i) (Map Text (StructMember i), ConstructionData i)
</span><a href="Htcc.Parser.Parsing.Type.html#takeStructFields"><span class="hs-identifier hs-var hs-var">takeStructFields</span></a></span></span><span> </span><span id="local-6989586621679290453"><span class="annot"><span class="annottext">tk :: [TokenLC i]
</span><a href="#local-6989586621679290453"><span class="hs-identifier hs-var">tk</span></a></span></span><span> </span><span id="local-6989586621679290452"><span class="annot"><span class="annottext">sc :: ConstructionData i
</span><a href="#local-6989586621679290452"><span class="hs-identifier hs-var">sc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TokenLC i]
-&gt; ConstructionData i
-&gt; Natural
-&gt; Either
     (ASTError i) (Map Text (StructMember i), ConstructionData i)
</span><a href="#local-6989586621679290451"><span class="hs-identifier hs-var">takeStructFields'</span></a></span><span> </span><span class="annot"><span class="annottext">[TokenLC i]
</span><a href="#local-6989586621679290453"><span class="hs-identifier hs-var">tk</span></a></span><span> </span><span class="annot"><span class="annottext">ConstructionData i
</span><a href="#local-6989586621679290452"><span class="hs-identifier hs-var">sc</span></a></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span>
</span><span id="line-74"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-75"></span><span>        </span><span id="local-6989586621679290451"><span class="annot"><span class="annottext">takeStructFields' :: [TokenLC i]
-&gt; ConstructionData i
-&gt; Natural
-&gt; Either
     (ASTError i) (Map Text (StructMember i), ConstructionData i)
</span><a href="#local-6989586621679290451"><span class="hs-identifier hs-var hs-var">takeStructFields'</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621679290450"><span class="annot"><span class="annottext">scp' :: ConstructionData i
</span><a href="#local-6989586621679290450"><span class="hs-identifier hs-var">scp'</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Map Text (StructMember i), ConstructionData i)
-&gt; Either
     (ASTError i) (Map Text (StructMember i), ConstructionData i)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Text (StructMember i)
forall k a. Map k a
</span><span class="hs-identifier hs-var">M.empty</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ConstructionData i
</span><a href="#local-6989586621679290450"><span class="hs-identifier hs-var">scp'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-76"></span><span>        </span><span class="annot"><a href="#local-6989586621679290451"><span class="hs-identifier hs-var">takeStructFields'</span></a></span><span> </span><span id="local-6989586621679290448"><span class="annot"><span class="annottext">fs :: [TokenLC i]
</span><a href="#local-6989586621679290448"><span class="hs-identifier hs-var">fs</span></a></span></span><span> </span><span id="local-6989586621679290447"><span class="annot"><span class="annottext">scp' :: ConstructionData i
</span><a href="#local-6989586621679290447"><span class="hs-identifier hs-var">scp'</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679290446"><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679290446"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Either
  (ASTError i)
  (StorageClass i, Maybe (TokenLC i), [TokenLC i],
   ConstructionData i)
-&gt; ((StorageClass i, Maybe (TokenLC i), [TokenLC i],
     ConstructionData i)
    -&gt; Either
         (ASTError i) (Map Text (StructMember i), ConstructionData i))
-&gt; Either
     (ASTError i) (Map Text (StructMember i), ConstructionData i)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">(&gt;&gt;=)</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TokenLC i]
-&gt; ConstructionData i
-&gt; Either
     (ASTError i)
     (StorageClass i, Maybe (TokenLC i), [TokenLC i],
      ConstructionData i)
forall i.
(Integral i, Show i, Read i, Bits i) =&gt;
[TokenLC i]
-&gt; ConstructionData i
-&gt; Either
     (ASTError i)
     (StorageClass i, Maybe (TokenLC i), [TokenLC i],
      ConstructionData i)
</span><a href="Htcc.Parser.Parsing.Type.html#takeType"><span class="hs-identifier hs-var">takeType</span></a></span><span> </span><span class="annot"><span class="annottext">[TokenLC i]
</span><a href="#local-6989586621679290448"><span class="hs-identifier hs-var">fs</span></a></span><span> </span><span class="annot"><span class="annottext">ConstructionData i
</span><a href="#local-6989586621679290447"><span class="hs-identifier hs-var">scp'</span></a></span><span> </span><span class="annot"><span class="annottext">Either
  (ASTError i)
  (StorageClass i, Maybe (TokenLC i), [TokenLC i],
   ConstructionData i)
-&gt; ((StorageClass i, Maybe (TokenLC i), [TokenLC i],
     ConstructionData i)
    -&gt; Either
         (ASTError i)
         (StorageClass i, Maybe (TokenLC i), [TokenLC i],
          ConstructionData i))
-&gt; Either
     (ASTError i)
     (StorageClass i, Maybe (TokenLC i), [TokenLC i],
      ConstructionData i)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">TokenLC i
-&gt; (StorageClass i, Maybe (TokenLC i), [TokenLC i],
    ConstructionData i)
-&gt; Either
     (ASTError i)
     (StorageClass i, Maybe (TokenLC i), [TokenLC i],
      ConstructionData i)
forall i a a c.
(Eq i, Show a) =&gt;
(a, a)
-&gt; (StorageClass i, Maybe (a, a), c, ConstructionData i)
-&gt; Either
     (Text, (a, a))
     (StorageClass i, Maybe (a, a), c, ConstructionData i)
</span><a href="#local-6989586621679290445"><span class="hs-identifier hs-var">validDecl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TokenLC i] -&gt; TokenLC i
forall i. Num i =&gt; [TokenLC i] -&gt; TokenLC i
</span><a href="Htcc.Tokenizer.Token.html#altEmptyToken"><span class="hs-identifier hs-var">HT.altEmptyToken</span></a></span><span> </span><span class="annot"><span class="annottext">[TokenLC i]
</span><a href="#local-6989586621679290453"><span class="hs-identifier hs-var">tk</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(((StorageClass i, Maybe (TokenLC i), [TokenLC i],
   ConstructionData i)
  -&gt; Either
       (ASTError i) (Map Text (StructMember i), ConstructionData i))
 -&gt; Either
      (ASTError i) (Map Text (StructMember i), ConstructionData i))
-&gt; ((StorageClass i, Maybe (TokenLC i), [TokenLC i],
     ConstructionData i)
    -&gt; Either
         (ASTError i) (Map Text (StructMember i), ConstructionData i))
-&gt; Either
     (ASTError i) (Map Text (StructMember i), ConstructionData i)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-77"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621679290443"><span class="annot"><span class="annottext">ty :: StorageClass i
</span><a href="#local-6989586621679290443"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Htcc.CRules.Types.StorageClass.html#SCAuto"><span class="hs-identifier hs-type">CT.SCAuto</span></a></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Htcc.Tokenizer.Token.html#TKIdent"><span class="hs-identifier hs-type">HT.TKIdent</span></a></span><span> </span><span id="local-6989586621679290440"><span class="annot"><span class="annottext">ident :: Text
</span><a href="#local-6989586621679290440"><span class="hs-identifier hs-var">ident</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-type">HT.TKReserved</span></a></span><span> </span><span class="hs-string">&quot;;&quot;</span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679290438"><span class="annot"><span class="annottext">ds :: [TokenLC i]
</span><a href="#local-6989586621679290438"><span class="hs-identifier hs-var">ds</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679290437"><span class="annot"><span class="annottext">scp'' :: ConstructionData i
</span><a href="#local-6989586621679290437"><span class="hs-identifier hs-var">scp''</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679290436"><span class="annot"><span class="annottext">ofs :: Natural
</span><a href="#local-6989586621679290436"><span class="hs-identifier hs-var hs-var">ofs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Natural
forall i. Integral i =&gt; i -&gt; Natural
</span><a href="Htcc.Utils.html#toNatural"><span class="hs-identifier hs-var">toNatural</span></a></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Natural) -&gt; Integer -&gt; Natural
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. (Bits a, Num a, Enum a) =&gt; a -&gt; a -&gt; a
</span><a href="Htcc.CRules.Types.TypeKind.html#alignas"><span class="hs-identifier hs-var">CT.alignas</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Natural -&gt; Integer
</span><a href="Htcc.Utils.html#toInteger"><span class="hs-identifier hs-var">toInteger</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679290446"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Integer) -&gt; Integer -&gt; Integer
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Integer
</span><a href="Htcc.Utils.html#toInteger"><span class="hs-identifier hs-var">toInteger</span></a></span><span> </span><span class="annot"><span class="annottext">(Natural -&gt; Integer) -&gt; Natural -&gt; Integer
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StorageClass i -&gt; Natural
forall a. CType a =&gt; a -&gt; Natural
</span><a href="Htcc.CRules.Types.CType.html#alignof"><span class="hs-identifier hs-var">CT.alignof</span></a></span><span> </span><span class="annot"><span class="annottext">StorageClass i
</span><a href="#local-6989586621679290443"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-78"></span><span>                </span><span class="annot"><span class="annottext">(Map Text (StructMember i) -&gt; Map Text (StructMember i))
-&gt; (Map Text (StructMember i), ConstructionData i)
-&gt; (Map Text (StructMember i), ConstructionData i)
forall a a' b. (a -&gt; a') -&gt; (a, b) -&gt; (a', b)
</span><span class="hs-identifier hs-var">first</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
-&gt; StructMember i
-&gt; Map Text (StructMember i)
-&gt; Map Text (StructMember i)
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">M.insert</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679290440"><span class="hs-identifier hs-var">ident</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypeKind i -&gt; Natural -&gt; StructMember i
forall i. TypeKind i -&gt; Natural -&gt; StructMember i
</span><a href="Htcc.CRules.Types.TypeKind.html#StructMember"><span class="hs-identifier hs-var">CT.StructMember</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StorageClass i -&gt; TypeKind i
forall (a :: * -&gt; *) i. TypeKindBase a =&gt; a i -&gt; TypeKind i
</span><a href="Htcc.CRules.Types.TypeKind.html#toTypeKind"><span class="hs-identifier hs-var">CT.toTypeKind</span></a></span><span> </span><span class="annot"><span class="annottext">StorageClass i
</span><a href="#local-6989586621679290443"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679290436"><span class="hs-identifier hs-var">ofs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Map Text (StructMember i), ConstructionData i)
 -&gt; (Map Text (StructMember i), ConstructionData i))
-&gt; Either
     (ASTError i) (Map Text (StructMember i), ConstructionData i)
-&gt; Either
     (ASTError i) (Map Text (StructMember i), ConstructionData i)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[TokenLC i]
-&gt; ConstructionData i
-&gt; Natural
-&gt; Either
     (ASTError i) (Map Text (StructMember i), ConstructionData i)
</span><a href="#local-6989586621679290451"><span class="hs-identifier hs-var">takeStructFields'</span></a></span><span> </span><span class="annot"><span class="annottext">[TokenLC i]
</span><a href="#local-6989586621679290438"><span class="hs-identifier hs-var">ds</span></a></span><span> </span><span class="annot"><span class="annottext">ConstructionData i
</span><a href="#local-6989586621679290437"><span class="hs-identifier hs-var">scp''</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679290436"><span class="hs-identifier hs-var">ofs</span></a></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Natural -&gt; Natural
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Natural
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StorageClass i -&gt; Natural
forall a. CType a =&gt; a -&gt; Natural
</span><a href="Htcc.CRules.Types.CType.html#sizeof"><span class="hs-identifier hs-var">CT.sizeof</span></a></span><span> </span><span class="annot"><span class="annottext">StorageClass i
</span><a href="#local-6989586621679290443"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-79"></span><span>            </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ASTError i
-&gt; Either
     (ASTError i) (Map Text (StructMember i), ConstructionData i)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;invalid storage-class specifier&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[TokenLC i] -&gt; TokenLC i
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">[TokenLC i]
</span><a href="#local-6989586621679290448"><span class="hs-identifier hs-var">fs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span>            </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ASTError i
-&gt; Either
     (ASTError i) (Map Text (StructMember i), ConstructionData i)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;expected member name or ';' after declaration specifiers&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[TokenLC i] -&gt; TokenLC i
forall i. Num i =&gt; [TokenLC i] -&gt; TokenLC i
</span><a href="Htcc.Tokenizer.Token.html#altEmptyToken"><span class="hs-identifier hs-var">HT.altEmptyToken</span></a></span><span> </span><span class="annot"><span class="annottext">[TokenLC i]
</span><a href="#local-6989586621679290448"><span class="hs-identifier hs-var">fs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-81"></span><span>        </span><span id="local-6989586621679290445"><span class="annot"><span class="annottext">validDecl :: (a, a)
-&gt; (StorageClass i, Maybe (a, a), c, ConstructionData i)
-&gt; Either
     (Text, (a, a))
     (StorageClass i, Maybe (a, a), c, ConstructionData i)
</span><a href="#local-6989586621679290445"><span class="hs-identifier hs-var hs-var">validDecl</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679290426"><span class="annot"><span class="annottext">t :: StorageClass i
</span><a href="#local-6989586621679290426"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679290425"><span class="annot"><span class="annottext">ident :: (a, a)
</span><a href="#local-6989586621679290425"><span class="hs-identifier hs-var">ident</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679290424"><span class="annot"><span class="annottext">tks :: c
</span><a href="#local-6989586621679290424"><span class="hs-identifier hs-var">tks</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679290423"><span class="annot"><span class="annottext">scp :: ConstructionData i
</span><a href="#local-6989586621679290423"><span class="hs-identifier hs-var">scp</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Text, (a, a))
-&gt; Maybe (StorageClass i) -&gt; Either (Text, (a, a)) (StorageClass i)
forall e. e -&gt; Maybe ~&gt; Either e
</span><a href="Htcc.Utils.NaturalTransformations.html#maybeToRight"><span class="hs-identifier hs-var">maybeToRight</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;declaration with incomplete type&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(a, a)
</span><a href="#local-6989586621679290425"><span class="hs-identifier hs-var">ident</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StorageClass i -&gt; ConstructionData i -&gt; Maybe (StorageClass i)
forall i.
StorageClass i -&gt; ConstructionData i -&gt; Maybe (StorageClass i)
</span><a href="Htcc.Parser.ConstructionData.Core.html#incomplete"><span class="hs-identifier hs-var">incomplete</span></a></span><span> </span><span class="annot"><span class="annottext">StorageClass i
</span><a href="#local-6989586621679290426"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">ConstructionData i
</span><a href="#local-6989586621679290423"><span class="hs-identifier hs-var">scp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Either (Text, (a, a)) (StorageClass i)
-&gt; (StorageClass i
    -&gt; Either
         (Text, (a, a))
         (StorageClass i, Maybe (a, a), c, ConstructionData i))
-&gt; Either
     (Text, (a, a))
     (StorageClass i, Maybe (a, a), c, ConstructionData i)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679290421"><span class="annot"><span class="annottext">t' :: StorageClass i
</span><a href="#local-6989586621679290421"><span class="hs-identifier hs-var">t'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">StorageClass i -&gt; TypeKind i
forall (a :: * -&gt; *) i. TypeKindBase a =&gt; a i -&gt; TypeKind i
</span><a href="Htcc.CRules.Types.TypeKind.html#toTypeKind"><span class="hs-identifier hs-var">CT.toTypeKind</span></a></span><span> </span><span class="annot"><span class="annottext">StorageClass i
</span><a href="#local-6989586621679290426"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">TypeKind i -&gt; TypeKind i -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">TypeKind i
forall i. TypeKind i
</span><a href="Htcc.CRules.Types.TypeKind.html#CTVoid"><span class="hs-identifier hs-var">CT.CTVoid</span></a></span><span> </span><span class="hs-keyword">then</span><span>
</span><span id="line-82"></span><span>            </span><span class="annot"><span class="annottext">(Text, (a, a))
-&gt; Either
     (Text, (a, a))
     (StorageClass i, Maybe (a, a), c, ConstructionData i)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;variable or field '&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Text
forall a. Show a =&gt; a -&gt; Text
</span><a href="Htcc.Utils.Text.html#tshow"><span class="hs-identifier hs-var">tshow</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a, a) -&gt; a
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">(a, a)
</span><a href="#local-6989586621679290425"><span class="hs-identifier hs-var">ident</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="hs-string">&quot;' declarated void&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(a, a)
</span><a href="#local-6989586621679290425"><span class="hs-identifier hs-var">ident</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">(StorageClass i, Maybe (a, a), c, ConstructionData i)
-&gt; Either
     (Text, (a, a))
     (StorageClass i, Maybe (a, a), c, ConstructionData i)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StorageClass i
</span><a href="#local-6989586621679290421"><span class="hs-identifier hs-var">t'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(a, a) -&gt; Maybe (a, a)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(a, a)
</span><a href="#local-6989586621679290425"><span class="hs-identifier hs-var">ident</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679290424"><span class="hs-identifier hs-var">tks</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ConstructionData i
</span><a href="#local-6989586621679290423"><span class="hs-identifier hs-var">scp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span>        </span><span class="annot"><a href="#local-6989586621679290445"><span class="hs-identifier hs-var">validDecl</span></a></span><span> </span><span id="local-6989586621679290419"><span class="annot"><span class="annottext">errPlaceholder :: (a, a)
</span><a href="#local-6989586621679290419"><span class="hs-identifier hs-var">errPlaceholder</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679290418"><span class="annot"><span class="annottext">t :: StorageClass i
</span><a href="#local-6989586621679290418"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679290417"><span class="annot"><span class="annottext">noth :: Maybe (a, a)
</span><a href="#local-6989586621679290417"><span class="hs-identifier hs-var">noth</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679290416"><span class="annot"><span class="annottext">tks :: c
</span><a href="#local-6989586621679290416"><span class="hs-identifier hs-var">tks</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679290415"><span class="annot"><span class="annottext">scp :: ConstructionData i
</span><a href="#local-6989586621679290415"><span class="hs-identifier hs-var">scp</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Text, (a, a))
-&gt; Maybe (StorageClass i) -&gt; Either (Text, (a, a)) (StorageClass i)
forall e. e -&gt; Maybe ~&gt; Either e
</span><a href="Htcc.Utils.NaturalTransformations.html#maybeToRight"><span class="hs-identifier hs-var">maybeToRight</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;declaration with incomplete type&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(a, a)
</span><a href="#local-6989586621679290419"><span class="hs-identifier hs-var">errPlaceholder</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StorageClass i -&gt; ConstructionData i -&gt; Maybe (StorageClass i)
forall i.
StorageClass i -&gt; ConstructionData i -&gt; Maybe (StorageClass i)
</span><a href="Htcc.Parser.ConstructionData.Core.html#incomplete"><span class="hs-identifier hs-var">incomplete</span></a></span><span> </span><span class="annot"><span class="annottext">StorageClass i
</span><a href="#local-6989586621679290418"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">ConstructionData i
</span><a href="#local-6989586621679290415"><span class="hs-identifier hs-var">scp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Either (Text, (a, a)) (StorageClass i)
-&gt; (StorageClass i
    -&gt; Either
         (Text, (a, a))
         (StorageClass i, Maybe (a, a), c, ConstructionData i))
-&gt; Either
     (Text, (a, a))
     (StorageClass i, Maybe (a, a), c, ConstructionData i)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679290414"><span class="annot"><span class="annottext">t' :: StorageClass i
</span><a href="#local-6989586621679290414"><span class="hs-identifier hs-var">t'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">StorageClass i -&gt; TypeKind i
forall (a :: * -&gt; *) i. TypeKindBase a =&gt; a i -&gt; TypeKind i
</span><a href="Htcc.CRules.Types.TypeKind.html#toTypeKind"><span class="hs-identifier hs-var">CT.toTypeKind</span></a></span><span> </span><span class="annot"><span class="annottext">StorageClass i
</span><a href="#local-6989586621679290418"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">TypeKind i -&gt; TypeKind i -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">TypeKind i
forall i. TypeKind i
</span><a href="Htcc.CRules.Types.TypeKind.html#CTVoid"><span class="hs-identifier hs-var">CT.CTVoid</span></a></span><span> </span><span class="hs-keyword">then</span><span>
</span><span id="line-84"></span><span>            </span><span class="annot"><span class="annottext">(Text, (a, a))
-&gt; Either
     (Text, (a, a))
     (StorageClass i, Maybe (a, a), c, ConstructionData i)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;declarations of type void is invalid in this context&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(a, a)
</span><a href="#local-6989586621679290419"><span class="hs-identifier hs-var">errPlaceholder</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">(StorageClass i, Maybe (a, a), c, ConstructionData i)
-&gt; Either
     (Text, (a, a))
     (StorageClass i, Maybe (a, a), c, ConstructionData i)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StorageClass i
</span><a href="#local-6989586621679290414"><span class="hs-identifier hs-var">t'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe (a, a)
</span><a href="#local-6989586621679290417"><span class="hs-identifier hs-var">noth</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679290416"><span class="hs-identifier hs-var">tks</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ConstructionData i
</span><a href="#local-6989586621679290415"><span class="hs-identifier hs-var">scp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span>
</span><span id="line-86"></span><span class="hs-comment">-- | \[</span><span>
</span><span id="line-87"></span><span class="hs-comment">-- \begin{array}{ccc}</span><span>
</span><span id="line-88"></span><span class="hs-comment">-- \text{enum-specifier}&amp;=&amp;\text{&quot;enum&quot;}\ \text{ident}\ \mid\ \text{&quot;enum&quot;}\ \text{ident?}\ \text{&quot;\{&quot;}\ \text{enum-list?}\ \text{&quot;\}&quot;}\\</span><span>
</span><span id="line-89"></span><span class="hs-comment">-- \text{enum-list}&amp;=&amp;\text{enum-elem}\ \left(\text{&quot;,&quot;}\ \text{enum-elem}\right)\ast\ \text{&quot;,&quot;?}\\</span><span>
</span><span id="line-90"></span><span class="hs-comment">-- \text{enum-elem}&amp;=&amp;\text{ident}\ \left(\text{&quot;=&quot;}\ \text{const-expr}\right)\text{?}</span><span>
</span><span id="line-91"></span><span class="hs-comment">-- \end{array}</span><span>
</span><span id="line-92"></span><span class="hs-comment">-- \]</span><span>
</span><span id="line-93"></span><span id="local-6989586621679290555"><span class="annot"><a href="Htcc.Parser.Parsing.Type.html#takeEnumFiels"><span class="hs-identifier hs-type">takeEnumFiels</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621679290555"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679290555"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Read</span></span><span> </span><span class="annot"><a href="#local-6989586621679290555"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bits</span></span><span> </span><span class="annot"><a href="#local-6989586621679290555"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Htcc.CRules.Types.StorageClass.html#StorageClass"><span class="hs-identifier hs-type">CT.StorageClass</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679290555"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Htcc.Tokenizer.Token.html#TokenLC"><span class="hs-identifier hs-type">HT.TokenLC</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679290555"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Htcc.Parser.ConstructionData.Core.html#ConstructionData"><span class="hs-identifier hs-type">ConstructionData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679290555"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Htcc.Parser.ConstructionData.Scope.ManagedScope.html#ASTError"><span class="hs-identifier hs-type">ASTError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679290555"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="annot"><a href="#local-6989586621679290555"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Htcc.Parser.ConstructionData.Core.html#ConstructionData"><span class="hs-identifier hs-type">ConstructionData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679290555"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-94"></span><span id="takeEnumFiels"><span class="annot"><span class="annottext">takeEnumFiels :: StorageClass i
-&gt; [TokenLC i]
-&gt; ConstructionData i
-&gt; Either (ASTError i) (Map Text i, ConstructionData i)
</span><a href="Htcc.Parser.Parsing.Type.html#takeEnumFiels"><span class="hs-identifier hs-var hs-var">takeEnumFiels</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">i
-&gt; StorageClass i
-&gt; [TokenLC i]
-&gt; ConstructionData i
-&gt; Either (ASTError i) (Map Text i, ConstructionData i)
forall i.
(Bits i, Integral i, Show i, Read i) =&gt;
i
-&gt; StorageClass i
-&gt; [(TokenLCNums i, Token i)]
-&gt; ConstructionData i
-&gt; Either (ASTError i) (Map Text i, ConstructionData i)
</span><a href="#local-6989586621679290413"><span class="hs-identifier hs-var">takeEnumFiels'</span></a></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span>
</span><span id="line-95"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-96"></span><span>        </span><span id="local-6989586621679290413"><span class="annot"><span class="annottext">takeEnumFiels' :: i
-&gt; StorageClass i
-&gt; [(TokenLCNums i, Token i)]
-&gt; ConstructionData i
-&gt; Either (ASTError i) (Map Text i, ConstructionData i)
</span><a href="#local-6989586621679290413"><span class="hs-identifier hs-var hs-var">takeEnumFiels'</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679290412"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679290412"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679290411"><span class="annot"><span class="annottext">ty :: StorageClass i
</span><a href="#local-6989586621679290411"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679290410"><span class="annot"><span class="annottext">cur :: (TokenLCNums i, Token i)
</span><a href="#local-6989586621679290410"><span class="hs-identifier hs-var">cur</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Htcc.Tokenizer.Token.html#TKIdent"><span class="hs-identifier hs-type">HT.TKIdent</span></a></span><span> </span><span id="local-6989586621679290409"><span class="annot"><span class="annottext">ident :: Text
</span><a href="#local-6989586621679290409"><span class="hs-identifier hs-var">ident</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span id="local-6989586621679290408"><span class="annot"><span class="annottext">scp :: ConstructionData i
</span><a href="#local-6989586621679290408"><span class="hs-identifier hs-var">scp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; i -&gt; Map Text i
forall k a. k -&gt; a -&gt; Map k a
</span><span class="hs-identifier hs-var">M.singleton</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679290409"><span class="hs-identifier hs-var">ident</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679290412"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ConstructionData i -&gt; (Map Text i, ConstructionData i))
-&gt; Either (ASTError i) (ConstructionData i)
-&gt; Either (ASTError i) (Map Text i, ConstructionData i)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">StorageClass i
-&gt; (TokenLCNums i, Token i)
-&gt; i
-&gt; ConstructionData i
-&gt; Either (ASTError i) (ConstructionData i)
forall i.
Num i =&gt;
StorageClass i
-&gt; TokenLC i
-&gt; i
-&gt; ConstructionData i
-&gt; Either (ASTError i) (ConstructionData i)
</span><a href="Htcc.Parser.ConstructionData.Core.html#addEnumerator"><span class="hs-identifier hs-var">addEnumerator</span></a></span><span> </span><span class="annot"><span class="annottext">StorageClass i
</span><a href="#local-6989586621679290411"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">(TokenLCNums i, Token i)
</span><a href="#local-6989586621679290410"><span class="hs-identifier hs-var">cur</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679290412"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">ConstructionData i
</span><a href="#local-6989586621679290408"><span class="hs-identifier hs-var">scp</span></a></span><span>
</span><span id="line-97"></span><span>        </span><span class="annot"><a href="#local-6989586621679290413"><span class="hs-identifier hs-var">takeEnumFiels'</span></a></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679290405"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679290405"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679290404"><span class="annot"><span class="annottext">ty :: StorageClass i
</span><a href="#local-6989586621679290404"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679290403"><span class="annot"><span class="annottext">cur :: (TokenLCNums i, Token i)
</span><a href="#local-6989586621679290403"><span class="hs-identifier hs-var">cur</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Htcc.Tokenizer.Token.html#TKIdent"><span class="hs-identifier hs-type">HT.TKIdent</span></a></span><span> </span><span id="local-6989586621679290402"><span class="annot"><span class="annottext">ident :: Text
</span><a href="#local-6989586621679290402"><span class="hs-identifier hs-var">ident</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-type">HT.TKReserved</span></a></span><span> </span><span class="hs-string">&quot;,&quot;</span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679290401"><span class="annot"><span class="annottext">xs :: [(TokenLCNums i, Token i)]
</span><a href="#local-6989586621679290401"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679290400"><span class="annot"><span class="annottext">scp :: ConstructionData i
</span><a href="#local-6989586621679290400"><span class="hs-identifier hs-var">scp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Either (ASTError i) (Map Text i, ConstructionData i)
-&gt; ((Map Text i, ConstructionData i)
    -&gt; Either (ASTError i) (Map Text i, ConstructionData i))
-&gt; Either (ASTError i) (Map Text i, ConstructionData i)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">(&gt;&gt;=)</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
-&gt; StorageClass i
-&gt; [(TokenLCNums i, Token i)]
-&gt; ConstructionData i
-&gt; Either (ASTError i) (Map Text i, ConstructionData i)
</span><a href="#local-6989586621679290413"><span class="hs-identifier hs-var">takeEnumFiels'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i -&gt; i
forall a. Enum a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">succ</span></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679290405"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StorageClass i
</span><a href="#local-6989586621679290404"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">[(TokenLCNums i, Token i)]
</span><a href="#local-6989586621679290401"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">ConstructionData i
</span><a href="#local-6989586621679290400"><span class="hs-identifier hs-var">scp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(((Map Text i, ConstructionData i)
  -&gt; Either (ASTError i) (Map Text i, ConstructionData i))
 -&gt; Either (ASTError i) (Map Text i, ConstructionData i))
-&gt; ((Map Text i, ConstructionData i)
    -&gt; Either (ASTError i) (Map Text i, ConstructionData i))
-&gt; Either (ASTError i) (Map Text i, ConstructionData i)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679290398"><span class="annot"><span class="annottext">m :: Map Text i
</span><a href="#local-6989586621679290398"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679290397"><span class="annot"><span class="annottext">scp' :: ConstructionData i
</span><a href="#local-6989586621679290397"><span class="hs-identifier hs-var">scp'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-98"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; i -&gt; Map Text i -&gt; Map Text i
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">M.insert</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679290402"><span class="hs-identifier hs-var">ident</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679290405"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Map Text i
</span><a href="#local-6989586621679290398"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ConstructionData i -&gt; (Map Text i, ConstructionData i))
-&gt; Either (ASTError i) (ConstructionData i)
-&gt; Either (ASTError i) (Map Text i, ConstructionData i)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">StorageClass i
-&gt; (TokenLCNums i, Token i)
-&gt; i
-&gt; ConstructionData i
-&gt; Either (ASTError i) (ConstructionData i)
forall i.
Num i =&gt;
StorageClass i
-&gt; TokenLC i
-&gt; i
-&gt; ConstructionData i
-&gt; Either (ASTError i) (ConstructionData i)
</span><a href="Htcc.Parser.ConstructionData.Core.html#addEnumerator"><span class="hs-identifier hs-var">addEnumerator</span></a></span><span> </span><span class="annot"><span class="annottext">StorageClass i
</span><a href="#local-6989586621679290404"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">(TokenLCNums i, Token i)
</span><a href="#local-6989586621679290403"><span class="hs-identifier hs-var">cur</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679290405"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">ConstructionData i
</span><a href="#local-6989586621679290397"><span class="hs-identifier hs-var">scp'</span></a></span><span>
</span><span id="line-99"></span><span>        </span><span class="annot"><a href="#local-6989586621679290413"><span class="hs-identifier hs-var">takeEnumFiels'</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679290396"><span class="annot"><span class="annottext">ty :: StorageClass i
</span><a href="#local-6989586621679290396"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679290395"><span class="annot"><span class="annottext">cur :: (TokenLCNums i, Token i)
</span><a href="#local-6989586621679290395"><span class="hs-identifier hs-var">cur</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Htcc.Tokenizer.Token.html#TKIdent"><span class="hs-identifier hs-type">HT.TKIdent</span></a></span><span> </span><span id="local-6989586621679290394"><span class="annot"><span class="annottext">ident :: Text
</span><a href="#local-6989586621679290394"><span class="hs-identifier hs-var">ident</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-type">HT.TKReserved</span></a></span><span> </span><span class="hs-string">&quot;=&quot;</span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679290393"><span class="annot"><span class="annottext">xs :: [(TokenLCNums i, Token i)]
</span><a href="#local-6989586621679290393"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679290392"><span class="annot"><span class="annottext">scp :: ConstructionData i
</span><a href="#local-6989586621679290392"><span class="hs-identifier hs-var">scp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[(TokenLCNums i, Token i)]
-&gt; ConstructionData i
-&gt; Either (ConstantResult i) ([(TokenLCNums i, Token i)], i)
forall i.
(Bits i, Integral i, Show i, Read i) =&gt;
[TokenLC i]
-&gt; ConstructionData i -&gt; Either (ConstantResult i) ([TokenLC i], i)
</span><a href="Htcc.Parser.Parsing.Type.html#constantExp"><span class="hs-identifier hs-var">constantExp</span></a></span><span> </span><span class="annot"><span class="annottext">[(TokenLCNums i, Token i)]
</span><a href="#local-6989586621679290393"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">ConstructionData i
</span><a href="#local-6989586621679290392"><span class="hs-identifier hs-var">scp</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-100"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679290391"><span class="annot"><span class="annottext">err :: ASTError i
</span><a href="#local-6989586621679290391"><span class="hs-identifier hs-var">err</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ASTError i -&gt; Either (ASTError i) (Map Text i, ConstructionData i)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">ASTError i
</span><a href="#local-6989586621679290391"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-101"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ASTError i -&gt; Either (ASTError i) (Map Text i, ConstructionData i)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;The enumerator value for '&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Token i -&gt; Text
forall a. Show a =&gt; a -&gt; Text
</span><a href="Htcc.Utils.Text.html#tshow"><span class="hs-identifier hs-var">tshow</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(TokenLCNums i, Token i) -&gt; Token i
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">(TokenLCNums i, Token i)
</span><a href="#local-6989586621679290395"><span class="hs-identifier hs-var">cur</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="hs-string">&quot;' is not an integer constant&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(TokenLCNums i, Token i)
</span><a href="#local-6989586621679290395"><span class="hs-identifier hs-var">cur</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-102"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-type">HT.TKReserved</span></a></span><span> </span><span class="hs-string">&quot;,&quot;</span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679290390"><span class="annot"><span class="annottext">ds :: [(TokenLCNums i, Token i)]
</span><a href="#local-6989586621679290390"><span class="hs-identifier hs-var">ds</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679290389"><span class="annot"><span class="annottext">val :: i
</span><a href="#local-6989586621679290389"><span class="hs-identifier hs-var">val</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either (ASTError i) (Map Text i, ConstructionData i)
-&gt; ((Map Text i, ConstructionData i)
    -&gt; Either (ASTError i) (Map Text i, ConstructionData i))
-&gt; Either (ASTError i) (Map Text i, ConstructionData i)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">(&gt;&gt;=)</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
-&gt; StorageClass i
-&gt; [(TokenLCNums i, Token i)]
-&gt; ConstructionData i
-&gt; Either (ASTError i) (Map Text i, ConstructionData i)
</span><a href="#local-6989586621679290413"><span class="hs-identifier hs-var">takeEnumFiels'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i -&gt; i
forall a. Enum a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">succ</span></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679290389"><span class="hs-identifier hs-var">val</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StorageClass i
</span><a href="#local-6989586621679290396"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">[(TokenLCNums i, Token i)]
</span><a href="#local-6989586621679290390"><span class="hs-identifier hs-var">ds</span></a></span><span> </span><span class="annot"><span class="annottext">ConstructionData i
</span><a href="#local-6989586621679290392"><span class="hs-identifier hs-var">scp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(((Map Text i, ConstructionData i)
  -&gt; Either (ASTError i) (Map Text i, ConstructionData i))
 -&gt; Either (ASTError i) (Map Text i, ConstructionData i))
-&gt; ((Map Text i, ConstructionData i)
    -&gt; Either (ASTError i) (Map Text i, ConstructionData i))
-&gt; Either (ASTError i) (Map Text i, ConstructionData i)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679290388"><span class="annot"><span class="annottext">m :: Map Text i
</span><a href="#local-6989586621679290388"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679290387"><span class="annot"><span class="annottext">scp' :: ConstructionData i
</span><a href="#local-6989586621679290387"><span class="hs-identifier hs-var">scp'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-103"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; i -&gt; Map Text i -&gt; Map Text i
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">M.insert</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679290394"><span class="hs-identifier hs-var">ident</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679290389"><span class="hs-identifier hs-var">val</span></a></span><span> </span><span class="annot"><span class="annottext">Map Text i
</span><a href="#local-6989586621679290388"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ConstructionData i -&gt; (Map Text i, ConstructionData i))
-&gt; Either (ASTError i) (ConstructionData i)
-&gt; Either (ASTError i) (Map Text i, ConstructionData i)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">StorageClass i
-&gt; (TokenLCNums i, Token i)
-&gt; i
-&gt; ConstructionData i
-&gt; Either (ASTError i) (ConstructionData i)
forall i.
Num i =&gt;
StorageClass i
-&gt; TokenLC i
-&gt; i
-&gt; ConstructionData i
-&gt; Either (ASTError i) (ConstructionData i)
</span><a href="Htcc.Parser.ConstructionData.Core.html#addEnumerator"><span class="hs-identifier hs-var">addEnumerator</span></a></span><span> </span><span class="annot"><span class="annottext">StorageClass i
</span><a href="#local-6989586621679290396"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">(TokenLCNums i, Token i)
</span><a href="#local-6989586621679290395"><span class="hs-identifier hs-var">cur</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679290389"><span class="hs-identifier hs-var">val</span></a></span><span> </span><span class="annot"><span class="annottext">ConstructionData i
</span><a href="#local-6989586621679290387"><span class="hs-identifier hs-var">scp'</span></a></span><span>
</span><span id="line-104"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679290386"><span class="annot"><span class="annottext">ds :: [(TokenLCNums i, Token i)]
</span><a href="#local-6989586621679290386"><span class="hs-identifier hs-var">ds</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679290385"><span class="annot"><span class="annottext">val :: i
</span><a href="#local-6989586621679290385"><span class="hs-identifier hs-var">val</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either (ASTError i) (Map Text i, ConstructionData i)
-&gt; ((Map Text i, ConstructionData i)
    -&gt; Either (ASTError i) (Map Text i, ConstructionData i))
-&gt; Either (ASTError i) (Map Text i, ConstructionData i)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">(&gt;&gt;=)</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
-&gt; StorageClass i
-&gt; [(TokenLCNums i, Token i)]
-&gt; ConstructionData i
-&gt; Either (ASTError i) (Map Text i, ConstructionData i)
</span><a href="#local-6989586621679290413"><span class="hs-identifier hs-var">takeEnumFiels'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i -&gt; i
forall a. Enum a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">succ</span></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679290385"><span class="hs-identifier hs-var">val</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StorageClass i
</span><a href="#local-6989586621679290396"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">[(TokenLCNums i, Token i)]
</span><a href="#local-6989586621679290386"><span class="hs-identifier hs-var">ds</span></a></span><span> </span><span class="annot"><span class="annottext">ConstructionData i
</span><a href="#local-6989586621679290392"><span class="hs-identifier hs-var">scp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(((Map Text i, ConstructionData i)
  -&gt; Either (ASTError i) (Map Text i, ConstructionData i))
 -&gt; Either (ASTError i) (Map Text i, ConstructionData i))
-&gt; ((Map Text i, ConstructionData i)
    -&gt; Either (ASTError i) (Map Text i, ConstructionData i))
-&gt; Either (ASTError i) (Map Text i, ConstructionData i)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679290384"><span class="annot"><span class="annottext">m :: Map Text i
</span><a href="#local-6989586621679290384"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679290383"><span class="annot"><span class="annottext">scp' :: ConstructionData i
</span><a href="#local-6989586621679290383"><span class="hs-identifier hs-var">scp'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-105"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; i -&gt; Map Text i -&gt; Map Text i
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">M.insert</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679290394"><span class="hs-identifier hs-var">ident</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679290385"><span class="hs-identifier hs-var">val</span></a></span><span> </span><span class="annot"><span class="annottext">Map Text i
</span><a href="#local-6989586621679290384"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ConstructionData i -&gt; (Map Text i, ConstructionData i))
-&gt; Either (ASTError i) (ConstructionData i)
-&gt; Either (ASTError i) (Map Text i, ConstructionData i)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">StorageClass i
-&gt; (TokenLCNums i, Token i)
-&gt; i
-&gt; ConstructionData i
-&gt; Either (ASTError i) (ConstructionData i)
forall i.
Num i =&gt;
StorageClass i
-&gt; TokenLC i
-&gt; i
-&gt; ConstructionData i
-&gt; Either (ASTError i) (ConstructionData i)
</span><a href="Htcc.Parser.ConstructionData.Core.html#addEnumerator"><span class="hs-identifier hs-var">addEnumerator</span></a></span><span> </span><span class="annot"><span class="annottext">StorageClass i
</span><a href="#local-6989586621679290396"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">(TokenLCNums i, Token i)
</span><a href="#local-6989586621679290395"><span class="hs-identifier hs-var">cur</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679290385"><span class="hs-identifier hs-var">val</span></a></span><span> </span><span class="annot"><span class="annottext">ConstructionData i
</span><a href="#local-6989586621679290383"><span class="hs-identifier hs-var">scp'</span></a></span><span>
</span><span id="line-106"></span><span>        </span><span class="annot"><a href="#local-6989586621679290413"><span class="hs-identifier hs-var">takeEnumFiels'</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679290382"><span class="annot"><span class="annottext">ds :: [(TokenLCNums i, Token i)]
</span><a href="#local-6989586621679290382"><span class="hs-identifier hs-var">ds</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679290381"><span class="annot"><span class="annottext">lst :: (TokenLCNums i, Token i)
</span><a href="#local-6989586621679290381"><span class="hs-identifier hs-var hs-var">lst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[(TokenLCNums i, Token i)] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[(TokenLCNums i, Token i)]
</span><a href="#local-6989586621679290382"><span class="hs-identifier hs-var">ds</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">(TokenLCNums i, Token i)
forall i. Num i =&gt; TokenLC i
</span><a href="Htcc.Tokenizer.Token.html#emptyToken"><span class="hs-identifier hs-var">HT.emptyToken</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[(TokenLCNums i, Token i)] -&gt; (TokenLCNums i, Token i)
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">last</span></span><span> </span><span class="annot"><span class="annottext">[(TokenLCNums i, Token i)]
</span><a href="#local-6989586621679290382"><span class="hs-identifier hs-var">ds</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-107"></span><span>            </span><span class="annot"><span class="annottext">ASTError i -&gt; Either (ASTError i) (Map Text i, ConstructionData i)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;expected enum identifier_opt { enumerator-list } or enum identifier_opt { enumerator-list , }&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(TokenLCNums i, Token i)
</span><a href="#local-6989586621679290381"><span class="hs-identifier hs-var">lst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-108"></span><span>
</span><span id="line-109"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Htcc.Parser.Parsing.Type.html#takeCtorPtr"><span class="hs-pragma hs-type">takeCtorPtr</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-110"></span><span id="local-6989586621679290549"><span class="annot"><a href="Htcc.Parser.Parsing.Type.html#takeCtorPtr"><span class="hs-identifier hs-type">takeCtorPtr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621679290549"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Htcc.Tokenizer.Token.html#TokenLC"><span class="hs-identifier hs-type">HT.TokenLC</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679290549"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Htcc.CRules.Types.StorageClass.html#StorageClass"><span class="hs-identifier hs-type">CT.StorageClass</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679290549"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Htcc.CRules.Types.StorageClass.html#StorageClass"><span class="hs-identifier hs-type">CT.StorageClass</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679290549"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Htcc.Tokenizer.Token.html#TokenLC"><span class="hs-identifier hs-type">HT.TokenLC</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679290549"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span></span><span>
</span><span id="line-111"></span><span id="takeCtorPtr"><span class="annot"><span class="annottext">takeCtorPtr :: [TokenLC i] -&gt; (StorageClass i -&gt; StorageClass i, [TokenLC i])
</span><a href="Htcc.Parser.Parsing.Type.html#takeCtorPtr"><span class="hs-identifier hs-var hs-var">takeCtorPtr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; StorageClass i -&gt; StorageClass i)
-&gt; (Int, [TokenLC i])
-&gt; (StorageClass i -&gt; StorageClass i, [TokenLC i])
forall a a' b. (a -&gt; a') -&gt; (a, b) -&gt; (a', b)
</span><span class="hs-identifier hs-var">first</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Natural -&gt; StorageClass i -&gt; StorageClass i
forall a. CType a =&gt; Natural -&gt; a -&gt; a
</span><a href="Htcc.CRules.Types.CType.html#ctorPtr"><span class="hs-identifier hs-var">CT.ctorPtr</span></a></span><span> </span><span class="annot"><span class="annottext">(Natural -&gt; StorageClass i -&gt; StorageClass i)
-&gt; (Int -&gt; Natural) -&gt; Int -&gt; StorageClass i -&gt; StorageClass i
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Natural
forall i. Integral i =&gt; i -&gt; Natural
</span><a href="Htcc.Utils.html#toNatural"><span class="hs-identifier hs-var">toNatural</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Int, [TokenLC i])
 -&gt; (StorageClass i -&gt; StorageClass i, [TokenLC i]))
-&gt; ([TokenLC i] -&gt; (Int, [TokenLC i]))
-&gt; [TokenLC i]
-&gt; (StorageClass i -&gt; StorageClass i, [TokenLC i])
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Int, [TokenLC i], [TokenLC i]) -&gt; (Int, [TokenLC i])
forall a b c. (a, b, c) -&gt; (a, c)
</span><a href="Htcc.Utils.Tuple.html#dropSnd3"><span class="hs-identifier hs-var">dropSnd3</span></a></span><span> </span><span class="annot"><span class="annottext">((Int, [TokenLC i], [TokenLC i]) -&gt; (Int, [TokenLC i]))
-&gt; ([TokenLC i] -&gt; (Int, [TokenLC i], [TokenLC i]))
-&gt; [TokenLC i]
-&gt; (Int, [TokenLC i])
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(TokenLC i -&gt; Bool)
-&gt; [TokenLC i] -&gt; (Int, [TokenLC i], [TokenLC i])
forall a. (a -&gt; Bool) -&gt; [a] -&gt; (Int, [a], [a])
</span><a href="Htcc.Utils.List.html#spanLen"><span class="hs-identifier hs-var">spanLen</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token i -&gt; Token i -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="annot"><span class="annottext">Text -&gt; Token i
forall i. Text -&gt; Token i
</span><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-var">HT.TKReserved</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;*&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Token i -&gt; Bool) -&gt; (TokenLC i -&gt; Token i) -&gt; TokenLC i -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TokenLC i -&gt; Token i
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span class="hs-special">)</span><span>
</span><span id="line-112"></span><span>
</span><span id="line-113"></span><span class="hs-comment">-- | It is obtained by parsing the front part of the type from the token string.</span><span>
</span><span id="line-114"></span><span class="hs-comment">-- e.g. @int (*)[4]@ applied to this function yields @int@.</span><span>
</span><span id="line-115"></span><span class="hs-comment">--</span><span>
</span><span id="line-116"></span><span class="hs-comment">-- \[\begin{array}{ccc}</span><span>
</span><span id="line-117"></span><span class="hs-comment">-- \text{pre-type}&amp;=&amp;\text{builtin-type}\ \mid\ \text{struct-decl}\ \mid\ \text{typedef-name}\ \mid\ \text{enum-specifier}\\</span><span>
</span><span id="line-118"></span><span class="hs-comment">-- \text{builtin-type}&amp;=&amp;\text{&quot;void&quot;}\ \mid\ \text{&quot;_Bool&quot;}\ \mid\ \text{&quot;char&quot;}\ \mid\ \text{&quot;short&quot;}\ \mid\ \text{&quot;int&quot;}\ \mid\ \text{&quot;long&quot;}\ \mid\ \text{&quot;long &quot;long&quot;}</span><span>
</span><span id="line-119"></span><span class="hs-comment">-- \end{array}</span><span>
</span><span id="line-120"></span><span class="hs-comment">-- \]</span><span>
</span><span id="line-121"></span><span id="local-6989586621679290576"><span class="annot"><a href="Htcc.Parser.Parsing.Type.html#takePreType"><span class="hs-identifier hs-type">takePreType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621679290576"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679290576"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Read</span></span><span> </span><span class="annot"><a href="#local-6989586621679290576"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bits</span></span><span> </span><span class="annot"><a href="#local-6989586621679290576"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Htcc.Tokenizer.Token.html#TokenLC"><span class="hs-identifier hs-type">HT.TokenLC</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679290576"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Htcc.Parser.ConstructionData.Core.html#ConstructionData"><span class="hs-identifier hs-type">ConstructionData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679290576"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Htcc.Parser.ConstructionData.Scope.ManagedScope.html#ASTError"><span class="hs-identifier hs-type">ASTError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679290576"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Htcc.CRules.Types.StorageClass.html#StorageClass"><span class="hs-identifier hs-type">CT.StorageClass</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679290576"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Htcc.Tokenizer.Token.html#TokenLC"><span class="hs-identifier hs-type">HT.TokenLC</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679290576"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Htcc.Parser.ConstructionData.Core.html#ConstructionData"><span class="hs-identifier hs-type">ConstructionData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679290576"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-122"></span><span id="takePreType"><span class="annot"><span class="annottext">takePreType :: [TokenLC i]
-&gt; ConstructionData i
-&gt; Either
     (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i)
</span><a href="Htcc.Parser.Parsing.Type.html#takePreType"><span class="hs-identifier hs-var hs-var">takePreType</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Htcc.Tokenizer.Token.html#TKType"><span class="hs-identifier hs-type">HT.TKType</span></a></span><span> </span><span id="local-6989586621679290373"><span class="annot"><span class="annottext">ty1 :: StorageClass i
</span><a href="#local-6989586621679290373"><span class="hs-identifier hs-var">ty1</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679290372"><span class="annot"><span class="annottext">y :: TokenLC i
</span><a href="#local-6989586621679290372"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621679290371"><span class="annot"><span class="annottext">iy :: TokenLCNums i
</span><a href="#local-6989586621679290371"><span class="hs-identifier hs-var">iy</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Htcc.Tokenizer.Token.html#TKType"><span class="hs-identifier hs-type">HT.TKType</span></a></span><span> </span><span id="local-6989586621679290370"><span class="annot"><span class="annottext">ty2 :: StorageClass i
</span><a href="#local-6989586621679290370"><span class="hs-identifier hs-var">ty2</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679290369"><span class="annot"><span class="annottext">xs :: [TokenLC i]
</span><a href="#local-6989586621679290369"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679290368"><span class="annot"><span class="annottext">scp :: ConstructionData i
</span><a href="#local-6989586621679290368"><span class="hs-identifier hs-var">scp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ASTError i
-&gt; Maybe (StorageClass i) -&gt; Either (ASTError i) (StorageClass i)
forall e. e -&gt; Maybe ~&gt; Either e
</span><a href="Htcc.Utils.NaturalTransformations.html#maybeToRight"><span class="hs-identifier hs-var">maybeToRight</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Text
</span><span class="hs-identifier hs-var">T.singleton</span></span><span> </span><span class="annot"><span class="hs-char">'\''</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StorageClass i -&gt; Text
forall a. Show a =&gt; a -&gt; Text
</span><a href="Htcc.Utils.Text.html#tshow"><span class="hs-identifier hs-var">tshow</span></a></span><span> </span><span class="annot"><span class="annottext">StorageClass i
</span><a href="#local-6989586621679290373"><span class="hs-identifier hs-var">ty1</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StorageClass i -&gt; Text
forall a. Show a =&gt; a -&gt; Text
</span><a href="Htcc.Utils.Text.html#tshow"><span class="hs-identifier hs-var">tshow</span></a></span><span> </span><span class="annot"><span class="annottext">StorageClass i
</span><a href="#local-6989586621679290370"><span class="hs-identifier hs-var">ty2</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="hs-string">&quot;' is invalid.&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TokenLC i
</span><a href="#local-6989586621679290372"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StorageClass i -&gt; StorageClass i -&gt; Maybe (StorageClass i)
forall a. CType a =&gt; a -&gt; a -&gt; Maybe a
</span><a href="Htcc.CRules.Types.CType.html#qualify"><span class="hs-identifier hs-var">CT.qualify</span></a></span><span> </span><span class="annot"><span class="annottext">StorageClass i
</span><a href="#local-6989586621679290373"><span class="hs-identifier hs-var">ty1</span></a></span><span> </span><span class="annot"><span class="annottext">StorageClass i
</span><a href="#local-6989586621679290370"><span class="hs-identifier hs-var">ty2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Either (ASTError i) (StorageClass i)
-&gt; (StorageClass i
    -&gt; Either
         (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i))
-&gt; Either
     (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679290365"><span class="annot"><span class="annottext">ty :: StorageClass i
</span><a href="#local-6989586621679290365"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-comment">-- for a complex type</span><span>
</span><span id="line-123"></span><span>    </span><span class="annot"><span class="annottext">[TokenLC i]
-&gt; ConstructionData i
-&gt; Either
     (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i)
forall i.
(Integral i, Show i, Read i, Bits i) =&gt;
[TokenLC i]
-&gt; ConstructionData i
-&gt; Either
     (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i)
</span><a href="Htcc.Parser.Parsing.Type.html#takePreType"><span class="hs-identifier hs-var">takePreType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">TokenLCNums i
</span><a href="#local-6989586621679290371"><span class="hs-identifier hs-var">iy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">StorageClass i -&gt; Token i
forall i. StorageClass i -&gt; Token i
</span><a href="Htcc.Tokenizer.Token.html#TKType"><span class="hs-identifier hs-var">HT.TKType</span></a></span><span> </span><span class="annot"><span class="annottext">StorageClass i
</span><a href="#local-6989586621679290365"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">TokenLC i -&gt; [TokenLC i] -&gt; [TokenLC i]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[TokenLC i]
</span><a href="#local-6989586621679290369"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ConstructionData i
</span><a href="#local-6989586621679290368"><span class="hs-identifier hs-var">scp</span></a></span><span>
</span><span id="line-124"></span><span class="annot"><a href="Htcc.Parser.Parsing.Type.html#takePreType"><span class="hs-identifier hs-var">takePreType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Htcc.Tokenizer.Token.html#TKType"><span class="hs-identifier hs-type">HT.TKType</span></a></span><span> </span><span id="local-6989586621679290364"><span class="annot"><span class="annottext">ty :: StorageClass i
</span><a href="#local-6989586621679290364"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679290363"><span class="annot"><span class="annottext">xs :: [TokenLC i]
</span><a href="#local-6989586621679290363"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679290362"><span class="annot"><span class="annottext">scp :: ConstructionData i
</span><a href="#local-6989586621679290362"><span class="hs-identifier hs-var">scp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(StorageClass i, [TokenLC i], ConstructionData i)
-&gt; Either
     (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypeKind i -&gt; StorageClass i
forall i. TypeKind i -&gt; StorageClass i
</span><a href="Htcc.CRules.Types.StorageClass.html#SCAuto"><span class="hs-identifier hs-var">CT.SCAuto</span></a></span><span> </span><span class="annot"><span class="annottext">(TypeKind i -&gt; StorageClass i) -&gt; TypeKind i -&gt; StorageClass i
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StorageClass i -&gt; TypeKind i
forall (a :: * -&gt; *) i. TypeKindBase a =&gt; a i -&gt; TypeKind i
</span><a href="Htcc.CRules.Types.TypeKind.html#toTypeKind"><span class="hs-identifier hs-var">CT.toTypeKind</span></a></span><span> </span><span class="annot"><span class="annottext">(StorageClass i -&gt; TypeKind i) -&gt; StorageClass i -&gt; TypeKind i
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StorageClass i -&gt; StorageClass i
forall a. CType a =&gt; a -&gt; a
</span><a href="Htcc.CRules.Types.CType.html#implicitInt"><span class="hs-identifier hs-var">CT.implicitInt</span></a></span><span> </span><span class="annot"><span class="annottext">StorageClass i
</span><a href="#local-6989586621679290364"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[TokenLC i]
</span><a href="#local-6989586621679290363"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ConstructionData i
</span><a href="#local-6989586621679290362"><span class="hs-identifier hs-var">scp</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- for fundamental type</span><span>
</span><span id="line-125"></span><span class="annot"><a href="Htcc.Parser.Parsing.Type.html#takePreType"><span class="hs-identifier hs-var">takePreType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Htcc.Tokenizer.Token.html#TKStruct"><span class="hs-identifier hs-type">HT.TKStruct</span></a></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679290359"><span class="annot"><span class="annottext">cur :: TokenLC i
</span><a href="#local-6989586621679290359"><span class="hs-identifier hs-var">cur</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-type">HT.TKReserved</span></a></span><span> </span><span class="hs-string">&quot;{&quot;</span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679290358"><span class="annot"><span class="annottext">xs :: [TokenLC i]
</span><a href="#local-6989586621679290358"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679290357"><span class="annot"><span class="annottext">scp :: ConstructionData i
</span><a href="#local-6989586621679290357"><span class="hs-identifier hs-var">scp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ASTError i
-&gt; Maybe (Either (TokenLC i) ([TokenLC i], [TokenLC i]))
-&gt; Either
     (ASTError i) (Either (TokenLC i) ([TokenLC i], [TokenLC i]))
forall e. e -&gt; Maybe ~&gt; Either e
</span><a href="Htcc.Utils.NaturalTransformations.html#maybeToRight"><span class="hs-identifier hs-var">maybeToRight</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><a href="Htcc.Parser.ConstructionData.Scope.Utils.html#internalCE"><span class="hs-identifier hs-var">internalCE</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TokenLC i
</span><a href="#local-6989586621679290359"><span class="hs-identifier hs-var">cur</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
-&gt; Text
-&gt; [TokenLC i]
-&gt; Maybe (Either (TokenLC i) ([TokenLC i], [TokenLC i]))
forall i.
(Integral i, Read i, Show i) =&gt;
Text
-&gt; Text
-&gt; [TokenLC i]
-&gt; Maybe (Either (TokenLC i) ([TokenLC i], [TokenLC i]))
</span><a href="Htcc.Parser.Utils.Core.html#takeBrace"><span class="hs-identifier hs-var">takeBrace</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;{&quot;</span></span><span> </span><span class="annot"><span class="hs-string">&quot;}&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TokenLC i
</span><a href="#local-6989586621679290359"><span class="hs-identifier hs-var">cur</span></a></span><span class="annot"><span class="annottext">TokenLC i -&gt; [TokenLC i] -&gt; [TokenLC i]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[TokenLC i]
</span><a href="#local-6989586621679290358"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Either (ASTError i) (Either (TokenLC i) ([TokenLC i], [TokenLC i]))
-&gt; (Either (TokenLC i) ([TokenLC i], [TokenLC i])
    -&gt; Either
         (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i))
-&gt; Either
     (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-comment">-- for @struct@ definition</span><span>
</span><span id="line-126"></span><span>    </span><span class="annot"><span class="annottext">(TokenLC i
 -&gt; Either
      (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i))
-&gt; (([TokenLC i], [TokenLC i])
    -&gt; Either
         (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i))
-&gt; Either (TokenLC i) ([TokenLC i], [TokenLC i])
-&gt; Either
     (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i)
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASTError i
-&gt; Either
     (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(ASTError i
 -&gt; Either
      (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i))
-&gt; (TokenLC i -&gt; ASTError i)
-&gt; TokenLC i
-&gt; Either
     (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;expected '}' token to match this '{'&quot;</span></span><span class="hs-special">,</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679290354"><span class="annot"><span class="annottext">field :: [TokenLC i]
</span><a href="#local-6989586621679290354"><span class="hs-identifier hs-var">field</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679290353"><span class="annot"><span class="annottext">ds :: [TokenLC i]
</span><a href="#local-6989586621679290353"><span class="hs-identifier hs-var">ds</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(StorageClass i
 -&gt; ConstructionData i
 -&gt; (StorageClass i, [TokenLC i], ConstructionData i))
-&gt; (StorageClass i, ConstructionData i)
-&gt; (StorageClass i, [TokenLC i], ConstructionData i)
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-special">,</span></span><span class="annot"><span class="annottext">[TokenLC i]
</span><a href="#local-6989586621679290353"><span class="hs-identifier hs-var">ds</span></a></span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((StorageClass i, ConstructionData i)
 -&gt; (StorageClass i, [TokenLC i], ConstructionData i))
-&gt; ((Map Text (StructMember i), ConstructionData i)
    -&gt; (StorageClass i, ConstructionData i))
-&gt; (Map Text (StructMember i), ConstructionData i)
-&gt; (StorageClass i, [TokenLC i], ConstructionData i)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Map Text (StructMember i) -&gt; StorageClass i)
-&gt; (Map Text (StructMember i), ConstructionData i)
-&gt; (StorageClass i, ConstructionData i)
forall a a' b. (a -&gt; a') -&gt; (a, b) -&gt; (a', b)
</span><span class="hs-identifier hs-var">first</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypeKind i -&gt; StorageClass i
forall i. TypeKind i -&gt; StorageClass i
</span><a href="Htcc.CRules.Types.StorageClass.html#SCAuto"><span class="hs-identifier hs-var">CT.SCAuto</span></a></span><span> </span><span class="annot"><span class="annottext">(TypeKind i -&gt; StorageClass i)
-&gt; (Map Text (StructMember i) -&gt; TypeKind i)
-&gt; Map Text (StructMember i)
-&gt; StorageClass i
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Map Text (StructMember i) -&gt; TypeKind i
forall i. Map Text (StructMember i) -&gt; TypeKind i
</span><a href="Htcc.CRules.Types.TypeKind.html#CTStruct"><span class="hs-identifier hs-var">CT.CTStruct</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Map Text (StructMember i), ConstructionData i)
 -&gt; (StorageClass i, [TokenLC i], ConstructionData i))
-&gt; Either
     (ASTError i) (Map Text (StructMember i), ConstructionData i)
-&gt; Either
     (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[TokenLC i]
-&gt; ConstructionData i
-&gt; Either
     (ASTError i) (Map Text (StructMember i), ConstructionData i)
forall i.
(Integral i, Show i, Read i, Bits i) =&gt;
[TokenLC i]
-&gt; ConstructionData i
-&gt; Either
     (ASTError i) (Map Text (StructMember i), ConstructionData i)
</span><a href="Htcc.Parser.Parsing.Type.html#takeStructFields"><span class="hs-identifier hs-var">takeStructFields</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TokenLC i] -&gt; [TokenLC i]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">tail</span></span><span> </span><span class="annot"><span class="annottext">([TokenLC i] -&gt; [TokenLC i]) -&gt; [TokenLC i] -&gt; [TokenLC i]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[TokenLC i] -&gt; [TokenLC i]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">init</span></span><span> </span><span class="annot"><span class="annottext">[TokenLC i]
</span><a href="#local-6989586621679290354"><span class="hs-identifier hs-var">field</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ConstructionData i
</span><a href="#local-6989586621679290357"><span class="hs-identifier hs-var">scp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-127"></span><span class="annot"><a href="Htcc.Parser.Parsing.Type.html#takePreType"><span class="hs-identifier hs-var">takePreType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Htcc.Tokenizer.Token.html#TKStruct"><span class="hs-identifier hs-type">HT.TKStruct</span></a></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679290348"><span class="annot"><span class="annottext">cur1 :: TokenLC i
</span><a href="#local-6989586621679290348"><span class="hs-identifier hs-var">cur1</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Htcc.Tokenizer.Token.html#TKIdent"><span class="hs-identifier hs-type">HT.TKIdent</span></a></span><span> </span><span id="local-6989586621679290347"><span class="annot"><span class="annottext">ident :: Text
</span><a href="#local-6989586621679290347"><span class="hs-identifier hs-var">ident</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679290346"><span class="annot"><span class="annottext">cur2 :: TokenLC i
</span><a href="#local-6989586621679290346"><span class="hs-identifier hs-var">cur2</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-type">HT.TKReserved</span></a></span><span> </span><span class="hs-string">&quot;{&quot;</span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679290345"><span class="annot"><span class="annottext">xs :: [TokenLC i]
</span><a href="#local-6989586621679290345"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679290344"><span class="annot"><span class="annottext">scp :: ConstructionData i
</span><a href="#local-6989586621679290344"><span class="hs-identifier hs-var">scp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Either (ASTError i) (Either (TokenLC i) ([TokenLC i], [TokenLC i]))
-&gt; (Either (TokenLC i) ([TokenLC i], [TokenLC i])
    -&gt; Either
         (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i))
-&gt; Either
     (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">(&gt;&gt;=)</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASTError i
-&gt; Maybe (Either (TokenLC i) ([TokenLC i], [TokenLC i]))
-&gt; Either
     (ASTError i) (Either (TokenLC i) ([TokenLC i], [TokenLC i]))
forall e. e -&gt; Maybe ~&gt; Either e
</span><a href="Htcc.Utils.NaturalTransformations.html#maybeToRight"><span class="hs-identifier hs-var">maybeToRight</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><a href="Htcc.Parser.ConstructionData.Scope.Utils.html#internalCE"><span class="hs-identifier hs-var">internalCE</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TokenLC i
</span><a href="#local-6989586621679290348"><span class="hs-identifier hs-var">cur1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
-&gt; Text
-&gt; [TokenLC i]
-&gt; Maybe (Either (TokenLC i) ([TokenLC i], [TokenLC i]))
forall i.
(Integral i, Read i, Show i) =&gt;
Text
-&gt; Text
-&gt; [TokenLC i]
-&gt; Maybe (Either (TokenLC i) ([TokenLC i], [TokenLC i]))
</span><a href="Htcc.Parser.Utils.Core.html#takeBrace"><span class="hs-identifier hs-var">takeBrace</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;{&quot;</span></span><span> </span><span class="annot"><span class="hs-string">&quot;}&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TokenLC i
</span><a href="#local-6989586621679290346"><span class="hs-identifier hs-var">cur2</span></a></span><span class="annot"><span class="annottext">TokenLC i -&gt; [TokenLC i] -&gt; [TokenLC i]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[TokenLC i]
</span><a href="#local-6989586621679290345"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Either (TokenLC i) ([TokenLC i], [TokenLC i])
  -&gt; Either
       (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i))
 -&gt; Either
      (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i))
-&gt; (Either (TokenLC i) ([TokenLC i], [TokenLC i])
    -&gt; Either
         (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i))
-&gt; Either
     (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-comment">-- for @struct@ definition with tag</span><span>
</span><span id="line-128"></span><span>    </span><span class="annot"><span class="annottext">(TokenLC i
 -&gt; Either
      (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i))
-&gt; (([TokenLC i], [TokenLC i])
    -&gt; Either
         (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i))
-&gt; Either (TokenLC i) ([TokenLC i], [TokenLC i])
-&gt; Either
     (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i)
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASTError i
-&gt; Either
     (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(ASTError i
 -&gt; Either
      (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i))
-&gt; (TokenLC i -&gt; ASTError i)
-&gt; TokenLC i
-&gt; Either
     (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;expected '}' token to match this '{'&quot;</span></span><span class="hs-special">,</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((([TokenLC i], [TokenLC i])
  -&gt; Either
       (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i))
 -&gt; Either (TokenLC i) ([TokenLC i], [TokenLC i])
 -&gt; Either
      (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i))
-&gt; (([TokenLC i], [TokenLC i])
    -&gt; Either
         (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i))
-&gt; Either (TokenLC i) ([TokenLC i], [TokenLC i])
-&gt; Either
     (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679290343"><span class="annot"><span class="annottext">field :: [TokenLC i]
</span><a href="#local-6989586621679290343"><span class="hs-identifier hs-var">field</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679290342"><span class="annot"><span class="annottext">ds :: [TokenLC i]
</span><a href="#local-6989586621679290342"><span class="hs-identifier hs-var">ds</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either (ASTError i) (ConstructionData i)
-&gt; (ConstructionData i
    -&gt; Either
         (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i))
-&gt; Either
     (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">(&gt;&gt;=)</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StorageClass i
-&gt; TokenLC i
-&gt; ConstructionData i
-&gt; Either (ASTError i) (ConstructionData i)
forall i.
Num i =&gt;
StorageClass i
-&gt; TokenLC i
-&gt; ConstructionData i
-&gt; Either (ASTError i) (ConstructionData i)
</span><a href="Htcc.Parser.ConstructionData.Core.html#addTag"><span class="hs-identifier hs-var">addTag</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypeKind i -&gt; StorageClass i
forall i. TypeKind i -&gt; StorageClass i
</span><a href="Htcc.CRules.Types.StorageClass.html#SCAuto"><span class="hs-identifier hs-var">CT.SCAuto</span></a></span><span> </span><span class="annot"><span class="annottext">(TypeKind i -&gt; StorageClass i) -&gt; TypeKind i -&gt; StorageClass i
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Incomplete i -&gt; TypeKind i
forall i. Incomplete i -&gt; TypeKind i
</span><a href="Htcc.CRules.Types.TypeKind.html#CTIncomplete"><span class="hs-identifier hs-var">CT.CTIncomplete</span></a></span><span> </span><span class="annot"><span class="annottext">(Incomplete i -&gt; TypeKind i) -&gt; Incomplete i -&gt; TypeKind i
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Incomplete i
forall i. Text -&gt; Incomplete i
</span><a href="Htcc.CRules.Types.TypeKind.html#IncompleteStruct"><span class="hs-identifier hs-var">CT.IncompleteStruct</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679290347"><span class="hs-identifier hs-var">ident</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TokenLC i
</span><a href="#local-6989586621679290348"><span class="hs-identifier hs-var">cur1</span></a></span><span> </span><span class="annot"><span class="annottext">ConstructionData i
</span><a href="#local-6989586621679290344"><span class="hs-identifier hs-var">scp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((ConstructionData i
  -&gt; Either
       (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i))
 -&gt; Either
      (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i))
-&gt; (ConstructionData i
    -&gt; Either
         (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i))
-&gt; Either
     (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679290338"><span class="annot"><span class="annottext">scp' :: ConstructionData i
</span><a href="#local-6989586621679290338"><span class="hs-identifier hs-var">scp'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-129"></span><span>        </span><span class="annot"><span class="annottext">Either (ASTError i) (Map Text (StructMember i), ConstructionData i)
-&gt; ((Map Text (StructMember i), ConstructionData i)
    -&gt; Either
         (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i))
-&gt; Either
     (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">(&gt;&gt;=)</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TokenLC i]
-&gt; ConstructionData i
-&gt; Either
     (ASTError i) (Map Text (StructMember i), ConstructionData i)
forall i.
(Integral i, Show i, Read i, Bits i) =&gt;
[TokenLC i]
-&gt; ConstructionData i
-&gt; Either
     (ASTError i) (Map Text (StructMember i), ConstructionData i)
</span><a href="Htcc.Parser.Parsing.Type.html#takeStructFields"><span class="hs-identifier hs-var">takeStructFields</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TokenLC i] -&gt; [TokenLC i]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">tail</span></span><span> </span><span class="annot"><span class="annottext">([TokenLC i] -&gt; [TokenLC i]) -&gt; [TokenLC i] -&gt; [TokenLC i]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[TokenLC i] -&gt; [TokenLC i]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">init</span></span><span> </span><span class="annot"><span class="annottext">[TokenLC i]
</span><a href="#local-6989586621679290343"><span class="hs-identifier hs-var">field</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ConstructionData i
</span><a href="#local-6989586621679290338"><span class="hs-identifier hs-var">scp'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(((Map Text (StructMember i), ConstructionData i)
  -&gt; Either
       (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i))
 -&gt; Either
      (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i))
-&gt; ((Map Text (StructMember i), ConstructionData i)
    -&gt; Either
         (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i))
-&gt; Either
     (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679290337"><span class="annot"><span class="annottext">mem :: Map Text (StructMember i)
</span><a href="#local-6989586621679290337"><span class="hs-identifier hs-var">mem</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679290336"><span class="annot"><span class="annottext">scp'' :: ConstructionData i
</span><a href="#local-6989586621679290336"><span class="hs-identifier hs-var">scp''</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679290335"><span class="annot"><span class="annottext">ty :: StorageClass i
</span><a href="#local-6989586621679290335"><span class="hs-identifier hs-var hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeKind i -&gt; StorageClass i
forall i. TypeKind i -&gt; StorageClass i
</span><a href="Htcc.CRules.Types.StorageClass.html#SCAuto"><span class="hs-identifier hs-var">CT.SCAuto</span></a></span><span> </span><span class="annot"><span class="annottext">(TypeKind i -&gt; StorageClass i) -&gt; TypeKind i -&gt; StorageClass i
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Map Text (StructMember i) -&gt; TypeKind i
forall i. Map Text (StructMember i) -&gt; TypeKind i
</span><a href="Htcc.CRules.Types.TypeKind.html#CTStruct"><span class="hs-identifier hs-var">CT.CTStruct</span></a></span><span> </span><span class="annot"><span class="annottext">Map Text (StructMember i)
</span><a href="#local-6989586621679290337"><span class="hs-identifier hs-var">mem</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">StorageClass i
-&gt; TokenLC i
-&gt; ConstructionData i
-&gt; Either (ASTError i) (ConstructionData i)
forall i.
Num i =&gt;
StorageClass i
-&gt; TokenLC i
-&gt; ConstructionData i
-&gt; Either (ASTError i) (ConstructionData i)
</span><a href="Htcc.Parser.ConstructionData.Core.html#addTag"><span class="hs-identifier hs-var">addTag</span></a></span><span> </span><span class="annot"><span class="annottext">StorageClass i
</span><a href="#local-6989586621679290335"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">TokenLC i
</span><a href="#local-6989586621679290348"><span class="hs-identifier hs-var">cur1</span></a></span><span> </span><span class="annot"><span class="annottext">ConstructionData i
</span><a href="#local-6989586621679290336"><span class="hs-identifier hs-var">scp''</span></a></span><span> </span><span class="annot"><span class="annottext">Either (ASTError i) (ConstructionData i)
-&gt; (ConstructionData i
    -&gt; Either
         (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i))
-&gt; Either
     (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">(StorageClass i, [TokenLC i], ConstructionData i)
-&gt; Either
     (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">((StorageClass i, [TokenLC i], ConstructionData i)
 -&gt; Either
      (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i))
-&gt; (ConstructionData i
    -&gt; (StorageClass i, [TokenLC i], ConstructionData i))
-&gt; ConstructionData i
-&gt; Either
     (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StorageClass i
</span><a href="#local-6989586621679290335"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[TokenLC i]
</span><a href="#local-6989586621679290342"><span class="hs-identifier hs-var">ds</span></a></span><span class="hs-special">,</span><span class="hs-special">)</span><span>
</span><span id="line-130"></span><span class="annot"><a href="Htcc.Parser.Parsing.Type.html#takePreType"><span class="hs-identifier hs-var">takePreType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Htcc.Tokenizer.Token.html#TKStruct"><span class="hs-identifier hs-type">HT.TKStruct</span></a></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679290334"><span class="annot"><span class="annottext">cur1 :: TokenLC i
</span><a href="#local-6989586621679290334"><span class="hs-identifier hs-var">cur1</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Htcc.Tokenizer.Token.html#TKIdent"><span class="hs-identifier hs-type">HT.TKIdent</span></a></span><span> </span><span id="local-6989586621679290333"><span class="annot"><span class="annottext">ident :: Text
</span><a href="#local-6989586621679290333"><span class="hs-identifier hs-var">ident</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679290332"><span class="annot"><span class="annottext">xs :: [TokenLC i]
</span><a href="#local-6989586621679290332"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679290331"><span class="annot"><span class="annottext">scp :: ConstructionData i
</span><a href="#local-6989586621679290331"><span class="hs-identifier hs-var">scp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Text -&gt; ConstructionData i -&gt; Maybe (Tag i)
forall i. Text -&gt; ConstructionData i -&gt; Maybe (Tag i)
</span><a href="Htcc.Parser.ConstructionData.Core.html#lookupTag"><span class="hs-identifier hs-var">lookupTag</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679290333"><span class="hs-identifier hs-var">ident</span></a></span><span> </span><span class="annot"><span class="annottext">ConstructionData i
</span><a href="#local-6989586621679290331"><span class="hs-identifier hs-var">scp</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-comment">-- for variable declaration with @struct@ tag</span><span>
</span><span id="line-131"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679290329"><span class="annot"><span class="annottext">ty :: StorageClass i
</span><a href="#local-6989586621679290329"><span class="hs-identifier hs-var hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeKind i -&gt; StorageClass i
forall i. TypeKind i -&gt; StorageClass i
</span><a href="Htcc.CRules.Types.StorageClass.html#SCAuto"><span class="hs-identifier hs-var">CT.SCAuto</span></a></span><span> </span><span class="annot"><span class="annottext">(TypeKind i -&gt; StorageClass i) -&gt; TypeKind i -&gt; StorageClass i
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Incomplete i -&gt; TypeKind i
forall i. Incomplete i -&gt; TypeKind i
</span><a href="Htcc.CRules.Types.TypeKind.html#CTIncomplete"><span class="hs-identifier hs-var">CT.CTIncomplete</span></a></span><span> </span><span class="annot"><span class="annottext">(Incomplete i -&gt; TypeKind i) -&gt; Incomplete i -&gt; TypeKind i
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Incomplete i
forall i. Text -&gt; Incomplete i
</span><a href="Htcc.CRules.Types.TypeKind.html#IncompleteStruct"><span class="hs-identifier hs-var">CT.IncompleteStruct</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679290333"><span class="hs-identifier hs-var">ident</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Either (ASTError i) (ConstructionData i)
-&gt; (ConstructionData i
    -&gt; Either
         (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i))
-&gt; Either
     (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">(&gt;&gt;=)</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StorageClass i
-&gt; TokenLC i
-&gt; ConstructionData i
-&gt; Either (ASTError i) (ConstructionData i)
forall i.
Num i =&gt;
StorageClass i
-&gt; TokenLC i
-&gt; ConstructionData i
-&gt; Either (ASTError i) (ConstructionData i)
</span><a href="Htcc.Parser.ConstructionData.Core.html#addTag"><span class="hs-identifier hs-var">addTag</span></a></span><span> </span><span class="annot"><span class="annottext">StorageClass i
forall i. StorageClass i
</span><a href="#local-6989586621679290329"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">TokenLC i
</span><a href="#local-6989586621679290334"><span class="hs-identifier hs-var">cur1</span></a></span><span> </span><span class="annot"><span class="annottext">ConstructionData i
</span><a href="#local-6989586621679290331"><span class="hs-identifier hs-var">scp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((ConstructionData i
  -&gt; Either
       (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i))
 -&gt; Either
      (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i))
-&gt; (ConstructionData i
    -&gt; Either
         (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i))
-&gt; Either
     (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679290328"><span class="annot"><span class="annottext">scp' :: ConstructionData i
</span><a href="#local-6989586621679290328"><span class="hs-identifier hs-var">scp'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(StorageClass i, [TokenLC i], ConstructionData i)
-&gt; Either
     (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StorageClass i
forall i. StorageClass i
</span><a href="#local-6989586621679290329"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[TokenLC i]
</span><a href="#local-6989586621679290332"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ConstructionData i
</span><a href="#local-6989586621679290328"><span class="hs-identifier hs-var">scp'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-132"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679290327"><span class="annot"><span class="annottext">ty :: Tag i
</span><a href="#local-6989586621679290327"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(StorageClass i, [TokenLC i], ConstructionData i)
-&gt; Either
     (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tag i -&gt; StorageClass i
forall i. Tag i -&gt; StorageClass i
</span><a href="Htcc.Parser.ConstructionData.Scope.Tag.html#sttype"><span class="hs-identifier hs-var hs-var">PST.sttype</span></a></span><span> </span><span class="annot"><span class="annottext">Tag i
</span><a href="#local-6989586621679290327"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[TokenLC i]
</span><a href="#local-6989586621679290332"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ConstructionData i
</span><a href="#local-6989586621679290331"><span class="hs-identifier hs-var">scp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-133"></span><span class="annot"><a href="Htcc.Parser.Parsing.Type.html#takePreType"><span class="hs-identifier hs-var">takePreType</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679290325"><span class="annot"><span class="annottext">cur :: TokenLC i
</span><a href="#local-6989586621679290325"><span class="hs-identifier hs-var">cur</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Htcc.Tokenizer.Token.html#TKIdent"><span class="hs-identifier hs-type">HT.TKIdent</span></a></span><span> </span><span id="local-6989586621679290324"><span class="annot"><span class="annottext">ident :: Text
</span><a href="#local-6989586621679290324"><span class="hs-identifier hs-var">ident</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679290323"><span class="annot"><span class="annottext">xs :: [TokenLC i]
</span><a href="#local-6989586621679290323"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679290322"><span class="annot"><span class="annottext">scp :: ConstructionData i
</span><a href="#local-6989586621679290322"><span class="hs-identifier hs-var">scp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-special">,</span></span><span> </span><span class="annot"><span class="annottext">[TokenLC i]
</span><a href="#local-6989586621679290323"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ConstructionData i
</span><a href="#local-6989586621679290322"><span class="hs-identifier hs-var">scp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(StorageClass i
 -&gt; (StorageClass i, [TokenLC i], ConstructionData i))
-&gt; (Typedef i -&gt; StorageClass i)
-&gt; Typedef i
-&gt; (StorageClass i, [TokenLC i], ConstructionData i)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Typedef i -&gt; StorageClass i
forall a. Typedef a -&gt; StorageClass a
</span><a href="Htcc.Parser.ConstructionData.Scope.Typedef.html#tdtype"><span class="hs-identifier hs-var hs-var">PSD.tdtype</span></a></span><span> </span><span class="annot"><span class="annottext">(Typedef i -&gt; (StorageClass i, [TokenLC i], ConstructionData i))
-&gt; Either (ASTError i) (Typedef i)
-&gt; Either
     (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ASTError i -&gt; Maybe (Typedef i) -&gt; Either (ASTError i) (Typedef i)
forall e. e -&gt; Maybe ~&gt; Either e
</span><a href="Htcc.Utils.NaturalTransformations.html#maybeToRight"><span class="hs-identifier hs-var">maybeToRight</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Text
</span><span class="hs-identifier hs-var">T.singleton</span></span><span> </span><span class="annot"><span class="hs-char">'\''</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Token i -&gt; Text
forall a. Show a =&gt; a -&gt; Text
</span><a href="Htcc.Utils.Text.html#tshow"><span class="hs-identifier hs-var">tshow</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TokenLC i -&gt; Token i
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">TokenLC i
</span><a href="#local-6989586621679290325"><span class="hs-identifier hs-var">cur</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="hs-string">&quot;' is not a type or also a typedef identifier&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TokenLC i
</span><a href="#local-6989586621679290325"><span class="hs-identifier hs-var">cur</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; ConstructionData i -&gt; Maybe (Typedef i)
forall i. Text -&gt; ConstructionData i -&gt; Maybe (Typedef i)
</span><a href="Htcc.Parser.ConstructionData.Core.html#lookupTypedef"><span class="hs-identifier hs-var">lookupTypedef</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679290324"><span class="hs-identifier hs-var">ident</span></a></span><span> </span><span class="annot"><span class="annottext">ConstructionData i
</span><a href="#local-6989586621679290322"><span class="hs-identifier hs-var">scp</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- for declaration variable with @typedef@</span><span>
</span><span id="line-134"></span><span class="annot"><a href="Htcc.Parser.Parsing.Type.html#takePreType"><span class="hs-identifier hs-var">takePreType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Htcc.Tokenizer.Token.html#TKEnum"><span class="hs-identifier hs-type">HT.TKEnum</span></a></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679290318"><span class="annot"><span class="annottext">cur :: TokenLC i
</span><a href="#local-6989586621679290318"><span class="hs-identifier hs-var">cur</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-type">HT.TKReserved</span></a></span><span> </span><span class="hs-string">&quot;{&quot;</span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679290317"><span class="annot"><span class="annottext">xs :: [TokenLC i]
</span><a href="#local-6989586621679290317"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679290316"><span class="annot"><span class="annottext">scp :: ConstructionData i
</span><a href="#local-6989586621679290316"><span class="hs-identifier hs-var">scp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Either (ASTError i) (Either (TokenLC i) ([TokenLC i], [TokenLC i]))
-&gt; (Either (TokenLC i) ([TokenLC i], [TokenLC i])
    -&gt; Either
         (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i))
-&gt; Either
     (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">(&gt;&gt;=)</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASTError i
-&gt; Maybe (Either (TokenLC i) ([TokenLC i], [TokenLC i]))
-&gt; Either
     (ASTError i) (Either (TokenLC i) ([TokenLC i], [TokenLC i]))
forall e. e -&gt; Maybe ~&gt; Either e
</span><a href="Htcc.Utils.NaturalTransformations.html#maybeToRight"><span class="hs-identifier hs-var">maybeToRight</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><a href="Htcc.Parser.ConstructionData.Scope.Utils.html#internalCE"><span class="hs-identifier hs-var">internalCE</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TokenLC i
</span><a href="#local-6989586621679290318"><span class="hs-identifier hs-var">cur</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
-&gt; Text
-&gt; [TokenLC i]
-&gt; Maybe (Either (TokenLC i) ([TokenLC i], [TokenLC i]))
forall i.
(Integral i, Read i, Show i) =&gt;
Text
-&gt; Text
-&gt; [TokenLC i]
-&gt; Maybe (Either (TokenLC i) ([TokenLC i], [TokenLC i]))
</span><a href="Htcc.Parser.Utils.Core.html#takeBrace"><span class="hs-identifier hs-var">takeBrace</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;{&quot;</span></span><span> </span><span class="annot"><span class="hs-string">&quot;}&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TokenLC i
</span><a href="#local-6989586621679290318"><span class="hs-identifier hs-var">cur</span></a></span><span class="annot"><span class="annottext">TokenLC i -&gt; [TokenLC i] -&gt; [TokenLC i]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[TokenLC i]
</span><a href="#local-6989586621679290317"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Either (TokenLC i) ([TokenLC i], [TokenLC i])
  -&gt; Either
       (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i))
 -&gt; Either
      (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i))
-&gt; (Either (TokenLC i) ([TokenLC i], [TokenLC i])
    -&gt; Either
         (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i))
-&gt; Either
     (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-comment">-- for @enum@</span><span>
</span><span id="line-135"></span><span>    </span><span class="annot"><span class="annottext">(TokenLC i
 -&gt; Either
      (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i))
-&gt; (([TokenLC i], [TokenLC i])
    -&gt; Either
         (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i))
-&gt; Either (TokenLC i) ([TokenLC i], [TokenLC i])
-&gt; Either
     (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i)
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASTError i
-&gt; Either
     (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(ASTError i
 -&gt; Either
      (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i))
-&gt; (TokenLC i -&gt; ASTError i)
-&gt; TokenLC i
-&gt; Either
     (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;expected '}' token to match this '{'&quot;</span></span><span class="hs-special">,</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((([TokenLC i], [TokenLC i])
  -&gt; Either
       (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i))
 -&gt; Either (TokenLC i) ([TokenLC i], [TokenLC i])
 -&gt; Either
      (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i))
-&gt; (([TokenLC i], [TokenLC i])
    -&gt; Either
         (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i))
-&gt; Either (TokenLC i) ([TokenLC i], [TokenLC i])
-&gt; Either
     (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679290315"><span class="annot"><span class="annottext">field :: [TokenLC i]
</span><a href="#local-6989586621679290315"><span class="hs-identifier hs-var">field</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679290314"><span class="annot"><span class="annottext">ds :: [TokenLC i]
</span><a href="#local-6989586621679290314"><span class="hs-identifier hs-var">ds</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(StorageClass i
 -&gt; ConstructionData i
 -&gt; (StorageClass i, [TokenLC i], ConstructionData i))
-&gt; (StorageClass i, ConstructionData i)
-&gt; (StorageClass i, [TokenLC i], ConstructionData i)
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-special">,</span></span><span class="annot"><span class="annottext">[TokenLC i]
</span><a href="#local-6989586621679290314"><span class="hs-identifier hs-var">ds</span></a></span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((StorageClass i, ConstructionData i)
 -&gt; (StorageClass i, [TokenLC i], ConstructionData i))
-&gt; ((Map Text i, ConstructionData i)
    -&gt; (StorageClass i, ConstructionData i))
-&gt; (Map Text i, ConstructionData i)
-&gt; (StorageClass i, [TokenLC i], ConstructionData i)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Map Text i -&gt; StorageClass i)
-&gt; (Map Text i, ConstructionData i)
-&gt; (StorageClass i, ConstructionData i)
forall a a' b. (a -&gt; a') -&gt; (a, b) -&gt; (a', b)
</span><span class="hs-identifier hs-var">first</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypeKind i -&gt; StorageClass i
forall i. TypeKind i -&gt; StorageClass i
</span><a href="Htcc.CRules.Types.StorageClass.html#SCAuto"><span class="hs-identifier hs-var">CT.SCAuto</span></a></span><span> </span><span class="annot"><span class="annottext">(TypeKind i -&gt; StorageClass i)
-&gt; (Map Text i -&gt; TypeKind i) -&gt; Map Text i -&gt; StorageClass i
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TypeKind i -&gt; Map Text i -&gt; TypeKind i
forall i. TypeKind i -&gt; Map Text i -&gt; TypeKind i
</span><a href="Htcc.CRules.Types.TypeKind.html#CTEnum"><span class="hs-identifier hs-var">CT.CTEnum</span></a></span><span> </span><span class="annot"><span class="annottext">TypeKind i
forall i. TypeKind i
</span><a href="Htcc.CRules.Types.TypeKind.html#CTInt"><span class="hs-identifier hs-var">CT.CTInt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Map Text i, ConstructionData i)
 -&gt; (StorageClass i, [TokenLC i], ConstructionData i))
-&gt; Either (ASTError i) (Map Text i, ConstructionData i)
-&gt; Either
     (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">StorageClass i
-&gt; [TokenLC i]
-&gt; ConstructionData i
-&gt; Either (ASTError i) (Map Text i, ConstructionData i)
forall i.
(Integral i, Show i, Read i, Bits i) =&gt;
StorageClass i
-&gt; [TokenLC i]
-&gt; ConstructionData i
-&gt; Either (ASTError i) (Map Text i, ConstructionData i)
</span><a href="Htcc.Parser.Parsing.Type.html#takeEnumFiels"><span class="hs-identifier hs-var">takeEnumFiels</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypeKind i -&gt; StorageClass i
forall i. TypeKind i -&gt; StorageClass i
</span><a href="Htcc.CRules.Types.StorageClass.html#SCAuto"><span class="hs-identifier hs-var">CT.SCAuto</span></a></span><span> </span><span class="annot"><span class="annottext">TypeKind i
forall i. TypeKind i
</span><a href="Htcc.CRules.Types.TypeKind.html#CTInt"><span class="hs-identifier hs-var">CT.CTInt</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TokenLC i] -&gt; [TokenLC i]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">tail</span></span><span> </span><span class="annot"><span class="annottext">([TokenLC i] -&gt; [TokenLC i]) -&gt; [TokenLC i] -&gt; [TokenLC i]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[TokenLC i] -&gt; [TokenLC i]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">init</span></span><span> </span><span class="annot"><span class="annottext">[TokenLC i]
</span><a href="#local-6989586621679290315"><span class="hs-identifier hs-var">field</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ConstructionData i
</span><a href="#local-6989586621679290316"><span class="hs-identifier hs-var">scp</span></a></span><span>
</span><span id="line-136"></span><span class="annot"><a href="Htcc.Parser.Parsing.Type.html#takePreType"><span class="hs-identifier hs-var">takePreType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Htcc.Tokenizer.Token.html#TKEnum"><span class="hs-identifier hs-type">HT.TKEnum</span></a></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679290311"><span class="annot"><span class="annottext">cur1 :: TokenLC i
</span><a href="#local-6989586621679290311"><span class="hs-identifier hs-var">cur1</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Htcc.Tokenizer.Token.html#TKIdent"><span class="hs-identifier hs-type">HT.TKIdent</span></a></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679290310"><span class="annot"><span class="annottext">cur2 :: TokenLC i
</span><a href="#local-6989586621679290310"><span class="hs-identifier hs-var">cur2</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-type">HT.TKReserved</span></a></span><span> </span><span class="hs-string">&quot;{&quot;</span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679290309"><span class="annot"><span class="annottext">xs :: [TokenLC i]
</span><a href="#local-6989586621679290309"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679290308"><span class="annot"><span class="annottext">scp :: ConstructionData i
</span><a href="#local-6989586621679290308"><span class="hs-identifier hs-var">scp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Either (ASTError i) (Either (TokenLC i) ([TokenLC i], [TokenLC i]))
-&gt; (Either (TokenLC i) ([TokenLC i], [TokenLC i])
    -&gt; Either
         (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i))
-&gt; Either
     (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">(&gt;&gt;=)</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASTError i
-&gt; Maybe (Either (TokenLC i) ([TokenLC i], [TokenLC i]))
-&gt; Either
     (ASTError i) (Either (TokenLC i) ([TokenLC i], [TokenLC i]))
forall e. e -&gt; Maybe ~&gt; Either e
</span><a href="Htcc.Utils.NaturalTransformations.html#maybeToRight"><span class="hs-identifier hs-var">maybeToRight</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><a href="Htcc.Parser.ConstructionData.Scope.Utils.html#internalCE"><span class="hs-identifier hs-var">internalCE</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TokenLC i
</span><a href="#local-6989586621679290311"><span class="hs-identifier hs-var">cur1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
-&gt; Text
-&gt; [TokenLC i]
-&gt; Maybe (Either (TokenLC i) ([TokenLC i], [TokenLC i]))
forall i.
(Integral i, Read i, Show i) =&gt;
Text
-&gt; Text
-&gt; [TokenLC i]
-&gt; Maybe (Either (TokenLC i) ([TokenLC i], [TokenLC i]))
</span><a href="Htcc.Parser.Utils.Core.html#takeBrace"><span class="hs-identifier hs-var">takeBrace</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;{&quot;</span></span><span> </span><span class="annot"><span class="hs-string">&quot;}&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TokenLC i
</span><a href="#local-6989586621679290310"><span class="hs-identifier hs-var">cur2</span></a></span><span class="annot"><span class="annottext">TokenLC i -&gt; [TokenLC i] -&gt; [TokenLC i]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[TokenLC i]
</span><a href="#local-6989586621679290309"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Either (TokenLC i) ([TokenLC i], [TokenLC i])
  -&gt; Either
       (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i))
 -&gt; Either
      (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i))
-&gt; (Either (TokenLC i) ([TokenLC i], [TokenLC i])
    -&gt; Either
         (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i))
-&gt; Either
     (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-comment">-- for @enum@ with tag</span><span>
</span><span id="line-137"></span><span>    </span><span class="annot"><span class="annottext">(TokenLC i
 -&gt; Either
      (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i))
-&gt; (([TokenLC i], [TokenLC i])
    -&gt; Either
         (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i))
-&gt; Either (TokenLC i) ([TokenLC i], [TokenLC i])
-&gt; Either
     (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i)
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASTError i
-&gt; Either
     (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(ASTError i
 -&gt; Either
      (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i))
-&gt; (TokenLC i -&gt; ASTError i)
-&gt; TokenLC i
-&gt; Either
     (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;expected '}' token to match this '{'&quot;</span></span><span class="hs-special">,</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((([TokenLC i], [TokenLC i])
  -&gt; Either
       (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i))
 -&gt; Either (TokenLC i) ([TokenLC i], [TokenLC i])
 -&gt; Either
      (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i))
-&gt; (([TokenLC i], [TokenLC i])
    -&gt; Either
         (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i))
-&gt; Either (TokenLC i) ([TokenLC i], [TokenLC i])
-&gt; Either
     (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679290307"><span class="annot"><span class="annottext">field :: [TokenLC i]
</span><a href="#local-6989586621679290307"><span class="hs-identifier hs-var">field</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679290306"><span class="annot"><span class="annottext">ds :: [TokenLC i]
</span><a href="#local-6989586621679290306"><span class="hs-identifier hs-var">ds</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either (ASTError i) (Map Text i, ConstructionData i)
-&gt; ((Map Text i, ConstructionData i)
    -&gt; Either
         (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i))
-&gt; Either
     (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">(&gt;&gt;=)</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StorageClass i
-&gt; [TokenLC i]
-&gt; ConstructionData i
-&gt; Either (ASTError i) (Map Text i, ConstructionData i)
forall i.
(Integral i, Show i, Read i, Bits i) =&gt;
StorageClass i
-&gt; [TokenLC i]
-&gt; ConstructionData i
-&gt; Either (ASTError i) (Map Text i, ConstructionData i)
</span><a href="Htcc.Parser.Parsing.Type.html#takeEnumFiels"><span class="hs-identifier hs-var">takeEnumFiels</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypeKind i -&gt; StorageClass i
forall i. TypeKind i -&gt; StorageClass i
</span><a href="Htcc.CRules.Types.StorageClass.html#SCAuto"><span class="hs-identifier hs-var">CT.SCAuto</span></a></span><span> </span><span class="annot"><span class="annottext">TypeKind i
forall i. TypeKind i
</span><a href="Htcc.CRules.Types.TypeKind.html#CTInt"><span class="hs-identifier hs-var">CT.CTInt</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TokenLC i] -&gt; [TokenLC i]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">tail</span></span><span> </span><span class="annot"><span class="annottext">([TokenLC i] -&gt; [TokenLC i]) -&gt; [TokenLC i] -&gt; [TokenLC i]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[TokenLC i] -&gt; [TokenLC i]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">init</span></span><span> </span><span class="annot"><span class="annottext">[TokenLC i]
</span><a href="#local-6989586621679290307"><span class="hs-identifier hs-var">field</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ConstructionData i
</span><a href="#local-6989586621679290308"><span class="hs-identifier hs-var">scp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(((Map Text i, ConstructionData i)
  -&gt; Either
       (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i))
 -&gt; Either
      (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i))
-&gt; ((Map Text i, ConstructionData i)
    -&gt; Either
         (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i))
-&gt; Either
     (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679290305"><span class="annot"><span class="annottext">mem :: Map Text i
</span><a href="#local-6989586621679290305"><span class="hs-identifier hs-var">mem</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679290304"><span class="annot"><span class="annottext">scp' :: ConstructionData i
</span><a href="#local-6989586621679290304"><span class="hs-identifier hs-var">scp'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679290303"><span class="annot"><span class="annottext">ty :: StorageClass i
</span><a href="#local-6989586621679290303"><span class="hs-identifier hs-var hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeKind i -&gt; StorageClass i
forall i. TypeKind i -&gt; StorageClass i
</span><a href="Htcc.CRules.Types.StorageClass.html#SCAuto"><span class="hs-identifier hs-var">CT.SCAuto</span></a></span><span> </span><span class="annot"><span class="annottext">(TypeKind i -&gt; StorageClass i) -&gt; TypeKind i -&gt; StorageClass i
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TypeKind i -&gt; Map Text i -&gt; TypeKind i
forall i. TypeKind i -&gt; Map Text i -&gt; TypeKind i
</span><a href="Htcc.CRules.Types.TypeKind.html#CTEnum"><span class="hs-identifier hs-var">CT.CTEnum</span></a></span><span> </span><span class="annot"><span class="annottext">TypeKind i
forall i. TypeKind i
</span><a href="Htcc.CRules.Types.TypeKind.html#CTInt"><span class="hs-identifier hs-var">CT.CTInt</span></a></span><span> </span><span class="annot"><span class="annottext">Map Text i
</span><a href="#local-6989586621679290305"><span class="hs-identifier hs-var">mem</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-138"></span><span>        </span><span class="annot"><span class="annottext">StorageClass i
-&gt; TokenLC i
-&gt; ConstructionData i
-&gt; Either (ASTError i) (ConstructionData i)
forall i.
Num i =&gt;
StorageClass i
-&gt; TokenLC i
-&gt; ConstructionData i
-&gt; Either (ASTError i) (ConstructionData i)
</span><a href="Htcc.Parser.ConstructionData.Core.html#addTag"><span class="hs-identifier hs-var">addTag</span></a></span><span> </span><span class="annot"><span class="annottext">StorageClass i
</span><a href="#local-6989586621679290303"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">TokenLC i
</span><a href="#local-6989586621679290311"><span class="hs-identifier hs-var">cur1</span></a></span><span> </span><span class="annot"><span class="annottext">ConstructionData i
</span><a href="#local-6989586621679290304"><span class="hs-identifier hs-var">scp'</span></a></span><span> </span><span class="annot"><span class="annottext">Either (ASTError i) (ConstructionData i)
-&gt; (ConstructionData i
    -&gt; Either
         (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i))
-&gt; Either
     (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">(StorageClass i, [TokenLC i], ConstructionData i)
-&gt; Either
     (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">((StorageClass i, [TokenLC i], ConstructionData i)
 -&gt; Either
      (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i))
-&gt; (ConstructionData i
    -&gt; (StorageClass i, [TokenLC i], ConstructionData i))
-&gt; ConstructionData i
-&gt; Either
     (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StorageClass i
</span><a href="#local-6989586621679290303"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[TokenLC i]
</span><a href="#local-6989586621679290306"><span class="hs-identifier hs-var">ds</span></a></span><span class="hs-special">,</span><span class="hs-special">)</span><span>
</span><span id="line-139"></span><span class="annot"><a href="Htcc.Parser.Parsing.Type.html#takePreType"><span class="hs-identifier hs-var">takePreType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Htcc.Tokenizer.Token.html#TKEnum"><span class="hs-identifier hs-type">HT.TKEnum</span></a></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679290302"><span class="annot"><span class="annottext">cur1 :: TokenLC i
</span><a href="#local-6989586621679290302"><span class="hs-identifier hs-var">cur1</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Htcc.Tokenizer.Token.html#TKIdent"><span class="hs-identifier hs-type">HT.TKIdent</span></a></span><span> </span><span id="local-6989586621679290301"><span class="annot"><span class="annottext">ident :: Text
</span><a href="#local-6989586621679290301"><span class="hs-identifier hs-var">ident</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679290300"><span class="annot"><span class="annottext">xs :: [TokenLC i]
</span><a href="#local-6989586621679290300"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679290299"><span class="annot"><span class="annottext">scp :: ConstructionData i
</span><a href="#local-6989586621679290299"><span class="hs-identifier hs-var">scp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-special">,</span></span><span> </span><span class="annot"><span class="annottext">[TokenLC i]
</span><a href="#local-6989586621679290300"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ConstructionData i
</span><a href="#local-6989586621679290299"><span class="hs-identifier hs-var">scp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(StorageClass i
 -&gt; (StorageClass i, [TokenLC i], ConstructionData i))
-&gt; (Tag i -&gt; StorageClass i)
-&gt; Tag i
-&gt; (StorageClass i, [TokenLC i], ConstructionData i)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Tag i -&gt; StorageClass i
forall i. Tag i -&gt; StorageClass i
</span><a href="Htcc.Parser.ConstructionData.Scope.Tag.html#sttype"><span class="hs-identifier hs-var hs-var">PST.sttype</span></a></span><span> </span><span class="annot"><span class="annottext">(Tag i -&gt; (StorageClass i, [TokenLC i], ConstructionData i))
-&gt; Either (ASTError i) (Tag i)
-&gt; Either
     (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ASTError i -&gt; Maybe (Tag i) -&gt; Either (ASTError i) (Tag i)
forall e. e -&gt; Maybe ~&gt; Either e
</span><a href="Htcc.Utils.NaturalTransformations.html#maybeToRight"><span class="hs-identifier hs-var">maybeToRight</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;storage size of '&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679290301"><span class="hs-identifier hs-var">ident</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="hs-string">&quot;' isn't known&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TokenLC i
</span><a href="#local-6989586621679290302"><span class="hs-identifier hs-var">cur1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; ConstructionData i -&gt; Maybe (Tag i)
forall i. Text -&gt; ConstructionData i -&gt; Maybe (Tag i)
</span><a href="Htcc.Parser.ConstructionData.Core.html#lookupTag"><span class="hs-identifier hs-var">lookupTag</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679290301"><span class="hs-identifier hs-var">ident</span></a></span><span> </span><span class="annot"><span class="annottext">ConstructionData i
</span><a href="#local-6989586621679290299"><span class="hs-identifier hs-var">scp</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- declaration for @enum@</span><span>
</span><span id="line-140"></span><span class="annot"><a href="Htcc.Parser.Parsing.Type.html#takePreType"><span class="hs-identifier hs-var">takePreType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-type">HT.TKReserved</span></a></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679290298"><span class="annot"><span class="annottext">cur :: TokenLC i
</span><a href="#local-6989586621679290298"><span class="hs-identifier hs-var">cur</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-type">HT.TKReserved</span></a></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ASTError i
-&gt; Either
     (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;cannot combine with previous '&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Token i -&gt; Text
forall a. Show a =&gt; a -&gt; Text
</span><a href="Htcc.Utils.Text.html#tshow"><span class="hs-identifier hs-var">tshow</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TokenLC i -&gt; Token i
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">TokenLC i
</span><a href="#local-6989586621679290298"><span class="hs-identifier hs-var">cur</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="hs-string">&quot;' declaration specifier&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TokenLC i
</span><a href="#local-6989586621679290298"><span class="hs-identifier hs-var">cur</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-141"></span><span class="annot"><a href="Htcc.Parser.Parsing.Type.html#takePreType"><span class="hs-identifier hs-var">takePreType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-type">HT.TKReserved</span></a></span><span> </span><span class="hs-string">&quot;static&quot;</span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679290297"><span class="annot"><span class="annottext">xs :: [TokenLC i]
</span><a href="#local-6989586621679290297"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679290296"><span class="annot"><span class="annottext">scp :: ConstructionData i
</span><a href="#local-6989586621679290296"><span class="hs-identifier hs-var">scp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(StorageClass i -&gt; StorageClass i)
-&gt; (StorageClass i, [TokenLC i], ConstructionData i)
-&gt; (StorageClass i, [TokenLC i], ConstructionData i)
forall a d b c. (a -&gt; d) -&gt; (a, b, c) -&gt; (d, b, c)
</span><a href="Htcc.Utils.Tuple.html#first3"><span class="hs-identifier hs-var">first3</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypeKind i -&gt; StorageClass i
forall i. TypeKind i -&gt; StorageClass i
</span><a href="Htcc.CRules.Types.StorageClass.html#SCStatic"><span class="hs-identifier hs-var">CT.SCStatic</span></a></span><span> </span><span class="annot"><span class="annottext">(TypeKind i -&gt; StorageClass i)
-&gt; (StorageClass i -&gt; TypeKind i)
-&gt; StorageClass i
-&gt; StorageClass i
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">StorageClass i -&gt; TypeKind i
forall (a :: * -&gt; *) i. TypeKindBase a =&gt; a i -&gt; TypeKind i
</span><a href="Htcc.CRules.Types.TypeKind.html#toTypeKind"><span class="hs-identifier hs-var">CT.toTypeKind</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((StorageClass i, [TokenLC i], ConstructionData i)
 -&gt; (StorageClass i, [TokenLC i], ConstructionData i))
-&gt; Either
     (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i)
-&gt; Either
     (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[TokenLC i]
-&gt; ConstructionData i
-&gt; Either
     (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i)
forall i.
(Integral i, Show i, Read i, Bits i) =&gt;
[TokenLC i]
-&gt; ConstructionData i
-&gt; Either
     (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i)
</span><a href="Htcc.Parser.Parsing.Type.html#takePreType"><span class="hs-identifier hs-var">takePreType</span></a></span><span> </span><span class="annot"><span class="annottext">[TokenLC i]
</span><a href="#local-6989586621679290297"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">ConstructionData i
</span><a href="#local-6989586621679290296"><span class="hs-identifier hs-var">scp</span></a></span><span>
</span><span id="line-142"></span><span class="annot"><a href="Htcc.Parser.Parsing.Type.html#takePreType"><span class="hs-identifier hs-var">takePreType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-type">HT.TKReserved</span></a></span><span> </span><span class="hs-string">&quot;register&quot;</span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679290294"><span class="annot"><span class="annottext">xs :: [TokenLC i]
</span><a href="#local-6989586621679290294"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679290293"><span class="annot"><span class="annottext">scp :: ConstructionData i
</span><a href="#local-6989586621679290293"><span class="hs-identifier hs-var">scp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(StorageClass i -&gt; StorageClass i)
-&gt; (StorageClass i, [TokenLC i], ConstructionData i)
-&gt; (StorageClass i, [TokenLC i], ConstructionData i)
forall a d b c. (a -&gt; d) -&gt; (a, b, c) -&gt; (d, b, c)
</span><a href="Htcc.Utils.Tuple.html#first3"><span class="hs-identifier hs-var">first3</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypeKind i -&gt; StorageClass i
forall i. TypeKind i -&gt; StorageClass i
</span><a href="Htcc.CRules.Types.StorageClass.html#SCRegister"><span class="hs-identifier hs-var">CT.SCRegister</span></a></span><span> </span><span class="annot"><span class="annottext">(TypeKind i -&gt; StorageClass i)
-&gt; (StorageClass i -&gt; TypeKind i)
-&gt; StorageClass i
-&gt; StorageClass i
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">StorageClass i -&gt; TypeKind i
forall (a :: * -&gt; *) i. TypeKindBase a =&gt; a i -&gt; TypeKind i
</span><a href="Htcc.CRules.Types.TypeKind.html#toTypeKind"><span class="hs-identifier hs-var">CT.toTypeKind</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((StorageClass i, [TokenLC i], ConstructionData i)
 -&gt; (StorageClass i, [TokenLC i], ConstructionData i))
-&gt; Either
     (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i)
-&gt; Either
     (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[TokenLC i]
-&gt; ConstructionData i
-&gt; Either
     (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i)
forall i.
(Integral i, Show i, Read i, Bits i) =&gt;
[TokenLC i]
-&gt; ConstructionData i
-&gt; Either
     (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i)
</span><a href="Htcc.Parser.Parsing.Type.html#takePreType"><span class="hs-identifier hs-var">takePreType</span></a></span><span> </span><span class="annot"><span class="annottext">[TokenLC i]
</span><a href="#local-6989586621679290294"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">ConstructionData i
</span><a href="#local-6989586621679290293"><span class="hs-identifier hs-var">scp</span></a></span><span>
</span><span id="line-143"></span><span class="annot"><a href="Htcc.Parser.Parsing.Type.html#takePreType"><span class="hs-identifier hs-var">takePreType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-type">HT.TKReserved</span></a></span><span> </span><span class="hs-string">&quot;auto&quot;</span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679290291"><span class="annot"><span class="annottext">xs :: [TokenLC i]
</span><a href="#local-6989586621679290291"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679290290"><span class="annot"><span class="annottext">scp :: ConstructionData i
</span><a href="#local-6989586621679290290"><span class="hs-identifier hs-var">scp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TokenLC i]
-&gt; ConstructionData i
-&gt; Either
     (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i)
forall i.
(Integral i, Show i, Read i, Bits i) =&gt;
[TokenLC i]
-&gt; ConstructionData i
-&gt; Either
     (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i)
</span><a href="Htcc.Parser.Parsing.Type.html#takePreType"><span class="hs-identifier hs-var">takePreType</span></a></span><span> </span><span class="annot"><span class="annottext">[TokenLC i]
</span><a href="#local-6989586621679290291"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">ConstructionData i
</span><a href="#local-6989586621679290290"><span class="hs-identifier hs-var">scp</span></a></span><span>
</span><span id="line-144"></span><span class="annot"><a href="Htcc.Parser.Parsing.Type.html#takePreType"><span class="hs-identifier hs-var">takePreType</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679290289"><span class="annot"><span class="annottext">x :: TokenLC i
</span><a href="#local-6989586621679290289"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ASTError i
-&gt; Either
     (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;ISO C forbids declaration with no type&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TokenLC i
</span><a href="#local-6989586621679290289"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-145"></span><span class="annot"><a href="Htcc.Parser.Parsing.Type.html#takePreType"><span class="hs-identifier hs-var">takePreType</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ASTError i
-&gt; Either
     (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;ISO C forbids declaration with no type&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TokenLC i
forall i. Num i =&gt; TokenLC i
</span><a href="Htcc.Tokenizer.Token.html#emptyToken"><span class="hs-identifier hs-var">HT.emptyToken</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-146"></span><span>
</span><span id="line-147"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Htcc.Parser.Parsing.Type.html#declaration"><span class="hs-pragma hs-type">declaration</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-148"></span><span class="hs-comment">-- | \[</span><span>
</span><span id="line-149"></span><span class="hs-comment">-- \text{declaration} = \text{&quot;*&quot;*}\ \left(\text{&quot;(&quot;}\ \text{declaration}\ \text{&quot;)&quot;}\ \mid\ \text{ident}\right)\ \text{array-decl-suffix}</span><span>
</span><span id="line-150"></span><span class="hs-comment">-- \]</span><span>
</span><span id="line-151"></span><span id="local-6989586621679290535"><span class="annot"><a href="Htcc.Parser.Parsing.Type.html#declaration"><span class="hs-identifier hs-type">declaration</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621679290535"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bits</span></span><span> </span><span class="annot"><a href="#local-6989586621679290535"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679290535"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Read</span></span><span> </span><span class="annot"><a href="#local-6989586621679290535"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Htcc.CRules.Types.StorageClass.html#StorageClass"><span class="hs-identifier hs-type">CT.StorageClass</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679290535"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Htcc.Tokenizer.Token.html#TokenLC"><span class="hs-identifier hs-type">HT.TokenLC</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679290535"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Htcc.Parser.ConstructionData.Core.html#ConstructionData"><span class="hs-identifier hs-type">ConstructionData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679290535"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Htcc.Parser.ConstructionData.Scope.ManagedScope.html#ASTError"><span class="hs-identifier hs-type">ASTError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679290535"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Htcc.CRules.Types.StorageClass.html#StorageClass"><span class="hs-identifier hs-type">CT.StorageClass</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679290535"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Htcc.Tokenizer.Token.html#TokenLC"><span class="hs-identifier hs-type">HT.TokenLC</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679290535"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Htcc.Tokenizer.Token.html#TokenLC"><span class="hs-identifier hs-type">HT.TokenLC</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679290535"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span></span><span>
</span><span id="line-152"></span><span id="declaration"><span class="annot"><span class="annottext">declaration :: StorageClass i
-&gt; [TokenLC i]
-&gt; ConstructionData i
-&gt; Either
     (ASTError i) (StorageClass i, Maybe (TokenLC i), [TokenLC i])
</span><a href="Htcc.Parser.Parsing.Type.html#declaration"><span class="hs-identifier hs-var hs-var">declaration</span></a></span></span><span> </span><span id="local-6989586621679290288"><span class="annot"><span class="annottext">ty :: StorageClass i
</span><a href="#local-6989586621679290288"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621679290287"><span class="annot"><span class="annottext">xs :: [TokenLC i]
</span><a href="#local-6989586621679290287"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621679290286"><span class="annot"><span class="annottext">scp :: ConstructionData i
</span><a href="#local-6989586621679290286"><span class="hs-identifier hs-var">scp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[TokenLC i] -&gt; (StorageClass i -&gt; StorageClass i, [TokenLC i])
forall i.
Integral i =&gt;
[TokenLC i] -&gt; (StorageClass i -&gt; StorageClass i, [TokenLC i])
</span><a href="Htcc.Parser.Parsing.Type.html#takeCtorPtr"><span class="hs-identifier hs-var">takeCtorPtr</span></a></span><span> </span><span class="annot"><span class="annottext">[TokenLC i]
</span><a href="#local-6989586621679290287"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-153"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679290285"><span class="annot"><span class="annottext">fn :: StorageClass i -&gt; StorageClass i
</span><a href="#local-6989586621679290285"><span class="hs-identifier hs-var">fn</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679290284"><span class="annot"><span class="annottext">xs' :: [TokenLC i]
</span><a href="#local-6989586621679290284"><span class="hs-identifier hs-var">xs'</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-type">HT.TKReserved</span></a></span><span> </span><span class="hs-string">&quot;(&quot;</span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(StorageClass i -&gt; StorageClass i, StorageClass i,
 Maybe (TokenLC i), [TokenLC i])
-&gt; (StorageClass i, Maybe (TokenLC i), [TokenLC i])
forall a b c d. (a, b, c, d) -&gt; (b, c, d)
</span><a href="Htcc.Utils.Tuple.html#dropFst4"><span class="hs-identifier hs-var">dropFst4</span></a></span><span> </span><span class="annot"><span class="annottext">((StorageClass i -&gt; StorageClass i, StorageClass i,
  Maybe (TokenLC i), [TokenLC i])
 -&gt; (StorageClass i, Maybe (TokenLC i), [TokenLC i]))
-&gt; Either
     (ASTError i)
     (StorageClass i -&gt; StorageClass i, StorageClass i,
      Maybe (TokenLC i), [TokenLC i])
-&gt; Either
     (ASTError i) (StorageClass i, Maybe (TokenLC i), [TokenLC i])
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(StorageClass i -&gt; StorageClass i)
-&gt; StorageClass i
-&gt; [TokenLC i]
-&gt; ConstructionData i
-&gt; Either
     (ASTError i)
     (StorageClass i -&gt; StorageClass i, StorageClass i,
      Maybe (TokenLC i), [TokenLC i])
forall i c.
(Integral i, Bits i, Show i, Read i) =&gt;
(StorageClass i -&gt; c)
-&gt; StorageClass i
-&gt; [TokenLC i]
-&gt; ConstructionData i
-&gt; Either
     (ASTError i)
     (StorageClass i -&gt; StorageClass i, StorageClass i,
      Maybe (TokenLC i), [TokenLC i])
</span><a href="#local-6989586621679290283"><span class="hs-identifier hs-var">declaration'</span></a></span><span> </span><span class="annot"><span class="annottext">StorageClass i -&gt; StorageClass i
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StorageClass i -&gt; StorageClass i
</span><a href="#local-6989586621679290285"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">StorageClass i
</span><a href="#local-6989586621679290288"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TokenLC i]
</span><a href="#local-6989586621679290284"><span class="hs-identifier hs-var">xs'</span></a></span><span> </span><span class="annot"><span class="annottext">ConstructionData i
</span><a href="#local-6989586621679290286"><span class="hs-identifier hs-var">scp</span></a></span><span>
</span><span id="line-154"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679290281"><span class="annot"><span class="annottext">fn :: StorageClass i -&gt; StorageClass i
</span><a href="#local-6989586621679290281"><span class="hs-identifier hs-var">fn</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679290280"><span class="annot"><span class="annottext">ident :: TokenLC i
</span><a href="#local-6989586621679290280"><span class="hs-identifier hs-var">ident</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Htcc.Tokenizer.Token.html#TKIdent"><span class="hs-identifier hs-type">HT.TKIdent</span></a></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679290279"><span class="annot"><span class="annottext">ds' :: [TokenLC i]
</span><a href="#local-6989586621679290279"><span class="hs-identifier hs-var">ds'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">StorageClass i
-&gt; [TokenLC i]
-&gt; ConstructionData i
-&gt; Maybe (Either (ASTError i) (StorageClass i, [TokenLC i]))
forall i.
(Integral i, Bits i, Show i, Read i) =&gt;
StorageClass i
-&gt; [TokenLC i]
-&gt; ConstructionData i
-&gt; Maybe (Either (ASTError i) (StorageClass i, [TokenLC i]))
</span><a href="Htcc.Parser.Parsing.Type.html#arrayDeclSuffix"><span class="hs-identifier hs-var">arrayDeclSuffix</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StorageClass i -&gt; StorageClass i
</span><a href="#local-6989586621679290281"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">StorageClass i
</span><a href="#local-6989586621679290288"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TokenLC i]
</span><a href="#local-6989586621679290279"><span class="hs-identifier hs-var">ds'</span></a></span><span> </span><span class="annot"><span class="annottext">ConstructionData i
</span><a href="#local-6989586621679290286"><span class="hs-identifier hs-var">scp</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-155"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(StorageClass i, Maybe (TokenLC i), [TokenLC i])
-&gt; Either
     (ASTError i) (StorageClass i, Maybe (TokenLC i), [TokenLC i])
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StorageClass i -&gt; StorageClass i
</span><a href="#local-6989586621679290281"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">StorageClass i
</span><a href="#local-6989586621679290288"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TokenLC i -&gt; Maybe (TokenLC i)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">TokenLC i
</span><a href="#local-6989586621679290280"><span class="hs-identifier hs-var">ident</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[TokenLC i]
</span><a href="#local-6989586621679290279"><span class="hs-identifier hs-var">ds'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-156"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679290278"><span class="annot"><span class="annottext">rs :: Either (ASTError i) (StorageClass i, [TokenLC i])
</span><a href="#local-6989586621679290278"><span class="hs-identifier hs-var">rs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(StorageClass i
 -&gt; [TokenLC i] -&gt; (StorageClass i, Maybe (TokenLC i), [TokenLC i]))
-&gt; (StorageClass i, [TokenLC i])
-&gt; (StorageClass i, Maybe (TokenLC i), [TokenLC i])
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-special">,</span></span><span class="annot"><span class="annottext">TokenLC i -&gt; Maybe (TokenLC i)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">TokenLC i
</span><a href="#local-6989586621679290280"><span class="hs-identifier hs-var">ident</span></a></span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((StorageClass i, [TokenLC i])
 -&gt; (StorageClass i, Maybe (TokenLC i), [TokenLC i]))
-&gt; Either (ASTError i) (StorageClass i, [TokenLC i])
-&gt; Either
     (ASTError i) (StorageClass i, Maybe (TokenLC i), [TokenLC i])
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Either (ASTError i) (StorageClass i, [TokenLC i])
</span><a href="#local-6989586621679290278"><span class="hs-identifier hs-var">rs</span></a></span><span>
</span><span id="line-157"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679290277"><span class="annot"><span class="annottext">fn :: StorageClass i -&gt; StorageClass i
</span><a href="#local-6989586621679290277"><span class="hs-identifier hs-var">fn</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679290276"><span class="annot"><span class="annottext">es :: [TokenLC i]
</span><a href="#local-6989586621679290276"><span class="hs-identifier hs-var">es</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(StorageClass i, Maybe (TokenLC i), [TokenLC i])
-&gt; Either
     (ASTError i) (StorageClass i, Maybe (TokenLC i), [TokenLC i])
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StorageClass i -&gt; StorageClass i
</span><a href="#local-6989586621679290277"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">StorageClass i
</span><a href="#local-6989586621679290288"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe (TokenLC i)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[TokenLC i]
</span><a href="#local-6989586621679290276"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-158"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-159"></span><span>        </span><span id="local-6989586621679290283"><span class="annot"><span class="annottext">declaration' :: (StorageClass i -&gt; c)
-&gt; StorageClass i
-&gt; [TokenLC i]
-&gt; ConstructionData i
-&gt; Either
     (ASTError i)
     (StorageClass i -&gt; StorageClass i, StorageClass i,
      Maybe (TokenLC i), [TokenLC i])
</span><a href="#local-6989586621679290283"><span class="hs-identifier hs-var hs-var">declaration'</span></a></span></span><span> </span><span id="local-6989586621679290275"><span class="annot"><span class="annottext">fn :: StorageClass i -&gt; c
</span><a href="#local-6989586621679290275"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span id="local-6989586621679290274"><span class="annot"><span class="annottext">ty' :: StorageClass i
</span><a href="#local-6989586621679290274"><span class="hs-identifier hs-var">ty'</span></a></span></span><span> </span><span id="local-6989586621679290273"><span class="annot"><span class="annottext">xs' :: [TokenLC i]
</span><a href="#local-6989586621679290273"><span class="hs-identifier hs-var">xs'</span></a></span></span><span> </span><span id="local-6989586621679290272"><span class="annot"><span class="annottext">scp' :: ConstructionData i
</span><a href="#local-6989586621679290272"><span class="hs-identifier hs-var">scp'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[TokenLC i] -&gt; (StorageClass i -&gt; StorageClass i, [TokenLC i])
forall i.
Integral i =&gt;
[TokenLC i] -&gt; (StorageClass i -&gt; StorageClass i, [TokenLC i])
</span><a href="Htcc.Parser.Parsing.Type.html#takeCtorPtr"><span class="hs-identifier hs-var">takeCtorPtr</span></a></span><span> </span><span class="annot"><span class="annottext">[TokenLC i]
</span><a href="#local-6989586621679290273"><span class="hs-identifier hs-var">xs'</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-160"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621679290271"><span class="annot"><span class="annottext">ptrf :: StorageClass i -&gt; StorageClass i
</span><a href="#local-6989586621679290271"><span class="hs-identifier hs-var">ptrf</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679290270"><span class="annot"><span class="annottext">cur :: TokenLC i
</span><a href="#local-6989586621679290270"><span class="hs-identifier hs-var">cur</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-type">HT.TKReserved</span></a></span><span> </span><span class="hs-string">&quot;(&quot;</span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679290269"><span class="annot"><span class="annottext">ds' :: [TokenLC i]
</span><a href="#local-6989586621679290269"><span class="hs-identifier hs-var">ds'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either
  (ASTError i)
  (StorageClass i -&gt; StorageClass i, StorageClass i,
   Maybe (TokenLC i), [TokenLC i])
-&gt; ((StorageClass i -&gt; StorageClass i, StorageClass i,
     Maybe (TokenLC i), [TokenLC i])
    -&gt; Either
         (ASTError i)
         (StorageClass i -&gt; StorageClass i, StorageClass i,
          Maybe (TokenLC i), [TokenLC i]))
-&gt; Either
     (ASTError i)
     (StorageClass i -&gt; StorageClass i, StorageClass i,
      Maybe (TokenLC i), [TokenLC i])
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">(&gt;&gt;=)</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(StorageClass i -&gt; c)
-&gt; StorageClass i
-&gt; [TokenLC i]
-&gt; ConstructionData i
-&gt; Either
     (ASTError i)
     (StorageClass i -&gt; StorageClass i, StorageClass i,
      Maybe (TokenLC i), [TokenLC i])
</span><a href="#local-6989586621679290283"><span class="hs-identifier hs-var">declaration'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StorageClass i -&gt; c
</span><a href="#local-6989586621679290275"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">(StorageClass i -&gt; c)
-&gt; (StorageClass i -&gt; StorageClass i) -&gt; StorageClass i -&gt; c
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">StorageClass i -&gt; StorageClass i
</span><a href="#local-6989586621679290271"><span class="hs-identifier hs-var">ptrf</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StorageClass i
</span><a href="#local-6989586621679290274"><span class="hs-identifier hs-var">ty'</span></a></span><span> </span><span class="annot"><span class="annottext">[TokenLC i]
</span><a href="#local-6989586621679290269"><span class="hs-identifier hs-var">ds'</span></a></span><span> </span><span class="annot"><span class="annottext">ConstructionData i
</span><a href="#local-6989586621679290272"><span class="hs-identifier hs-var">scp'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(((StorageClass i -&gt; StorageClass i, StorageClass i,
   Maybe (TokenLC i), [TokenLC i])
  -&gt; Either
       (ASTError i)
       (StorageClass i -&gt; StorageClass i, StorageClass i,
        Maybe (TokenLC i), [TokenLC i]))
 -&gt; Either
      (ASTError i)
      (StorageClass i -&gt; StorageClass i, StorageClass i,
       Maybe (TokenLC i), [TokenLC i]))
-&gt; ((StorageClass i -&gt; StorageClass i, StorageClass i,
     Maybe (TokenLC i), [TokenLC i])
    -&gt; Either
         (ASTError i)
         (StorageClass i -&gt; StorageClass i, StorageClass i,
          Maybe (TokenLC i), [TokenLC i]))
-&gt; Either
     (ASTError i)
     (StorageClass i -&gt; StorageClass i, StorageClass i,
      Maybe (TokenLC i), [TokenLC i])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-161"></span><span>                </span><span class="hs-special">(</span><span id="local-6989586621679290268"><span class="annot"><span class="annottext">ptrf' :: StorageClass i -&gt; StorageClass i
</span><a href="#local-6989586621679290268"><span class="hs-identifier hs-var">ptrf'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679290267"><span class="annot"><span class="annottext">ty'' :: StorageClass i
</span><a href="#local-6989586621679290267"><span class="hs-identifier hs-var">ty''</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679290266"><span class="annot"><span class="annottext">ident :: Maybe (TokenLC i)
</span><a href="#local-6989586621679290266"><span class="hs-identifier hs-var">ident</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-type">HT.TKReserved</span></a></span><span> </span><span class="hs-string">&quot;)&quot;</span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679290265"><span class="annot"><span class="annottext">ds'' :: [TokenLC i]
</span><a href="#local-6989586621679290265"><span class="hs-identifier hs-var">ds''</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">StorageClass i
-&gt; [TokenLC i]
-&gt; ConstructionData i
-&gt; Maybe (Either (ASTError i) (StorageClass i, [TokenLC i]))
forall i.
(Integral i, Bits i, Show i, Read i) =&gt;
StorageClass i
-&gt; [TokenLC i]
-&gt; ConstructionData i
-&gt; Maybe (Either (ASTError i) (StorageClass i, [TokenLC i]))
</span><a href="Htcc.Parser.Parsing.Type.html#arrayDeclSuffix"><span class="hs-identifier hs-var">arrayDeclSuffix</span></a></span><span> </span><span class="annot"><span class="annottext">StorageClass i
</span><a href="#local-6989586621679290267"><span class="hs-identifier hs-var">ty''</span></a></span><span> </span><span class="annot"><span class="annottext">[TokenLC i]
</span><a href="#local-6989586621679290265"><span class="hs-identifier hs-var">ds''</span></a></span><span> </span><span class="annot"><span class="annottext">ConstructionData i
</span><a href="#local-6989586621679290272"><span class="hs-identifier hs-var">scp'</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-162"></span><span>                    </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(StorageClass i -&gt; StorageClass i, StorageClass i,
 Maybe (TokenLC i), [TokenLC i])
-&gt; Either
     (ASTError i)
     (StorageClass i -&gt; StorageClass i, StorageClass i,
      Maybe (TokenLC i), [TokenLC i])
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StorageClass i -&gt; StorageClass i
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">StorageClass i -&gt; StorageClass i
</span><a href="#local-6989586621679290268"><span class="hs-identifier hs-var">ptrf'</span></a></span><span> </span><span class="annot"><span class="annottext">StorageClass i
</span><a href="#local-6989586621679290274"><span class="hs-identifier hs-var">ty'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe (TokenLC i)
</span><a href="#local-6989586621679290266"><span class="hs-identifier hs-var">ident</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[TokenLC i]
</span><a href="#local-6989586621679290265"><span class="hs-identifier hs-var">ds''</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-163"></span><span>                    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679290264"><span class="annot"><span class="annottext">rs :: Either (ASTError i) (StorageClass i, [TokenLC i])
</span><a href="#local-6989586621679290264"><span class="hs-identifier hs-var">rs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(StorageClass i
 -&gt; [TokenLC i]
 -&gt; (StorageClass i -&gt; StorageClass i, StorageClass i,
     Maybe (TokenLC i), [TokenLC i]))
-&gt; (StorageClass i, [TokenLC i])
-&gt; (StorageClass i -&gt; StorageClass i, StorageClass i,
    Maybe (TokenLC i), [TokenLC i])
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StorageClass i -&gt; StorageClass i
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-special">,</span></span><span class="annot"><span class="annottext">Maybe (TokenLC i)
</span><a href="#local-6989586621679290266"><span class="hs-identifier hs-var">ident</span></a></span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((StorageClass i, [TokenLC i])
 -&gt; (StorageClass i -&gt; StorageClass i, StorageClass i,
     Maybe (TokenLC i), [TokenLC i]))
-&gt; ((StorageClass i, [TokenLC i]) -&gt; (StorageClass i, [TokenLC i]))
-&gt; (StorageClass i, [TokenLC i])
-&gt; (StorageClass i -&gt; StorageClass i, StorageClass i,
    Maybe (TokenLC i), [TokenLC i])
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(StorageClass i -&gt; StorageClass i)
-&gt; (StorageClass i, [TokenLC i]) -&gt; (StorageClass i, [TokenLC i])
forall a a' b. (a -&gt; a') -&gt; (a, b) -&gt; (a', b)
</span><span class="hs-identifier hs-var">first</span></span><span> </span><span class="annot"><span class="annottext">StorageClass i -&gt; StorageClass i
</span><a href="#local-6989586621679290268"><span class="hs-identifier hs-var">ptrf'</span></a></span><span> </span><span class="annot"><span class="annottext">((StorageClass i, [TokenLC i])
 -&gt; (StorageClass i -&gt; StorageClass i, StorageClass i,
     Maybe (TokenLC i), [TokenLC i]))
-&gt; Either (ASTError i) (StorageClass i, [TokenLC i])
-&gt; Either
     (ASTError i)
     (StorageClass i -&gt; StorageClass i, StorageClass i,
      Maybe (TokenLC i), [TokenLC i])
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Either (ASTError i) (StorageClass i, [TokenLC i])
</span><a href="#local-6989586621679290264"><span class="hs-identifier hs-var">rs</span></a></span><span>
</span><span id="line-164"></span><span>                </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ASTError i
-&gt; Either
     (ASTError i)
     (StorageClass i -&gt; StorageClass i, StorageClass i,
      Maybe (TokenLC i), [TokenLC i])
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;expected ')' token for this '('&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TokenLC i
</span><a href="#local-6989586621679290270"><span class="hs-identifier hs-var">cur</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-165"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621679290263"><span class="annot"><span class="annottext">ptrf :: StorageClass i -&gt; StorageClass i
</span><a href="#local-6989586621679290263"><span class="hs-identifier hs-var">ptrf</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679290262"><span class="annot"><span class="annottext">ident :: TokenLC i
</span><a href="#local-6989586621679290262"><span class="hs-identifier hs-var">ident</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Htcc.Tokenizer.Token.html#TKIdent"><span class="hs-identifier hs-type">HT.TKIdent</span></a></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679290261"><span class="annot"><span class="annottext">ds' :: [TokenLC i]
</span><a href="#local-6989586621679290261"><span class="hs-identifier hs-var">ds'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">StorageClass i
-&gt; [TokenLC i]
-&gt; ConstructionData i
-&gt; Maybe (Either (ASTError i) (StorageClass i, [TokenLC i]))
forall i.
(Integral i, Bits i, Show i, Read i) =&gt;
StorageClass i
-&gt; [TokenLC i]
-&gt; ConstructionData i
-&gt; Maybe (Either (ASTError i) (StorageClass i, [TokenLC i]))
</span><a href="Htcc.Parser.Parsing.Type.html#arrayDeclSuffix"><span class="hs-identifier hs-var">arrayDeclSuffix</span></a></span><span> </span><span class="annot"><span class="annottext">StorageClass i
</span><a href="#local-6989586621679290274"><span class="hs-identifier hs-var">ty'</span></a></span><span> </span><span class="annot"><span class="annottext">[TokenLC i]
</span><a href="#local-6989586621679290261"><span class="hs-identifier hs-var">ds'</span></a></span><span> </span><span class="annot"><span class="annottext">ConstructionData i
</span><a href="#local-6989586621679290272"><span class="hs-identifier hs-var">scp'</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-166"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(StorageClass i -&gt; StorageClass i, StorageClass i,
 Maybe (TokenLC i), [TokenLC i])
-&gt; Either
     (ASTError i)
     (StorageClass i -&gt; StorageClass i, StorageClass i,
      Maybe (TokenLC i), [TokenLC i])
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StorageClass i -&gt; StorageClass i
</span><a href="#local-6989586621679290263"><span class="hs-identifier hs-var">ptrf</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">StorageClass i
</span><a href="#local-6989586621679290274"><span class="hs-identifier hs-var">ty'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TokenLC i -&gt; Maybe (TokenLC i)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">TokenLC i
</span><a href="#local-6989586621679290262"><span class="hs-identifier hs-var">ident</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[TokenLC i]
</span><a href="#local-6989586621679290261"><span class="hs-identifier hs-var">ds'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-167"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679290260"><span class="annot"><span class="annottext">rs :: Either (ASTError i) (StorageClass i, [TokenLC i])
</span><a href="#local-6989586621679290260"><span class="hs-identifier hs-var">rs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(StorageClass i
 -&gt; [TokenLC i]
 -&gt; (StorageClass i -&gt; StorageClass i, StorageClass i,
     Maybe (TokenLC i), [TokenLC i]))
-&gt; (StorageClass i, [TokenLC i])
-&gt; (StorageClass i -&gt; StorageClass i, StorageClass i,
    Maybe (TokenLC i), [TokenLC i])
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StorageClass i -&gt; StorageClass i
</span><a href="#local-6989586621679290263"><span class="hs-identifier hs-var">ptrf</span></a></span><span class="hs-special">,</span><span class="annot"><span class="hs-special">,</span></span><span class="annot"><span class="annottext">TokenLC i -&gt; Maybe (TokenLC i)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">TokenLC i
</span><a href="#local-6989586621679290262"><span class="hs-identifier hs-var">ident</span></a></span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((StorageClass i, [TokenLC i])
 -&gt; (StorageClass i -&gt; StorageClass i, StorageClass i,
     Maybe (TokenLC i), [TokenLC i]))
-&gt; Either (ASTError i) (StorageClass i, [TokenLC i])
-&gt; Either
     (ASTError i)
     (StorageClass i -&gt; StorageClass i, StorageClass i,
      Maybe (TokenLC i), [TokenLC i])
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Either (ASTError i) (StorageClass i, [TokenLC i])
</span><a href="#local-6989586621679290260"><span class="hs-identifier hs-var">rs</span></a></span><span>
</span><span id="line-168"></span><span>            </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ASTError i
-&gt; Either
     (ASTError i)
     (StorageClass i -&gt; StorageClass i, StorageClass i,
      Maybe (TokenLC i), [TokenLC i])
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;expected some identifier&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TokenLC i
forall i. Num i =&gt; TokenLC i
</span><a href="Htcc.Tokenizer.Token.html#emptyToken"><span class="hs-identifier hs-var">HT.emptyToken</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-169"></span><span>
</span><span id="line-170"></span><span class="hs-comment">-- | `takeType` returns a pair of type (including pointer and array type) and the remaining tokens wrapped in</span><span>
</span><span id="line-171"></span><span class="hs-comment">-- `Just` only if the token starts with `HT.TKType`, `HT.TKStruct` or identifier that is declarated by @typedef@.</span><span>
</span><span id="line-172"></span><span class="hs-comment">-- Otherwise `Nothing` is returned.</span><span>
</span><span id="line-173"></span><span class="hs-comment">--</span><span>
</span><span id="line-174"></span><span class="hs-comment">-- \[</span><span>
</span><span id="line-175"></span><span class="hs-comment">-- \text{type}=\text{pre-type}\ \text{declaration}</span><span>
</span><span id="line-176"></span><span class="hs-comment">-- \]</span><span>
</span><span id="line-177"></span><span id="local-6989586621679290640"><span class="annot"><a href="Htcc.Parser.Parsing.Type.html#takeType"><span class="hs-identifier hs-type">takeType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621679290640"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679290640"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Read</span></span><span> </span><span class="annot"><a href="#local-6989586621679290640"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bits</span></span><span> </span><span class="annot"><a href="#local-6989586621679290640"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Htcc.Tokenizer.Token.html#TokenLC"><span class="hs-identifier hs-type">HT.TokenLC</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679290640"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Htcc.Parser.ConstructionData.Core.html#ConstructionData"><span class="hs-identifier hs-type">ConstructionData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679290640"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Htcc.Parser.ConstructionData.Scope.ManagedScope.html#ASTError"><span class="hs-identifier hs-type">ASTError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679290640"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Htcc.CRules.Types.StorageClass.html#StorageClass"><span class="hs-identifier hs-type">CT.StorageClass</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679290640"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Htcc.Tokenizer.Token.html#TokenLC"><span class="hs-identifier hs-type">HT.TokenLC</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679290640"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Htcc.Tokenizer.Token.html#TokenLC"><span class="hs-identifier hs-type">HT.TokenLC</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679290640"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Htcc.Parser.ConstructionData.Core.html#ConstructionData"><span class="hs-identifier hs-type">ConstructionData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679290640"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-178"></span><span id="takeType"><span class="annot"><span class="annottext">takeType :: [TokenLC i]
-&gt; ConstructionData i
-&gt; Either
     (ASTError i)
     (StorageClass i, Maybe (TokenLC i), [TokenLC i],
      ConstructionData i)
</span><a href="Htcc.Parser.Parsing.Type.html#takeType"><span class="hs-identifier hs-var hs-var">takeType</span></a></span></span><span> </span><span id="local-6989586621679290259"><span class="annot"><span class="annottext">tk :: [TokenLC i]
</span><a href="#local-6989586621679290259"><span class="hs-identifier hs-var">tk</span></a></span></span><span> </span><span id="local-6989586621679290258"><span class="annot"><span class="annottext">scp :: ConstructionData i
</span><a href="#local-6989586621679290258"><span class="hs-identifier hs-var">scp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TokenLC i]
-&gt; ConstructionData i
-&gt; Either
     (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i)
forall i.
(Integral i, Show i, Read i, Bits i) =&gt;
[TokenLC i]
-&gt; ConstructionData i
-&gt; Either
     (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i)
</span><a href="Htcc.Parser.Parsing.Type.html#takePreType"><span class="hs-identifier hs-var">takePreType</span></a></span><span> </span><span class="annot"><span class="annottext">[TokenLC i]
</span><a href="#local-6989586621679290259"><span class="hs-identifier hs-var">tk</span></a></span><span> </span><span class="annot"><span class="annottext">ConstructionData i
</span><a href="#local-6989586621679290258"><span class="hs-identifier hs-var">scp</span></a></span><span> </span><span class="annot"><span class="annottext">Either
  (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i)
-&gt; ((StorageClass i, [TokenLC i], ConstructionData i)
    -&gt; Either
         (ASTError i)
         (StorageClass i, Maybe (TokenLC i), [TokenLC i],
          ConstructionData i))
-&gt; Either
     (ASTError i)
     (StorageClass i, Maybe (TokenLC i), [TokenLC i],
      ConstructionData i)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679290257"><span class="annot"><span class="annottext">x :: StorageClass i
</span><a href="#local-6989586621679290257"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679290256"><span class="annot"><span class="annottext">y :: [TokenLC i]
</span><a href="#local-6989586621679290256"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679290255"><span class="annot"><span class="annottext">z :: ConstructionData i
</span><a href="#local-6989586621679290255"><span class="hs-identifier hs-var">z</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(StorageClass i
 -&gt; Maybe (TokenLC i)
 -&gt; [TokenLC i]
 -&gt; (StorageClass i, Maybe (TokenLC i), [TokenLC i],
     ConstructionData i))
-&gt; (StorageClass i, Maybe (TokenLC i), [TokenLC i])
-&gt; (StorageClass i, Maybe (TokenLC i), [TokenLC i],
    ConstructionData i)
forall a b c d. (a -&gt; b -&gt; c -&gt; d) -&gt; (a, b, c) -&gt; d
</span><span class="hs-identifier hs-var">uncurry3</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-special">,</span></span><span class="annot"><span class="hs-special">,</span></span><span class="annot"><span class="hs-special">,</span></span><span> </span><span class="annot"><span class="annottext">ConstructionData i
</span><a href="#local-6989586621679290255"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((StorageClass i, Maybe (TokenLC i), [TokenLC i])
 -&gt; (StorageClass i, Maybe (TokenLC i), [TokenLC i],
     ConstructionData i))
-&gt; Either
     (ASTError i) (StorageClass i, Maybe (TokenLC i), [TokenLC i])
-&gt; Either
     (ASTError i)
     (StorageClass i, Maybe (TokenLC i), [TokenLC i],
      ConstructionData i)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">StorageClass i
-&gt; [TokenLC i]
-&gt; ConstructionData i
-&gt; Either
     (ASTError i) (StorageClass i, Maybe (TokenLC i), [TokenLC i])
forall i.
(Integral i, Bits i, Show i, Read i) =&gt;
StorageClass i
-&gt; [TokenLC i]
-&gt; ConstructionData i
-&gt; Either
     (ASTError i) (StorageClass i, Maybe (TokenLC i), [TokenLC i])
</span><a href="Htcc.Parser.Parsing.Type.html#declaration"><span class="hs-identifier hs-var">declaration</span></a></span><span> </span><span class="annot"><span class="annottext">StorageClass i
</span><a href="#local-6989586621679290257"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">[TokenLC i]
</span><a href="#local-6989586621679290256"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">ConstructionData i
</span><a href="#local-6989586621679290255"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-179"></span><span>
</span><span id="line-180"></span><span>
</span><span id="line-181"></span><span class="hs-comment">-- | `absDeclaration` parses abstract type declarations:</span><span>
</span><span id="line-182"></span><span class="hs-comment">--</span><span>
</span><span id="line-183"></span><span class="hs-comment">-- \[</span><span>
</span><span id="line-184"></span><span class="hs-comment">-- \text{abs-declaration} = \text{&quot;*&quot;*}\ \left(\text{&quot;(&quot;}\ \text{abs-declaration}\ \text{&quot;)&quot;}\right)\text{?}\ \text{array-decl-suffix}</span><span>
</span><span id="line-185"></span><span class="hs-comment">-- \]</span><span>
</span><span id="line-186"></span><span id="local-6989586621679290518"><span class="annot"><a href="Htcc.Parser.Parsing.Type.html#absDeclaration"><span class="hs-identifier hs-type">absDeclaration</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621679290518"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bits</span></span><span> </span><span class="annot"><a href="#local-6989586621679290518"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679290518"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Read</span></span><span> </span><span class="annot"><a href="#local-6989586621679290518"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Htcc.CRules.Types.StorageClass.html#StorageClass"><span class="hs-identifier hs-type">CT.StorageClass</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679290518"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Htcc.Tokenizer.Token.html#TokenLC"><span class="hs-identifier hs-type">HT.TokenLC</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679290518"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Htcc.Parser.ConstructionData.Core.html#ConstructionData"><span class="hs-identifier hs-type">ConstructionData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679290518"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Htcc.Parser.ConstructionData.Scope.ManagedScope.html#ASTError"><span class="hs-identifier hs-type">ASTError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679290518"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Htcc.CRules.Types.StorageClass.html#StorageClass"><span class="hs-identifier hs-type">CT.StorageClass</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679290518"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Htcc.Tokenizer.Token.html#TokenLC"><span class="hs-identifier hs-type">HT.TokenLC</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679290518"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span></span><span>
</span><span id="line-187"></span><span id="absDeclaration"><span class="annot"><span class="annottext">absDeclaration :: StorageClass i
-&gt; [TokenLC i]
-&gt; ConstructionData i
-&gt; Either (ASTError i) (StorageClass i, [TokenLC i])
</span><a href="Htcc.Parser.Parsing.Type.html#absDeclaration"><span class="hs-identifier hs-var hs-var">absDeclaration</span></a></span></span><span> </span><span id="local-6989586621679290254"><span class="annot"><span class="annottext">ty :: StorageClass i
</span><a href="#local-6989586621679290254"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621679290253"><span class="annot"><span class="annottext">xs :: [TokenLC i]
</span><a href="#local-6989586621679290253"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621679290252"><span class="annot"><span class="annottext">scp :: ConstructionData i
</span><a href="#local-6989586621679290252"><span class="hs-identifier hs-var">scp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[TokenLC i] -&gt; (StorageClass i -&gt; StorageClass i, [TokenLC i])
forall i.
Integral i =&gt;
[TokenLC i] -&gt; (StorageClass i -&gt; StorageClass i, [TokenLC i])
</span><a href="Htcc.Parser.Parsing.Type.html#takeCtorPtr"><span class="hs-identifier hs-var">takeCtorPtr</span></a></span><span> </span><span class="annot"><span class="annottext">[TokenLC i]
</span><a href="#local-6989586621679290253"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-188"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679290251"><span class="annot"><span class="annottext">fn :: StorageClass i -&gt; StorageClass i
</span><a href="#local-6989586621679290251"><span class="hs-identifier hs-var">fn</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679290250"><span class="annot"><span class="annottext">xs' :: [TokenLC i]
</span><a href="#local-6989586621679290250"><span class="hs-identifier hs-var">xs'</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-type">HT.TKReserved</span></a></span><span> </span><span class="hs-string">&quot;(&quot;</span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(StorageClass i -&gt; StorageClass i, StorageClass i, [TokenLC i])
-&gt; (StorageClass i, [TokenLC i])
forall a b c. (a, b, c) -&gt; (b, c)
</span><a href="Htcc.Utils.Tuple.html#dropFst3"><span class="hs-identifier hs-var">dropFst3</span></a></span><span> </span><span class="annot"><span class="annottext">((StorageClass i -&gt; StorageClass i, StorageClass i, [TokenLC i])
 -&gt; (StorageClass i, [TokenLC i]))
-&gt; Either
     (ASTError i)
     (StorageClass i -&gt; StorageClass i, StorageClass i, [TokenLC i])
-&gt; Either (ASTError i) (StorageClass i, [TokenLC i])
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(StorageClass i -&gt; StorageClass i)
-&gt; StorageClass i
-&gt; [TokenLC i]
-&gt; ConstructionData i
-&gt; Either
     (ASTError i)
     (StorageClass i -&gt; StorageClass i, StorageClass i, [TokenLC i])
forall i c.
(Integral i, Bits i, Show i, Read i) =&gt;
(StorageClass i -&gt; c)
-&gt; StorageClass i
-&gt; [TokenLC i]
-&gt; ConstructionData i
-&gt; Either
     (ASTError i)
     (StorageClass i -&gt; StorageClass i, StorageClass i, [TokenLC i])
</span><a href="#local-6989586621679290249"><span class="hs-identifier hs-var">absDeclarator'</span></a></span><span> </span><span class="annot"><span class="annottext">StorageClass i -&gt; StorageClass i
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StorageClass i -&gt; StorageClass i
</span><a href="#local-6989586621679290251"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">StorageClass i
</span><a href="#local-6989586621679290254"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TokenLC i]
</span><a href="#local-6989586621679290250"><span class="hs-identifier hs-var">xs'</span></a></span><span> </span><span class="annot"><span class="annottext">ConstructionData i
</span><a href="#local-6989586621679290252"><span class="hs-identifier hs-var">scp</span></a></span><span>
</span><span id="line-189"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679290248"><span class="annot"><span class="annottext">fn :: StorageClass i -&gt; StorageClass i
</span><a href="#local-6989586621679290248"><span class="hs-identifier hs-var">fn</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679290247"><span class="annot"><span class="annottext">ds :: [TokenLC i]
</span><a href="#local-6989586621679290247"><span class="hs-identifier hs-var">ds</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either (ASTError i) (StorageClass i, [TokenLC i])
-&gt; Maybe (Either (ASTError i) (StorageClass i, [TokenLC i]))
-&gt; Either (ASTError i) (StorageClass i, [TokenLC i])
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(StorageClass i, [TokenLC i])
-&gt; Either (ASTError i) (StorageClass i, [TokenLC i])
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StorageClass i -&gt; StorageClass i
</span><a href="#local-6989586621679290248"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">StorageClass i
</span><a href="#local-6989586621679290254"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[TokenLC i]
</span><a href="#local-6989586621679290247"><span class="hs-identifier hs-var">ds</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe (Either (ASTError i) (StorageClass i, [TokenLC i]))
 -&gt; Either (ASTError i) (StorageClass i, [TokenLC i]))
-&gt; Maybe (Either (ASTError i) (StorageClass i, [TokenLC i]))
-&gt; Either (ASTError i) (StorageClass i, [TokenLC i])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StorageClass i
-&gt; [TokenLC i]
-&gt; ConstructionData i
-&gt; Maybe (Either (ASTError i) (StorageClass i, [TokenLC i]))
forall i.
(Integral i, Bits i, Show i, Read i) =&gt;
StorageClass i
-&gt; [TokenLC i]
-&gt; ConstructionData i
-&gt; Maybe (Either (ASTError i) (StorageClass i, [TokenLC i]))
</span><a href="Htcc.Parser.Parsing.Type.html#arrayDeclSuffix"><span class="hs-identifier hs-var">arrayDeclSuffix</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StorageClass i -&gt; StorageClass i
</span><a href="#local-6989586621679290248"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">StorageClass i
</span><a href="#local-6989586621679290254"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TokenLC i]
</span><a href="#local-6989586621679290247"><span class="hs-identifier hs-var">ds</span></a></span><span> </span><span class="annot"><span class="annottext">ConstructionData i
</span><a href="#local-6989586621679290252"><span class="hs-identifier hs-var">scp</span></a></span><span>
</span><span id="line-190"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-191"></span><span>        </span><span id="local-6989586621679290249"><span class="annot"><span class="annottext">absDeclarator' :: (StorageClass i -&gt; c)
-&gt; StorageClass i
-&gt; [TokenLC i]
-&gt; ConstructionData i
-&gt; Either
     (ASTError i)
     (StorageClass i -&gt; StorageClass i, StorageClass i, [TokenLC i])
</span><a href="#local-6989586621679290249"><span class="hs-identifier hs-var hs-var">absDeclarator'</span></a></span></span><span> </span><span id="local-6989586621679290246"><span class="annot"><span class="annottext">fn :: StorageClass i -&gt; c
</span><a href="#local-6989586621679290246"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span id="local-6989586621679290245"><span class="annot"><span class="annottext">ty' :: StorageClass i
</span><a href="#local-6989586621679290245"><span class="hs-identifier hs-var">ty'</span></a></span></span><span> </span><span id="local-6989586621679290244"><span class="annot"><span class="annottext">xs' :: [TokenLC i]
</span><a href="#local-6989586621679290244"><span class="hs-identifier hs-var">xs'</span></a></span></span><span> </span><span id="local-6989586621679290243"><span class="annot"><span class="annottext">scp' :: ConstructionData i
</span><a href="#local-6989586621679290243"><span class="hs-identifier hs-var">scp'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[TokenLC i] -&gt; (StorageClass i -&gt; StorageClass i, [TokenLC i])
forall i.
Integral i =&gt;
[TokenLC i] -&gt; (StorageClass i -&gt; StorageClass i, [TokenLC i])
</span><a href="Htcc.Parser.Parsing.Type.html#takeCtorPtr"><span class="hs-identifier hs-var">takeCtorPtr</span></a></span><span> </span><span class="annot"><span class="annottext">[TokenLC i]
</span><a href="#local-6989586621679290244"><span class="hs-identifier hs-var">xs'</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-192"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621679290242"><span class="annot"><span class="annottext">ptrf :: StorageClass i -&gt; StorageClass i
</span><a href="#local-6989586621679290242"><span class="hs-identifier hs-var">ptrf</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679290241"><span class="annot"><span class="annottext">cur :: TokenLC i
</span><a href="#local-6989586621679290241"><span class="hs-identifier hs-var">cur</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-type">HT.TKReserved</span></a></span><span> </span><span class="hs-string">&quot;(&quot;</span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679290240"><span class="annot"><span class="annottext">ds' :: [TokenLC i]
</span><a href="#local-6989586621679290240"><span class="hs-identifier hs-var">ds'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either
  (ASTError i)
  (StorageClass i -&gt; StorageClass i, StorageClass i, [TokenLC i])
-&gt; ((StorageClass i -&gt; StorageClass i, StorageClass i, [TokenLC i])
    -&gt; Either
         (ASTError i)
         (StorageClass i -&gt; StorageClass i, StorageClass i, [TokenLC i]))
-&gt; Either
     (ASTError i)
     (StorageClass i -&gt; StorageClass i, StorageClass i, [TokenLC i])
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">(&gt;&gt;=)</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(StorageClass i -&gt; c)
-&gt; StorageClass i
-&gt; [TokenLC i]
-&gt; ConstructionData i
-&gt; Either
     (ASTError i)
     (StorageClass i -&gt; StorageClass i, StorageClass i, [TokenLC i])
</span><a href="#local-6989586621679290249"><span class="hs-identifier hs-var">absDeclarator'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StorageClass i -&gt; c
</span><a href="#local-6989586621679290246"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">(StorageClass i -&gt; c)
-&gt; (StorageClass i -&gt; StorageClass i) -&gt; StorageClass i -&gt; c
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">StorageClass i -&gt; StorageClass i
</span><a href="#local-6989586621679290242"><span class="hs-identifier hs-var">ptrf</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StorageClass i
</span><a href="#local-6989586621679290245"><span class="hs-identifier hs-var">ty'</span></a></span><span> </span><span class="annot"><span class="annottext">[TokenLC i]
</span><a href="#local-6989586621679290240"><span class="hs-identifier hs-var">ds'</span></a></span><span> </span><span class="annot"><span class="annottext">ConstructionData i
</span><a href="#local-6989586621679290243"><span class="hs-identifier hs-var">scp'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(((StorageClass i -&gt; StorageClass i, StorageClass i, [TokenLC i])
  -&gt; Either
       (ASTError i)
       (StorageClass i -&gt; StorageClass i, StorageClass i, [TokenLC i]))
 -&gt; Either
      (ASTError i)
      (StorageClass i -&gt; StorageClass i, StorageClass i, [TokenLC i]))
-&gt; ((StorageClass i -&gt; StorageClass i, StorageClass i, [TokenLC i])
    -&gt; Either
         (ASTError i)
         (StorageClass i -&gt; StorageClass i, StorageClass i, [TokenLC i]))
-&gt; Either
     (ASTError i)
     (StorageClass i -&gt; StorageClass i, StorageClass i, [TokenLC i])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-193"></span><span>                </span><span class="hs-special">(</span><span id="local-6989586621679290239"><span class="annot"><span class="annottext">ptrf' :: StorageClass i -&gt; StorageClass i
</span><a href="#local-6989586621679290239"><span class="hs-identifier hs-var">ptrf'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679290238"><span class="annot"><span class="annottext">ty'' :: StorageClass i
</span><a href="#local-6989586621679290238"><span class="hs-identifier hs-var">ty''</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-type">HT.TKReserved</span></a></span><span> </span><span class="hs-string">&quot;)&quot;</span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679290237"><span class="annot"><span class="annottext">ds'' :: [TokenLC i]
</span><a href="#local-6989586621679290237"><span class="hs-identifier hs-var">ds''</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either
  (ASTError i)
  (StorageClass i -&gt; StorageClass i, StorageClass i, [TokenLC i])
-&gt; (Either (ASTError i) (StorageClass i, [TokenLC i])
    -&gt; Either
         (ASTError i)
         (StorageClass i -&gt; StorageClass i, StorageClass i, [TokenLC i]))
-&gt; Maybe (Either (ASTError i) (StorageClass i, [TokenLC i]))
-&gt; Either
     (ASTError i)
     (StorageClass i -&gt; StorageClass i, StorageClass i, [TokenLC i])
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(StorageClass i -&gt; StorageClass i, StorageClass i, [TokenLC i])
-&gt; Either
     (ASTError i)
     (StorageClass i -&gt; StorageClass i, StorageClass i, [TokenLC i])
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StorageClass i -&gt; StorageClass i
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">StorageClass i -&gt; StorageClass i
</span><a href="#local-6989586621679290239"><span class="hs-identifier hs-var">ptrf'</span></a></span><span> </span><span class="annot"><span class="annottext">StorageClass i
</span><a href="#local-6989586621679290238"><span class="hs-identifier hs-var">ty''</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[TokenLC i]
</span><a href="#local-6989586621679290237"><span class="hs-identifier hs-var">ds''</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((StorageClass i, [TokenLC i])
 -&gt; (StorageClass i -&gt; StorageClass i, StorageClass i, [TokenLC i]))
-&gt; Either (ASTError i) (StorageClass i, [TokenLC i])
-&gt; Either
     (ASTError i)
     (StorageClass i -&gt; StorageClass i, StorageClass i, [TokenLC i])
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(StorageClass i
 -&gt; [TokenLC i]
 -&gt; (StorageClass i -&gt; StorageClass i, StorageClass i, [TokenLC i]))
-&gt; (StorageClass i, [TokenLC i])
-&gt; (StorageClass i -&gt; StorageClass i, StorageClass i, [TokenLC i])
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StorageClass i -&gt; StorageClass i
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-special">,</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((StorageClass i, [TokenLC i])
 -&gt; (StorageClass i -&gt; StorageClass i, StorageClass i, [TokenLC i]))
-&gt; ((StorageClass i, [TokenLC i]) -&gt; (StorageClass i, [TokenLC i]))
-&gt; (StorageClass i, [TokenLC i])
-&gt; (StorageClass i -&gt; StorageClass i, StorageClass i, [TokenLC i])
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(StorageClass i -&gt; StorageClass i)
-&gt; (StorageClass i, [TokenLC i]) -&gt; (StorageClass i, [TokenLC i])
forall a a' b. (a -&gt; a') -&gt; (a, b) -&gt; (a', b)
</span><span class="hs-identifier hs-var">first</span></span><span> </span><span class="annot"><span class="annottext">StorageClass i -&gt; StorageClass i
</span><a href="#local-6989586621679290239"><span class="hs-identifier hs-var">ptrf'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe (Either (ASTError i) (StorageClass i, [TokenLC i]))
 -&gt; Either
      (ASTError i)
      (StorageClass i -&gt; StorageClass i, StorageClass i, [TokenLC i]))
-&gt; Maybe (Either (ASTError i) (StorageClass i, [TokenLC i]))
-&gt; Either
     (ASTError i)
     (StorageClass i -&gt; StorageClass i, StorageClass i, [TokenLC i])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StorageClass i
-&gt; [TokenLC i]
-&gt; ConstructionData i
-&gt; Maybe (Either (ASTError i) (StorageClass i, [TokenLC i]))
forall i.
(Integral i, Bits i, Show i, Read i) =&gt;
StorageClass i
-&gt; [TokenLC i]
-&gt; ConstructionData i
-&gt; Maybe (Either (ASTError i) (StorageClass i, [TokenLC i]))
</span><a href="Htcc.Parser.Parsing.Type.html#arrayDeclSuffix"><span class="hs-identifier hs-var">arrayDeclSuffix</span></a></span><span> </span><span class="annot"><span class="annottext">StorageClass i
</span><a href="#local-6989586621679290238"><span class="hs-identifier hs-var">ty''</span></a></span><span> </span><span class="annot"><span class="annottext">[TokenLC i]
</span><a href="#local-6989586621679290237"><span class="hs-identifier hs-var">ds''</span></a></span><span> </span><span class="annot"><span class="annottext">ConstructionData i
</span><a href="#local-6989586621679290243"><span class="hs-identifier hs-var">scp'</span></a></span><span>
</span><span id="line-194"></span><span>                </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ASTError i
-&gt; Either
     (ASTError i)
     (StorageClass i -&gt; StorageClass i, StorageClass i, [TokenLC i])
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;expected ')' token for this '('&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TokenLC i
</span><a href="#local-6989586621679290241"><span class="hs-identifier hs-var">cur</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-195"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621679290235"><span class="annot"><span class="annottext">p :: StorageClass i -&gt; StorageClass i
</span><a href="#local-6989586621679290235"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679290234"><span class="annot"><span class="annottext">ds :: [TokenLC i]
</span><a href="#local-6989586621679290234"><span class="hs-identifier hs-var">ds</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(StorageClass i -&gt; StorageClass i, StorageClass i, [TokenLC i])
-&gt; Either
     (ASTError i)
     (StorageClass i -&gt; StorageClass i, StorageClass i, [TokenLC i])
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StorageClass i -&gt; StorageClass i
</span><a href="#local-6989586621679290235"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">StorageClass i
</span><a href="#local-6989586621679290245"><span class="hs-identifier hs-var">ty'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[TokenLC i]
</span><a href="#local-6989586621679290234"><span class="hs-identifier hs-var">ds</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-196"></span><span>
</span><span id="line-197"></span><span class="hs-comment">-- | `takeTypeName` is used to parse type names used for sizeof etc. Version without `takeType`s identifier.</span><span>
</span><span id="line-198"></span><span id="local-6989586621679290233"><span class="annot"><a href="Htcc.Parser.Parsing.Type.html#takeTypeName"><span class="hs-identifier hs-type">takeTypeName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621679290233"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679290233"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Read</span></span><span> </span><span class="annot"><a href="#local-6989586621679290233"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bits</span></span><span> </span><span class="annot"><a href="#local-6989586621679290233"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Htcc.Tokenizer.Token.html#TokenLC"><span class="hs-identifier hs-type">HT.TokenLC</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679290233"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Htcc.Parser.ConstructionData.Core.html#ConstructionData"><span class="hs-identifier hs-type">ConstructionData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679290233"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Htcc.Parser.ConstructionData.Scope.ManagedScope.html#ASTError"><span class="hs-identifier hs-type">ASTError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679290233"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Htcc.CRules.Types.StorageClass.html#StorageClass"><span class="hs-identifier hs-type">CT.StorageClass</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679290233"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Htcc.Tokenizer.Token.html#TokenLC"><span class="hs-identifier hs-type">HT.TokenLC</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679290233"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span></span><span>
</span><span id="line-199"></span><span id="takeTypeName"><span class="annot"><span class="annottext">takeTypeName :: [TokenLC i]
-&gt; ConstructionData i
-&gt; Either (ASTError i) (StorageClass i, [TokenLC i])
</span><a href="Htcc.Parser.Parsing.Type.html#takeTypeName"><span class="hs-identifier hs-var hs-var">takeTypeName</span></a></span></span><span> </span><span id="local-6989586621679290232"><span class="annot"><span class="annottext">tk :: [TokenLC i]
</span><a href="#local-6989586621679290232"><span class="hs-identifier hs-var">tk</span></a></span></span><span> </span><span id="local-6989586621679290231"><span class="annot"><span class="annottext">scp :: ConstructionData i
</span><a href="#local-6989586621679290231"><span class="hs-identifier hs-var">scp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Either
  (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i)
-&gt; ((StorageClass i, [TokenLC i], ConstructionData i)
    -&gt; Either (ASTError i) (StorageClass i, [TokenLC i]))
-&gt; Either (ASTError i) (StorageClass i, [TokenLC i])
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">(&gt;&gt;=)</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TokenLC i]
-&gt; ConstructionData i
-&gt; Either
     (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i)
forall i.
(Integral i, Show i, Read i, Bits i) =&gt;
[TokenLC i]
-&gt; ConstructionData i
-&gt; Either
     (ASTError i) (StorageClass i, [TokenLC i], ConstructionData i)
</span><a href="Htcc.Parser.Parsing.Type.html#takePreType"><span class="hs-identifier hs-var">takePreType</span></a></span><span> </span><span class="annot"><span class="annottext">[TokenLC i]
</span><a href="#local-6989586621679290232"><span class="hs-identifier hs-var">tk</span></a></span><span> </span><span class="annot"><span class="annottext">ConstructionData i
</span><a href="#local-6989586621679290231"><span class="hs-identifier hs-var">scp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(((StorageClass i, [TokenLC i], ConstructionData i)
  -&gt; Either (ASTError i) (StorageClass i, [TokenLC i]))
 -&gt; Either (ASTError i) (StorageClass i, [TokenLC i]))
-&gt; ((StorageClass i, [TokenLC i], ConstructionData i)
    -&gt; Either (ASTError i) (StorageClass i, [TokenLC i]))
-&gt; Either (ASTError i) (StorageClass i, [TokenLC i])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679290230"><span class="annot"><span class="annottext">x :: StorageClass i
</span><a href="#local-6989586621679290230"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679290229"><span class="annot"><span class="annottext">y :: [TokenLC i]
</span><a href="#local-6989586621679290229"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679290228"><span class="annot"><span class="annottext">z :: ConstructionData i
</span><a href="#local-6989586621679290228"><span class="hs-identifier hs-var">z</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">StorageClass i -&gt; Bool
forall (a :: * -&gt; *) i. StorageClassBase a =&gt; a i -&gt; Bool
</span><a href="Htcc.CRules.Types.StorageClass.html#isSCStatic"><span class="hs-identifier hs-var">CT.isSCStatic</span></a></span><span> </span><span class="annot"><span class="annottext">StorageClass i
</span><a href="#local-6989586621679290230"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">ASTError i -&gt; Either (ASTError i) (StorageClass i, [TokenLC i])
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;storage-class specifier is not allowed&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[TokenLC i] -&gt; TokenLC i
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">[TokenLC i]
</span><a href="#local-6989586621679290232"><span class="hs-identifier hs-var">tk</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">StorageClass i
-&gt; [TokenLC i]
-&gt; ConstructionData i
-&gt; Either (ASTError i) (StorageClass i, [TokenLC i])
forall i.
(Integral i, Bits i, Show i, Read i) =&gt;
StorageClass i
-&gt; [TokenLC i]
-&gt; ConstructionData i
-&gt; Either (ASTError i) (StorageClass i, [TokenLC i])
</span><a href="Htcc.Parser.Parsing.Type.html#absDeclaration"><span class="hs-identifier hs-var">absDeclaration</span></a></span><span> </span><span class="annot"><span class="annottext">StorageClass i
</span><a href="#local-6989586621679290230"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">[TokenLC i]
</span><a href="#local-6989586621679290229"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">ConstructionData i
</span><a href="#local-6989586621679290228"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="hs-comment">-- !</span><span>
</span><span id="line-200"></span><span>
</span><span id="line-201"></span><span class="hs-comment">-- | @HT.TKReserved &quot;[&quot;, n, HT.TKReserved &quot;]&quot;@ from the beginning of the token sequence.</span><span>
</span><span id="line-202"></span><span class="hs-comment">-- `arrayDeclSuffix` constructs an array type of the given type @t@ based on</span><span>
</span><span id="line-203"></span><span class="hs-comment">-- the token sequence if \(k\leq 1\), wraps it in `Right` and `Just` and returns it with the rest of the token sequence.</span><span>
</span><span id="line-204"></span><span class="hs-comment">-- If the token @HT.TKReserved &quot;[&quot;@ exists at the beginning of the token sequence,</span><span>
</span><span id="line-205"></span><span class="hs-comment">-- but the subsequent token sequence is invalid as an array declaration in C programming language,</span><span>
</span><span id="line-206"></span><span class="hs-comment">-- an error mesage and the token at the error location are returned wrapped in</span><span>
</span><span id="line-207"></span><span class="hs-comment">-- `Left` and `Just`. When \(k=0\), `Nothing` is returned.</span><span>
</span><span id="line-208"></span><span class="hs-comment">--</span><span>
</span><span id="line-209"></span><span class="hs-comment">-- \[</span><span>
</span><span id="line-210"></span><span class="hs-comment">-- \text{array-decl-suffix}=\left(\text{&quot;[&quot;}\ \text{const-expr?}\ \text{&quot;]&quot;}\ \text{array-decl-suffix}\right)\text{?}</span><span>
</span><span id="line-211"></span><span class="hs-comment">-- \]</span><span>
</span><span id="line-212"></span><span class="annot"><a href="Htcc.Parser.Parsing.Type.html#arrayDeclSuffix"><span class="hs-identifier hs-type">arrayDeclSuffix</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679290541"><span class="annot"><a href="#local-6989586621679290541"><span class="hs-identifier hs-type">i</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621679290541"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bits</span></span><span> </span><span class="annot"><a href="#local-6989586621679290541"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679290541"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Read</span></span><span> </span><span class="annot"><a href="#local-6989586621679290541"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Htcc.CRules.Types.StorageClass.html#StorageClass"><span class="hs-identifier hs-type">CT.StorageClass</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679290541"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Htcc.Tokenizer.Token.html#TokenLC"><span class="hs-identifier hs-type">HT.TokenLC</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679290541"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Htcc.Parser.ConstructionData.Core.html#ConstructionData"><span class="hs-identifier hs-type">ConstructionData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679290541"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Htcc.Parser.ConstructionData.Scope.ManagedScope.html#ASTError"><span class="hs-identifier hs-type">ASTError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679290541"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Htcc.CRules.Types.StorageClass.html#StorageClass"><span class="hs-identifier hs-type">CT.StorageClass</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679290541"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Htcc.Tokenizer.Token.html#TokenLC"><span class="hs-identifier hs-type">HT.TokenLC</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679290541"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-213"></span><span id="arrayDeclSuffix"><span class="annot"><span class="annottext">arrayDeclSuffix :: StorageClass i
-&gt; [TokenLC i]
-&gt; ConstructionData i
-&gt; Maybe (Either (ASTError i) (StorageClass i, [TokenLC i]))
</span><a href="Htcc.Parser.Parsing.Type.html#arrayDeclSuffix"><span class="hs-identifier hs-var hs-var">arrayDeclSuffix</span></a></span></span><span> </span><span id="local-6989586621679290226"><span class="annot"><span class="annottext">t :: StorageClass i
</span><a href="#local-6989586621679290226"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679290225"><span class="annot"><span class="annottext">cur :: TokenLC i
</span><a href="#local-6989586621679290225"><span class="hs-identifier hs-var">cur</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-type">HT.TKReserved</span></a></span><span> </span><span class="hs-string">&quot;[&quot;</span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-type">HT.TKReserved</span></a></span><span> </span><span class="hs-string">&quot;]&quot;</span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679290224"><span class="annot"><span class="annottext">xs :: [TokenLC i]
</span><a href="#local-6989586621679290224"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679290223"><span class="annot"><span class="annottext">scp :: ConstructionData i
</span><a href="#local-6989586621679290223"><span class="hs-identifier hs-var">scp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">StorageClass i
-&gt; [TokenLC i]
-&gt; ConstructionData i
-&gt; Maybe (Either (ASTError i) (StorageClass i, [TokenLC i]))
forall i.
(Integral i, Bits i, Show i, Read i) =&gt;
StorageClass i
-&gt; [TokenLC i]
-&gt; ConstructionData i
-&gt; Maybe (Either (ASTError i) (StorageClass i, [TokenLC i]))
</span><a href="Htcc.Parser.Parsing.Type.html#arrayDeclSuffix"><span class="hs-identifier hs-var">arrayDeclSuffix</span></a></span><span> </span><span class="annot"><span class="annottext">StorageClass i
</span><a href="#local-6989586621679290226"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">[TokenLC i]
</span><a href="#local-6989586621679290224"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">ConstructionData i
</span><a href="#local-6989586621679290223"><span class="hs-identifier hs-var">scp</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-214"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either (ASTError i) (StorageClass i, [TokenLC i])
-&gt; Maybe (Either (ASTError i) (StorageClass i, [TokenLC i]))
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="hs-special">,</span></span><span class="annot"><span class="annottext">[TokenLC i]
</span><a href="#local-6989586621679290224"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(StorageClass i -&gt; (StorageClass i, [TokenLC i]))
-&gt; (StorageClass i -&gt; StorageClass i)
-&gt; StorageClass i
-&gt; (StorageClass i, [TokenLC i])
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(TypeKind i -&gt; TypeKind i) -&gt; StorageClass i -&gt; StorageClass i
forall (a :: * -&gt; *) i j.
TypeKindBase a =&gt;
(TypeKind i -&gt; TypeKind j) -&gt; a i -&gt; a j
</span><a href="Htcc.CRules.Types.TypeKind.html#mapTypeKind"><span class="hs-identifier hs-var">CT.mapTypeKind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Incomplete i -&gt; TypeKind i
forall i. Incomplete i -&gt; TypeKind i
</span><a href="Htcc.CRules.Types.TypeKind.html#CTIncomplete"><span class="hs-identifier hs-var">CT.CTIncomplete</span></a></span><span> </span><span class="annot"><span class="annottext">(Incomplete i -&gt; TypeKind i)
-&gt; (TypeKind i -&gt; Incomplete i) -&gt; TypeKind i -&gt; TypeKind i
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TypeKind i -&gt; Incomplete i
forall i. TypeKind i -&gt; Incomplete i
</span><a href="Htcc.CRules.Types.TypeKind.html#IncompleteArray"><span class="hs-identifier hs-var">CT.IncompleteArray</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(StorageClass i -&gt; (StorageClass i, [TokenLC i]))
-&gt; Either (ASTError i) (StorageClass i)
-&gt; Either (ASTError i) (StorageClass i, [TokenLC i])
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ASTError i
-&gt; Maybe (StorageClass i) -&gt; Either (ASTError i) (StorageClass i)
forall e. e -&gt; Maybe ~&gt; Either e
</span><a href="Htcc.Utils.NaturalTransformations.html#maybeToRight"><span class="hs-identifier hs-var">maybeToRight</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StorageClass i -&gt; ASTError i
forall a. Show a =&gt; a -&gt; ASTError i
</span><a href="#local-6989586621679290220"><span class="hs-identifier hs-var">errSt</span></a></span><span> </span><span class="annot"><span class="annottext">StorageClass i
</span><a href="#local-6989586621679290226"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StorageClass i -&gt; ConstructionData i -&gt; Maybe (StorageClass i)
forall i.
StorageClass i -&gt; ConstructionData i -&gt; Maybe (StorageClass i)
</span><a href="Htcc.Parser.ConstructionData.Core.html#incomplete"><span class="hs-identifier hs-var">incomplete</span></a></span><span> </span><span class="annot"><span class="annottext">StorageClass i
</span><a href="#local-6989586621679290226"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">ConstructionData i
</span><a href="#local-6989586621679290223"><span class="hs-identifier hs-var">scp</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-215"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679290219"><span class="annot"><span class="annottext">rs :: Either (ASTError i) (StorageClass i, [TokenLC i])
</span><a href="#local-6989586621679290219"><span class="hs-identifier hs-var">rs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either (ASTError i) (StorageClass i, [TokenLC i])
-&gt; Maybe (Either (ASTError i) (StorageClass i, [TokenLC i]))
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Either (ASTError i) (StorageClass i, [TokenLC i])
 -&gt; Maybe (Either (ASTError i) (StorageClass i, [TokenLC i])))
-&gt; (((StorageClass i, [TokenLC i])
     -&gt; Either (ASTError i) (StorageClass i, [TokenLC i]))
    -&gt; Either (ASTError i) (StorageClass i, [TokenLC i]))
-&gt; ((StorageClass i, [TokenLC i])
    -&gt; Either (ASTError i) (StorageClass i, [TokenLC i]))
-&gt; Maybe (Either (ASTError i) (StorageClass i, [TokenLC i]))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Either (ASTError i) (StorageClass i, [TokenLC i])
-&gt; ((StorageClass i, [TokenLC i])
    -&gt; Either (ASTError i) (StorageClass i, [TokenLC i]))
-&gt; Either (ASTError i) (StorageClass i, [TokenLC i])
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">(&gt;&gt;=)</span></span><span> </span><span class="annot"><span class="annottext">Either (ASTError i) (StorageClass i, [TokenLC i])
</span><a href="#local-6989586621679290219"><span class="hs-identifier hs-var">rs</span></a></span><span> </span><span class="annot"><span class="annottext">(((StorageClass i, [TokenLC i])
  -&gt; Either (ASTError i) (StorageClass i, [TokenLC i]))
 -&gt; Maybe (Either (ASTError i) (StorageClass i, [TokenLC i])))
-&gt; ((StorageClass i, [TokenLC i])
    -&gt; Either (ASTError i) (StorageClass i, [TokenLC i]))
-&gt; Maybe (Either (ASTError i) (StorageClass i, [TokenLC i]))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679290218"><span class="annot"><span class="annottext">t' :: StorageClass i
</span><a href="#local-6989586621679290218"><span class="hs-identifier hs-var">t'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679290217"><span class="annot"><span class="annottext">ds :: [TokenLC i]
</span><a href="#local-6989586621679290217"><span class="hs-identifier hs-var">ds</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-special">,</span></span><span class="annot"><span class="annottext">[TokenLC i]
</span><a href="#local-6989586621679290217"><span class="hs-identifier hs-var">ds</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(StorageClass i -&gt; (StorageClass i, [TokenLC i]))
-&gt; (StorageClass i -&gt; StorageClass i)
-&gt; StorageClass i
-&gt; (StorageClass i, [TokenLC i])
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(TypeKind i -&gt; TypeKind i) -&gt; StorageClass i -&gt; StorageClass i
forall (a :: * -&gt; *) i j.
TypeKindBase a =&gt;
(TypeKind i -&gt; TypeKind j) -&gt; a i -&gt; a j
</span><a href="Htcc.CRules.Types.TypeKind.html#mapTypeKind"><span class="hs-identifier hs-var">CT.mapTypeKind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(TypeKind i -&gt; TypeKind i -&gt; TypeKind i)
-&gt; (TypeKind i, TypeKind i) -&gt; TypeKind i
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Maybe (TypeKind i) -&gt; TypeKind i)
-&gt; (TypeKind i -&gt; Maybe (TypeKind i)) -&gt; TypeKind i -&gt; TypeKind i
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">(.)</span></span><span> </span><span class="annot"><span class="annottext">Maybe (TypeKind i) -&gt; TypeKind i
forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromJust</span></span><span> </span><span class="annot"><span class="annottext">((TypeKind i -&gt; Maybe (TypeKind i)) -&gt; TypeKind i -&gt; TypeKind i)
-&gt; (TypeKind i -&gt; TypeKind i -&gt; Maybe (TypeKind i))
-&gt; TypeKind i
-&gt; TypeKind i
-&gt; TypeKind i
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TypeKind i -&gt; TypeKind i -&gt; Maybe (TypeKind i)
forall (a :: * -&gt; *) i.
(TypeKindBase a, Ord i) =&gt;
a i -&gt; a i -&gt; Maybe (a i)
</span><a href="Htcc.CRules.Types.TypeKind.html#concatCTArray"><span class="hs-identifier hs-var">CT.concatCTArray</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((TypeKind i, TypeKind i) -&gt; TypeKind i)
-&gt; (TypeKind i -&gt; (TypeKind i, TypeKind i))
-&gt; TypeKind i
-&gt; TypeKind i
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(TypeKind i -&gt; TypeKind i)
-&gt; (TypeKind i, TypeKind i) -&gt; (TypeKind i, TypeKind i)
forall a a' b. (a -&gt; a') -&gt; (a, b) -&gt; (a', b)
</span><span class="hs-identifier hs-var">first</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Incomplete i -&gt; TypeKind i
forall i. Incomplete i -&gt; TypeKind i
</span><a href="Htcc.CRules.Types.TypeKind.html#CTIncomplete"><span class="hs-identifier hs-var">CT.CTIncomplete</span></a></span><span> </span><span class="annot"><span class="annottext">(Incomplete i -&gt; TypeKind i)
-&gt; (TypeKind i -&gt; Incomplete i) -&gt; TypeKind i -&gt; TypeKind i
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TypeKind i -&gt; Incomplete i
forall i. TypeKind i -&gt; Incomplete i
</span><a href="Htcc.CRules.Types.TypeKind.html#IncompleteArray"><span class="hs-identifier hs-var">CT.IncompleteArray</span></a></span><span> </span><span class="annot"><span class="annottext">(TypeKind i -&gt; Incomplete i)
-&gt; (TypeKind i -&gt; TypeKind i) -&gt; TypeKind i -&gt; Incomplete i
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TypeKind i -&gt; TypeKind i
forall a. CType a =&gt; a -&gt; a
</span><a href="Htcc.CRules.Types.CType.html#removeAllExtents"><span class="hs-identifier hs-var">CT.removeAllExtents</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((TypeKind i, TypeKind i) -&gt; (TypeKind i, TypeKind i))
-&gt; (TypeKind i -&gt; (TypeKind i, TypeKind i))
-&gt; TypeKind i
-&gt; (TypeKind i, TypeKind i)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TypeKind i -&gt; (TypeKind i, TypeKind i)
forall a. a -&gt; (a, a)
</span><span class="hs-identifier hs-var">dupe</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(StorageClass i -&gt; (StorageClass i, [TokenLC i]))
-&gt; Either (ASTError i) (StorageClass i)
-&gt; Either (ASTError i) (StorageClass i, [TokenLC i])
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span>
</span><span id="line-216"></span><span>        </span><span class="annot"><span class="annottext">ASTError i
-&gt; Maybe (StorageClass i) -&gt; Either (ASTError i) (StorageClass i)
forall e. e -&gt; Maybe ~&gt; Either e
</span><a href="Htcc.Utils.NaturalTransformations.html#maybeToRight"><span class="hs-identifier hs-var">maybeToRight</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StorageClass i -&gt; ASTError i
forall a. Show a =&gt; a -&gt; ASTError i
</span><a href="#local-6989586621679290220"><span class="hs-identifier hs-var">errSt</span></a></span><span> </span><span class="annot"><span class="annottext">StorageClass i
</span><a href="#local-6989586621679290218"><span class="hs-identifier hs-var">t'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StorageClass i -&gt; ConstructionData i -&gt; Maybe (StorageClass i)
forall i.
StorageClass i -&gt; ConstructionData i -&gt; Maybe (StorageClass i)
</span><a href="Htcc.Parser.ConstructionData.Core.html#incomplete"><span class="hs-identifier hs-var">incomplete</span></a></span><span> </span><span class="annot"><span class="annottext">StorageClass i
</span><a href="#local-6989586621679290218"><span class="hs-identifier hs-var">t'</span></a></span><span> </span><span class="annot"><span class="annottext">ConstructionData i
</span><a href="#local-6989586621679290223"><span class="hs-identifier hs-var">scp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-217"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-218"></span><span>        </span><span id="local-6989586621679290220"><span class="annot"><span class="annottext">errSt :: a -&gt; ASTError i
</span><a href="#local-6989586621679290220"><span class="hs-identifier hs-var hs-var">errSt</span></a></span></span><span> </span><span id="local-6989586621679290214"><span class="annot"><span class="annottext">t' :: a
</span><a href="#local-6989586621679290214"><span class="hs-identifier hs-var">t'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;array type has incomplete element type '&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Text
forall a. Show a =&gt; a -&gt; Text
</span><a href="Htcc.Utils.Text.html#tshow"><span class="hs-identifier hs-var">tshow</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679290214"><span class="hs-identifier hs-var">t'</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="hs-string">&quot;'&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TokenLC i
</span><a href="#local-6989586621679290225"><span class="hs-identifier hs-var">cur</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-219"></span><span class="annot"><a href="Htcc.Parser.Parsing.Type.html#arrayDeclSuffix"><span class="hs-identifier hs-var">arrayDeclSuffix</span></a></span><span> </span><span id="local-6989586621679290213"><span class="annot"><span class="annottext">t :: StorageClass i
</span><a href="#local-6989586621679290213"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679290212"><span class="annot"><span class="annottext">cur :: TokenLC i
</span><a href="#local-6989586621679290212"><span class="hs-identifier hs-var">cur</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-type">HT.TKReserved</span></a></span><span> </span><span class="hs-string">&quot;[&quot;</span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679290211"><span class="annot"><span class="annottext">xs :: [TokenLC i]
</span><a href="#local-6989586621679290211"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679290210"><span class="annot"><span class="annottext">scp :: ConstructionData i
</span><a href="#local-6989586621679290210"><span class="hs-identifier hs-var">scp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[TokenLC i]
-&gt; ConstructionData i -&gt; Either (ConstantResult i) ([TokenLC i], i)
forall i.
(Bits i, Integral i, Show i, Read i) =&gt;
[TokenLC i]
-&gt; ConstructionData i -&gt; Either (ConstantResult i) ([TokenLC i], i)
</span><a href="Htcc.Parser.Parsing.Type.html#constantExp"><span class="hs-identifier hs-var">constantExp</span></a></span><span> </span><span class="annot"><span class="annottext">[TokenLC i]
</span><a href="#local-6989586621679290211"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">ConstructionData i
</span><a href="#local-6989586621679290210"><span class="hs-identifier hs-var">scp</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-220"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679290209"><span class="annot"><span class="annottext">err :: ASTError i
</span><a href="#local-6989586621679290209"><span class="hs-identifier hs-var">err</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either (ASTError i) (StorageClass i, [TokenLC i])
-&gt; Maybe (Either (ASTError i) (StorageClass i, [TokenLC i]))
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Either (ASTError i) (StorageClass i, [TokenLC i])
 -&gt; Maybe (Either (ASTError i) (StorageClass i, [TokenLC i])))
-&gt; Either (ASTError i) (StorageClass i, [TokenLC i])
-&gt; Maybe (Either (ASTError i) (StorageClass i, [TokenLC i]))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ASTError i -&gt; Either (ASTError i) (StorageClass i, [TokenLC i])
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">ASTError i
</span><a href="#local-6989586621679290209"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-221"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either (ASTError i) (StorageClass i, [TokenLC i])
-&gt; Maybe (Either (ASTError i) (StorageClass i, [TokenLC i]))
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Either (ASTError i) (StorageClass i, [TokenLC i])
 -&gt; Maybe (Either (ASTError i) (StorageClass i, [TokenLC i])))
-&gt; Either (ASTError i) (StorageClass i, [TokenLC i])
-&gt; Maybe (Either (ASTError i) (StorageClass i, [TokenLC i]))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ASTError i -&gt; Either (ASTError i) (StorageClass i, [TokenLC i])
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(ASTError i -&gt; Either (ASTError i) (StorageClass i, [TokenLC i]))
-&gt; ASTError i -&gt; Either (ASTError i) (StorageClass i, [TokenLC i])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[TokenLC i] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[TokenLC i]
</span><a href="#local-6989586621679290211"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;The expression is not constant-expression&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TokenLC i
</span><a href="#local-6989586621679290212"><span class="hs-identifier hs-var">cur</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;The expression '&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Token i -&gt; Text
forall a. Show a =&gt; a -&gt; Text
</span><a href="Htcc.Utils.Text.html#tshow"><span class="hs-identifier hs-var">tshow</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TokenLC i -&gt; Token i
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">(TokenLC i -&gt; Token i) -&gt; TokenLC i -&gt; Token i
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[TokenLC i] -&gt; TokenLC i
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">[TokenLC i]
</span><a href="#local-6989586621679290211"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="hs-string">&quot;' is not constant-expression&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[TokenLC i] -&gt; TokenLC i
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">[TokenLC i]
</span><a href="#local-6989586621679290211"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-222"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-type">HT.TKReserved</span></a></span><span> </span><span class="hs-string">&quot;]&quot;</span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679290208"><span class="annot"><span class="annottext">ds :: [TokenLC i]
</span><a href="#local-6989586621679290208"><span class="hs-identifier hs-var">ds</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679290207"><span class="annot"><span class="annottext">val :: i
</span><a href="#local-6989586621679290207"><span class="hs-identifier hs-var">val</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either (ASTError i) (StorageClass i, [TokenLC i])
-&gt; Maybe (Either (ASTError i) (StorageClass i, [TokenLC i]))
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Either (ASTError i) (StorageClass i, [TokenLC i])
 -&gt; Maybe (Either (ASTError i) (StorageClass i, [TokenLC i])))
-&gt; Either (ASTError i) (StorageClass i, [TokenLC i])
-&gt; Maybe (Either (ASTError i) (StorageClass i, [TokenLC i]))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Either (ASTError i) (StorageClass i, [TokenLC i])
-&gt; Maybe (Either (ASTError i) (StorageClass i, [TokenLC i]))
-&gt; (Either (ASTError i) (StorageClass i, [TokenLC i])
    -&gt; Either (ASTError i) (StorageClass i, [TokenLC i]))
-&gt; Either (ASTError i) (StorageClass i, [TokenLC i])
forall b a. b -&gt; Maybe a -&gt; (a -&gt; b) -&gt; b
</span><a href="Htcc.Utils.html#maybe%27"><span class="hs-identifier hs-var">maybe'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(StorageClass i, [TokenLC i])
-&gt; Either (ASTError i) (StorageClass i, [TokenLC i])
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(TypeKind i -&gt; TypeKind i) -&gt; StorageClass i -&gt; StorageClass i
forall (a :: * -&gt; *) i j.
TypeKindBase a =&gt;
(TypeKind i -&gt; TypeKind j) -&gt; a i -&gt; a j
</span><a href="Htcc.CRules.Types.TypeKind.html#mapTypeKind"><span class="hs-identifier hs-var">CT.mapTypeKind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Natural -&gt; TypeKind i -&gt; TypeKind i
forall i. Natural -&gt; TypeKind i -&gt; TypeKind i
</span><a href="Htcc.CRules.Types.TypeKind.html#CTArray"><span class="hs-identifier hs-var">CT.CTArray</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i -&gt; Natural
forall i. Integral i =&gt; i -&gt; Natural
</span><a href="Htcc.Utils.html#toNatural"><span class="hs-identifier hs-var">toNatural</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679290207"><span class="hs-identifier hs-var">val</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StorageClass i
</span><a href="#local-6989586621679290213"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[TokenLC i]
</span><a href="#local-6989586621679290208"><span class="hs-identifier hs-var">ds</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StorageClass i
-&gt; [TokenLC i]
-&gt; ConstructionData i
-&gt; Maybe (Either (ASTError i) (StorageClass i, [TokenLC i]))
forall i.
(Integral i, Bits i, Show i, Read i) =&gt;
StorageClass i
-&gt; [TokenLC i]
-&gt; ConstructionData i
-&gt; Maybe (Either (ASTError i) (StorageClass i, [TokenLC i]))
</span><a href="Htcc.Parser.Parsing.Type.html#arrayDeclSuffix"><span class="hs-identifier hs-var">arrayDeclSuffix</span></a></span><span> </span><span class="annot"><span class="annottext">StorageClass i
</span><a href="#local-6989586621679290213"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">[TokenLC i]
</span><a href="#local-6989586621679290208"><span class="hs-identifier hs-var">ds</span></a></span><span> </span><span class="annot"><span class="annottext">ConstructionData i
</span><a href="#local-6989586621679290210"><span class="hs-identifier hs-var">scp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Either (ASTError i) (StorageClass i, [TokenLC i])
  -&gt; Either (ASTError i) (StorageClass i, [TokenLC i]))
 -&gt; Either (ASTError i) (StorageClass i, [TokenLC i]))
-&gt; (Either (ASTError i) (StorageClass i, [TokenLC i])
    -&gt; Either (ASTError i) (StorageClass i, [TokenLC i]))
-&gt; Either (ASTError i) (StorageClass i, [TokenLC i])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-223"></span><span>        </span><span class="annot"><span class="annottext">(ASTError i -&gt; Either (ASTError i) (StorageClass i, [TokenLC i]))
-&gt; ((StorageClass i, [TokenLC i])
    -&gt; Either (ASTError i) (StorageClass i, [TokenLC i]))
-&gt; Either (ASTError i) (StorageClass i, [TokenLC i])
-&gt; Either (ASTError i) (StorageClass i, [TokenLC i])
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="annot"><span class="annottext">ASTError i -&gt; Either (ASTError i) (StorageClass i, [TokenLC i])
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(((StorageClass i, [TokenLC i])
  -&gt; Either (ASTError i) (StorageClass i, [TokenLC i]))
 -&gt; Either (ASTError i) (StorageClass i, [TokenLC i])
 -&gt; Either (ASTError i) (StorageClass i, [TokenLC i]))
-&gt; ((StorageClass i, [TokenLC i])
    -&gt; Either (ASTError i) (StorageClass i, [TokenLC i]))
-&gt; Either (ASTError i) (StorageClass i, [TokenLC i])
-&gt; Either (ASTError i) (StorageClass i, [TokenLC i])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679290205"><span class="annot"><span class="annottext">t' :: StorageClass i
</span><a href="#local-6989586621679290205"><span class="hs-identifier hs-var">t'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679290204"><span class="annot"><span class="annottext">ds' :: [TokenLC i]
</span><a href="#local-6989586621679290204"><span class="hs-identifier hs-var">ds'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either (ASTError i) (StorageClass i, [TokenLC i])
-&gt; Maybe (StorageClass i)
-&gt; (StorageClass i
    -&gt; Either (ASTError i) (StorageClass i, [TokenLC i]))
-&gt; Either (ASTError i) (StorageClass i, [TokenLC i])
forall b a. b -&gt; Maybe a -&gt; (a -&gt; b) -&gt; b
</span><a href="Htcc.Utils.html#maybe%27"><span class="hs-identifier hs-var">maybe'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StorageClass i -&gt; Either (ASTError i) (StorageClass i, [TokenLC i])
forall a b. Show a =&gt; a -&gt; Either (ASTError i) b
</span><a href="#local-6989586621679290203"><span class="hs-identifier hs-var">errSt</span></a></span><span> </span><span class="annot"><span class="annottext">StorageClass i
</span><a href="#local-6989586621679290205"><span class="hs-identifier hs-var">t'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StorageClass i -&gt; StorageClass i -&gt; Maybe (StorageClass i)
forall (a :: * -&gt; *) i.
(TypeKindBase a, Ord i) =&gt;
a i -&gt; a i -&gt; Maybe (a i)
</span><a href="Htcc.CRules.Types.TypeKind.html#concatCTArray"><span class="hs-identifier hs-var">CT.concatCTArray</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(TypeKind i -&gt; TypeKind i) -&gt; StorageClass i -&gt; StorageClass i
forall (a :: * -&gt; *) i j.
TypeKindBase a =&gt;
(TypeKind i -&gt; TypeKind j) -&gt; a i -&gt; a j
</span><a href="Htcc.CRules.Types.TypeKind.html#mapTypeKind"><span class="hs-identifier hs-var">CT.mapTypeKind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Natural -&gt; TypeKind i -&gt; TypeKind i
forall i. Natural -&gt; TypeKind i -&gt; TypeKind i
</span><a href="Htcc.CRules.Types.TypeKind.html#CTArray"><span class="hs-identifier hs-var">CT.CTArray</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i -&gt; Natural
forall i. Integral i =&gt; i -&gt; Natural
</span><a href="Htcc.Utils.html#toNatural"><span class="hs-identifier hs-var">toNatural</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679290207"><span class="hs-identifier hs-var">val</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StorageClass i
</span><a href="#local-6989586621679290213"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StorageClass i
</span><a href="#local-6989586621679290205"><span class="hs-identifier hs-var">t'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((StorageClass i
  -&gt; Either (ASTError i) (StorageClass i, [TokenLC i]))
 -&gt; Either (ASTError i) (StorageClass i, [TokenLC i]))
-&gt; (StorageClass i
    -&gt; Either (ASTError i) (StorageClass i, [TokenLC i]))
-&gt; Either (ASTError i) (StorageClass i, [TokenLC i])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679290202"><span class="annot"><span class="annottext">ty :: StorageClass i
</span><a href="#local-6989586621679290202"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">StorageClass i -&gt; Bool
forall (a :: * -&gt; *) i. (IncompleteBase a, Ord i) =&gt; a i -&gt; Bool
</span><a href="Htcc.CRules.Types.TypeKind.html#isValidIncomplete"><span class="hs-identifier hs-var">CT.isValidIncomplete</span></a></span><span> </span><span class="annot"><span class="annottext">StorageClass i
</span><a href="#local-6989586621679290202"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">(StorageClass i, [TokenLC i])
-&gt; Either (ASTError i) (StorageClass i, [TokenLC i])
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StorageClass i
</span><a href="#local-6989586621679290202"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[TokenLC i]
</span><a href="#local-6989586621679290204"><span class="hs-identifier hs-var">ds'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">StorageClass i -&gt; Either (ASTError i) (StorageClass i, [TokenLC i])
forall a b. Show a =&gt; a -&gt; Either (ASTError i) b
</span><a href="#local-6989586621679290203"><span class="hs-identifier hs-var">errSt</span></a></span><span> </span><span class="annot"><span class="annottext">StorageClass i
</span><a href="#local-6989586621679290205"><span class="hs-identifier hs-var">t'</span></a></span><span>
</span><span id="line-224"></span><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either (ASTError i) (StorageClass i, [TokenLC i])
-&gt; Maybe (Either (ASTError i) (StorageClass i, [TokenLC i]))
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Either (ASTError i) (StorageClass i, [TokenLC i])
 -&gt; Maybe (Either (ASTError i) (StorageClass i, [TokenLC i])))
-&gt; Either (ASTError i) (StorageClass i, [TokenLC i])
-&gt; Maybe (Either (ASTError i) (StorageClass i, [TokenLC i]))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ASTError i -&gt; Either (ASTError i) (StorageClass i, [TokenLC i])
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;expected storage size after '[' token&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TokenLC i
</span><a href="#local-6989586621679290212"><span class="hs-identifier hs-var">cur</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-225"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-226"></span><span>        </span><span id="local-6989586621679290203"><span class="annot"><span class="annottext">errSt :: a -&gt; Either (ASTError i) b
</span><a href="#local-6989586621679290203"><span class="hs-identifier hs-var hs-var">errSt</span></a></span></span><span> </span><span id="local-6989586621679290200"><span class="annot"><span class="annottext">t' :: a
</span><a href="#local-6989586621679290200"><span class="hs-identifier hs-var">t'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ASTError i -&gt; Either (ASTError i) b
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;array type has incomplete element type '&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Text
forall a. Show a =&gt; a -&gt; Text
</span><a href="Htcc.Utils.Text.html#tshow"><span class="hs-identifier hs-var">tshow</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679290200"><span class="hs-identifier hs-var">t'</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="hs-string">&quot;'&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TokenLC i
</span><a href="#local-6989586621679290212"><span class="hs-identifier hs-var">cur</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-227"></span><span class="annot"><a href="Htcc.Parser.Parsing.Type.html#arrayDeclSuffix"><span class="hs-identifier hs-var">arrayDeclSuffix</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Either (ASTError i) (StorageClass i, [TokenLC i]))
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-228"></span><span>
</span><span id="line-229"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Htcc.Parser.Parsing.Type.html#isTypeName"><span class="hs-pragma hs-type">isTypeName</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-230"></span><span class="hs-comment">-- | `isTypeName` returns @True@ if the token is a type name, @False@ otherwise.</span><span>
</span><span id="line-231"></span><span id="local-6989586621679290199"><span class="annot"><a href="Htcc.Parser.Parsing.Type.html#isTypeName"><span class="hs-identifier hs-type">isTypeName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Htcc.Tokenizer.Token.html#TokenLC"><span class="hs-identifier hs-type">HT.TokenLC</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679290199"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Htcc.Parser.ConstructionData.Core.html#ConstructionData"><span class="hs-identifier hs-type">ConstructionData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679290199"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-232"></span><span id="isTypeName"><span class="annot"><span class="annottext">isTypeName :: TokenLC i -&gt; ConstructionData i -&gt; Bool
</span><a href="Htcc.Parser.Parsing.Type.html#isTypeName"><span class="hs-identifier hs-var hs-var">isTypeName</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Htcc.Tokenizer.Token.html#TKType"><span class="hs-identifier hs-type">HT.TKType</span></a></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-233"></span><span class="annot"><a href="Htcc.Parser.Parsing.Type.html#isTypeName"><span class="hs-identifier hs-var">isTypeName</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Htcc.Tokenizer.Token.html#TKStruct"><span class="hs-identifier hs-type">HT.TKStruct</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-234"></span><span class="annot"><a href="Htcc.Parser.Parsing.Type.html#isTypeName"><span class="hs-identifier hs-var">isTypeName</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Htcc.Tokenizer.Token.html#TKEnum"><span class="hs-identifier hs-type">HT.TKEnum</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-235"></span><span class="annot"><a href="Htcc.Parser.Parsing.Type.html#isTypeName"><span class="hs-identifier hs-var">isTypeName</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-type">HT.TKReserved</span></a></span><span> </span><span class="hs-string">&quot;static&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-236"></span><span class="annot"><a href="Htcc.Parser.Parsing.Type.html#isTypeName"><span class="hs-identifier hs-var">isTypeName</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-type">HT.TKReserved</span></a></span><span> </span><span class="hs-string">&quot;auto&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-237"></span><span class="annot"><a href="Htcc.Parser.Parsing.Type.html#isTypeName"><span class="hs-identifier hs-var">isTypeName</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Htcc.Tokenizer.Token.html#TKReserved"><span class="hs-identifier hs-type">HT.TKReserved</span></a></span><span> </span><span class="hs-string">&quot;register&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-238"></span><span class="annot"><a href="Htcc.Parser.Parsing.Type.html#isTypeName"><span class="hs-identifier hs-var">isTypeName</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Htcc.Tokenizer.Token.html#TKIdent"><span class="hs-identifier hs-type">HT.TKIdent</span></a></span><span> </span><span id="local-6989586621679290198"><span class="annot"><span class="annottext">ident :: Text
</span><a href="#local-6989586621679290198"><span class="hs-identifier hs-var">ident</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679290197"><span class="annot"><span class="annottext">scp :: ConstructionData i
</span><a href="#local-6989586621679290197"><span class="hs-identifier hs-var">scp</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Typedef i) -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isJust</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (Typedef i) -&gt; Bool) -&gt; Maybe (Typedef i) -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; ConstructionData i -&gt; Maybe (Typedef i)
forall i. Text -&gt; ConstructionData i -&gt; Maybe (Typedef i)
</span><a href="Htcc.Parser.ConstructionData.Core.html#lookupTypedef"><span class="hs-identifier hs-var">lookupTypedef</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679290198"><span class="hs-identifier hs-var">ident</span></a></span><span> </span><span class="annot"><span class="annottext">ConstructionData i
</span><a href="#local-6989586621679290197"><span class="hs-identifier hs-var">scp</span></a></span><span>
</span><span id="line-239"></span><span class="annot"><a href="Htcc.Parser.Parsing.Type.html#isTypeName"><span class="hs-identifier hs-var">isTypeName</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>                             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-240"></span><span>
</span><span id="line-241"></span><span class="hs-comment">-- | The `Just` represents an error during construction of the syntax tree, and the `Nothing` represents no valid constant expression.</span><span>
</span><span id="line-242"></span><span class="hs-keyword">type</span><span> </span><span id="ConstantResult"><span class="annot"><a href="Htcc.Parser.Parsing.Type.html#ConstantResult"><span class="hs-identifier hs-var">ConstantResult</span></a></span></span><span> </span><span id="local-6989586621679290196"><span class="annot"><a href="#local-6989586621679290196"><span class="hs-identifier hs-type">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Htcc.Parser.ConstructionData.Scope.ManagedScope.html#ASTError"><span class="hs-identifier hs-type">ASTError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679290196"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-243"></span><span>
</span><span id="line-244"></span><span class="hs-comment">-- | `constantExp` evaluates to a constant expression from token list.</span><span>
</span><span id="line-245"></span><span class="annot"><a href="Htcc.Parser.Parsing.Type.html#constantExp"><span class="hs-identifier hs-type">constantExp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679290590"><span class="annot"><a href="#local-6989586621679290590"><span class="hs-identifier hs-type">i</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Bits</span></span><span> </span><span class="annot"><a href="#local-6989586621679290590"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621679290590"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679290590"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Read</span></span><span> </span><span class="annot"><a href="#local-6989586621679290590"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Htcc.Tokenizer.Token.html#TokenLC"><span class="hs-identifier hs-type">HT.TokenLC</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679290590"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Htcc.Parser.ConstructionData.Core.html#ConstructionData"><span class="hs-identifier hs-type">ConstructionData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679290590"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Htcc.Parser.Parsing.Type.html#ConstantResult"><span class="hs-identifier hs-type">ConstantResult</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679290590"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="Htcc.Tokenizer.Token.html#TokenLC"><span class="hs-identifier hs-type">HT.TokenLC</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679290590"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679290590"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-246"></span><span id="constantExp"><span class="annot"><span class="annottext">constantExp :: [TokenLC i]
-&gt; ConstructionData i -&gt; Either (ConstantResult i) ([TokenLC i], i)
</span><a href="Htcc.Parser.Parsing.Type.html#constantExp"><span class="hs-identifier hs-var hs-var">constantExp</span></a></span></span><span> </span><span id="local-6989586621679290195"><span class="annot"><span class="annottext">tk :: [TokenLC i]
</span><a href="#local-6989586621679290195"><span class="hs-identifier hs-var">tk</span></a></span></span><span> </span><span id="local-6989586621679290194"><span class="annot"><span class="annottext">scp :: ConstructionData i
</span><a href="#local-6989586621679290194"><span class="hs-identifier hs-var">scp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((ASTSuccess i -&gt; Either (ConstantResult i) ([TokenLC i], i))
 -&gt; Either (ASTError i) (ASTSuccess i)
 -&gt; Either (ConstantResult i) ([TokenLC i], i))
-&gt; Either (ASTError i) (ASTSuccess i)
-&gt; (ASTSuccess i -&gt; Either (ConstantResult i) ([TokenLC i], i))
-&gt; Either (ConstantResult i) ([TokenLC i], i)
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ASTError i -&gt; Either (ConstantResult i) ([TokenLC i], i))
-&gt; (ASTSuccess i -&gt; Either (ConstantResult i) ([TokenLC i], i))
-&gt; Either (ASTError i) (ASTSuccess i)
-&gt; Either (ConstantResult i) ([TokenLC i], i)
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConstantResult i -&gt; Either (ConstantResult i) ([TokenLC i], i)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(ConstantResult i -&gt; Either (ConstantResult i) ([TokenLC i], i))
-&gt; (ASTError i -&gt; ConstantResult i)
-&gt; ASTError i
-&gt; Either (ConstantResult i) ([TokenLC i], i)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ASTError i -&gt; ConstantResult i
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TokenLC i]
-&gt; ATree i
-&gt; ConstructionData i
-&gt; Either (ASTError i) (ASTSuccess i)
forall i.
(Show i, Read i, Integral i, Bits i) =&gt;
[TokenLC i] -&gt; ATree i -&gt; ConstructionData i -&gt; ASTConstruction i
</span><a href="Htcc.Parser.Parsing.Core.html#conditional"><span class="hs-identifier hs-var">conditional</span></a></span><span> </span><span class="annot"><span class="annottext">[TokenLC i]
</span><a href="#local-6989586621679290195"><span class="hs-identifier hs-var">tk</span></a></span><span> </span><span class="annot"><span class="annottext">ATree i
forall a. ATree a
</span><a href="Htcc.Parser.AST.Core.html#ATEmpty"><span class="hs-identifier hs-var">ATEmpty</span></a></span><span> </span><span class="annot"><span class="annottext">ConstructionData i
</span><a href="#local-6989586621679290194"><span class="hs-identifier hs-var">scp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((ASTSuccess i -&gt; Either (ConstantResult i) ([TokenLC i], i))
 -&gt; Either (ConstantResult i) ([TokenLC i], i))
-&gt; (ASTSuccess i -&gt; Either (ConstantResult i) ([TokenLC i], i))
-&gt; Either (ConstantResult i) ([TokenLC i], i)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679290191"><span class="annot"><span class="annottext">ds :: [TokenLC i]
</span><a href="#local-6989586621679290191"><span class="hs-identifier hs-var">ds</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679290190"><span class="annot"><span class="annottext">at :: ATree i
</span><a href="#local-6989586621679290190"><span class="hs-identifier hs-var">at</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-247"></span><span>    </span><span class="annot"><span class="annottext">Either (ConstantResult i) ([TokenLC i], i)
-&gt; (i -&gt; Either (ConstantResult i) ([TokenLC i], i))
-&gt; Maybe i
-&gt; Either (ConstantResult i) ([TokenLC i], i)
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConstantResult i -&gt; Either (ConstantResult i) ([TokenLC i], i)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">ConstantResult i
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([TokenLC i], i) -&gt; Either (ConstantResult i) ([TokenLC i], i)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(([TokenLC i], i) -&gt; Either (ConstantResult i) ([TokenLC i], i))
-&gt; (i -&gt; ([TokenLC i], i))
-&gt; i
-&gt; Either (ConstantResult i) ([TokenLC i], i)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TokenLC i]
</span><a href="#local-6989586621679290191"><span class="hs-identifier hs-var">ds</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe i -&gt; Either (ConstantResult i) ([TokenLC i], i))
-&gt; Maybe i -&gt; Either (ConstantResult i) ([TokenLC i], i)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ATree i -&gt; Maybe i
</span><a href="#local-6989586621679290189"><span class="hs-identifier hs-var">evalConstantExp</span></a></span><span> </span><span class="annot"><span class="annottext">ATree i
</span><a href="#local-6989586621679290190"><span class="hs-identifier hs-var">at</span></a></span><span>
</span><span id="line-248"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-249"></span><span>        </span><span class="annot"><a href="#local-6989586621679290189"><span class="hs-identifier hs-type">evalConstantExp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Htcc.Parser.AST.Core.html#ATree"><span class="hs-identifier hs-type">ATree</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679290590"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679290590"><span class="hs-identifier hs-type">i</span></a></span><span>
</span><span id="line-250"></span><span>        </span><span id="local-6989586621679290189"><span class="annot"><span class="annottext">evalConstantExp :: ATree i -&gt; Maybe i
</span><a href="#local-6989586621679290189"><span class="hs-identifier hs-var hs-var">evalConstantExp</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Htcc.Parser.AST.Core.html#ATNode"><span class="hs-identifier hs-type">ATNode</span></a></span><span> </span><span id="local-6989586621679290187"><span class="annot"><span class="annottext">k :: ATKind i
</span><a href="#local-6989586621679290187"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679290186"><span class="annot"><span class="annottext">lhs :: ATree i
</span><a href="#local-6989586621679290186"><span class="hs-identifier hs-var">lhs</span></a></span></span><span> </span><span id="local-6989586621679290185"><span class="annot"><span class="annottext">rhs :: ATree i
</span><a href="#local-6989586621679290185"><span class="hs-identifier hs-var">rhs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679290184"><span class="annot"><span class="annottext">fromBool :: Bool -&gt; i
</span><a href="#local-6989586621679290184"><span class="hs-identifier hs-var hs-var">fromBool</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; i
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; i) -&gt; (Bool -&gt; Int) -&gt; Bool -&gt; i
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Int
forall a. Enum a =&gt; a -&gt; Int
</span><span class="hs-identifier hs-var">fromEnum</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679290590"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ATKind i
</span><a href="#local-6989586621679290187"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-251"></span><span>            </span><span class="annot"><a href="Htcc.Parser.AST.Core.html#ATAdd"><span class="hs-identifier hs-type">ATAdd</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(i -&gt; i -&gt; i) -&gt; Maybe i
forall a b. (Integral a, Num b) =&gt; (i -&gt; i -&gt; a) -&gt; Maybe b
</span><a href="#local-6989586621679290181"><span class="hs-identifier hs-var">binop</span></a></span><span> </span><span class="annot"><span class="annottext">i -&gt; i -&gt; i
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(+)</span></span><span>
</span><span id="line-252"></span><span>            </span><span class="annot"><a href="Htcc.Parser.AST.Core.html#ATSub"><span class="hs-identifier hs-type">ATSub</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(i -&gt; i -&gt; i) -&gt; Maybe i
forall a b. (Integral a, Num b) =&gt; (i -&gt; i -&gt; a) -&gt; Maybe b
</span><a href="#local-6989586621679290181"><span class="hs-identifier hs-var">binop</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-special">)</span><span>
</span><span id="line-253"></span><span>            </span><span class="annot"><a href="Htcc.Parser.AST.Core.html#ATMul"><span class="hs-identifier hs-type">ATMul</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(i -&gt; i -&gt; i) -&gt; Maybe i
forall a b. (Integral a, Num b) =&gt; (i -&gt; i -&gt; a) -&gt; Maybe b
</span><a href="#local-6989586621679290181"><span class="hs-identifier hs-var">binop</span></a></span><span> </span><span class="annot"><span class="annottext">i -&gt; i -&gt; i
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(*)</span></span><span>
</span><span id="line-254"></span><span>            </span><span class="annot"><a href="Htcc.Parser.AST.Core.html#ATDiv"><span class="hs-identifier hs-type">ATDiv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(i -&gt; i -&gt; i) -&gt; Maybe i
forall a b. (Integral a, Num b) =&gt; (i -&gt; i -&gt; a) -&gt; Maybe b
</span><a href="#local-6989586621679290181"><span class="hs-identifier hs-var">binop</span></a></span><span> </span><span class="annot"><span class="annottext">i -&gt; i -&gt; i
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">div</span></span><span>
</span><span id="line-255"></span><span>            </span><span class="annot"><a href="Htcc.Parser.AST.Core.html#ATAnd"><span class="hs-identifier hs-type">ATAnd</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(i -&gt; i -&gt; i) -&gt; Maybe i
forall a b. (Integral a, Num b) =&gt; (i -&gt; i -&gt; a) -&gt; Maybe b
</span><a href="#local-6989586621679290181"><span class="hs-identifier hs-var">binop</span></a></span><span> </span><span class="annot"><span class="annottext">i -&gt; i -&gt; i
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(.&amp;.)</span></span><span>
</span><span id="line-256"></span><span>            </span><span class="annot"><a href="Htcc.Parser.AST.Core.html#ATXor"><span class="hs-identifier hs-type">ATXor</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(i -&gt; i -&gt; i) -&gt; Maybe i
forall a b. (Integral a, Num b) =&gt; (i -&gt; i -&gt; a) -&gt; Maybe b
</span><a href="#local-6989586621679290181"><span class="hs-identifier hs-var">binop</span></a></span><span> </span><span class="annot"><span class="annottext">i -&gt; i -&gt; i
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">xor</span></span><span>
</span><span id="line-257"></span><span>            </span><span class="annot"><a href="Htcc.Parser.AST.Core.html#ATOr"><span class="hs-identifier hs-type">ATOr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(i -&gt; i -&gt; i) -&gt; Maybe i
forall a b. (Integral a, Num b) =&gt; (i -&gt; i -&gt; a) -&gt; Maybe b
</span><a href="#local-6989586621679290181"><span class="hs-identifier hs-var">binop</span></a></span><span> </span><span class="annot"><span class="annottext">i -&gt; i -&gt; i
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(.|.)</span></span><span>
</span><span id="line-258"></span><span>            </span><span class="annot"><a href="Htcc.Parser.AST.Core.html#ATShl"><span class="hs-identifier hs-type">ATShl</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(i -&gt; i -&gt; i) -&gt; Maybe i
forall a b. (Integral a, Num b) =&gt; (i -&gt; i -&gt; a) -&gt; Maybe b
</span><a href="#local-6989586621679290181"><span class="hs-identifier hs-var">binop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Int -&gt; i) -&gt; (i -&gt; Int) -&gt; i -&gt; i)
-&gt; (i -&gt; Int) -&gt; (Int -&gt; i) -&gt; i -&gt; i
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; i) -&gt; (i -&gt; Int) -&gt; i -&gt; i
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">(.)</span></span><span> </span><span class="annot"><span class="annottext">i -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">((Int -&gt; i) -&gt; i -&gt; i) -&gt; (i -&gt; Int -&gt; i) -&gt; i -&gt; i -&gt; i
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">i -&gt; Int -&gt; i
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-identifier hs-var">shiftL</span></span><span class="hs-special">)</span><span>
</span><span id="line-259"></span><span>            </span><span class="annot"><a href="Htcc.Parser.AST.Core.html#ATShr"><span class="hs-identifier hs-type">ATShr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(i -&gt; i -&gt; i) -&gt; Maybe i
forall a b. (Integral a, Num b) =&gt; (i -&gt; i -&gt; a) -&gt; Maybe b
</span><a href="#local-6989586621679290181"><span class="hs-identifier hs-var">binop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Int -&gt; i) -&gt; (i -&gt; Int) -&gt; i -&gt; i)
-&gt; (i -&gt; Int) -&gt; (Int -&gt; i) -&gt; i -&gt; i
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; i) -&gt; (i -&gt; Int) -&gt; i -&gt; i
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">(.)</span></span><span> </span><span class="annot"><span class="annottext">i -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">((Int -&gt; i) -&gt; i -&gt; i) -&gt; (i -&gt; Int -&gt; i) -&gt; i -&gt; i -&gt; i
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">i -&gt; Int -&gt; i
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-identifier hs-var">shiftR</span></span><span class="hs-special">)</span><span>
</span><span id="line-260"></span><span>            </span><span class="annot"><a href="Htcc.Parser.AST.Core.html#ATEQ"><span class="hs-identifier hs-type">ATEQ</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(i -&gt; i -&gt; i) -&gt; Maybe i
forall a b. (Integral a, Num b) =&gt; (i -&gt; i -&gt; a) -&gt; Maybe b
</span><a href="#local-6989586621679290181"><span class="hs-identifier hs-var">binop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Bool -&gt; i) -&gt; (i -&gt; Bool) -&gt; i -&gt; i
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">(.)</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; i
</span><a href="#local-6989586621679290184"><span class="hs-identifier hs-var">fromBool</span></a></span><span> </span><span class="annot"><span class="annottext">((i -&gt; Bool) -&gt; i -&gt; i) -&gt; (i -&gt; i -&gt; Bool) -&gt; i -&gt; i -&gt; i
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">i -&gt; i -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(==)</span></span><span class="hs-special">)</span><span>
</span><span id="line-261"></span><span>            </span><span class="annot"><a href="Htcc.Parser.AST.Core.html#ATNEQ"><span class="hs-identifier hs-type">ATNEQ</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(i -&gt; i -&gt; i) -&gt; Maybe i
forall a b. (Integral a, Num b) =&gt; (i -&gt; i -&gt; a) -&gt; Maybe b
</span><a href="#local-6989586621679290181"><span class="hs-identifier hs-var">binop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Bool -&gt; i) -&gt; (i -&gt; Bool) -&gt; i -&gt; i
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">(.)</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; i
</span><a href="#local-6989586621679290184"><span class="hs-identifier hs-var">fromBool</span></a></span><span> </span><span class="annot"><span class="annottext">((i -&gt; Bool) -&gt; i -&gt; i) -&gt; (i -&gt; i -&gt; Bool) -&gt; i -&gt; i -&gt; i
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">i -&gt; i -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(/=)</span></span><span class="hs-special">)</span><span>
</span><span id="line-262"></span><span>            </span><span class="annot"><a href="Htcc.Parser.AST.Core.html#ATLT"><span class="hs-identifier hs-type">ATLT</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(i -&gt; i -&gt; i) -&gt; Maybe i
forall a b. (Integral a, Num b) =&gt; (i -&gt; i -&gt; a) -&gt; Maybe b
</span><a href="#local-6989586621679290181"><span class="hs-identifier hs-var">binop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Bool -&gt; i) -&gt; (i -&gt; Bool) -&gt; i -&gt; i
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">(.)</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; i
</span><a href="#local-6989586621679290184"><span class="hs-identifier hs-var">fromBool</span></a></span><span> </span><span class="annot"><span class="annottext">((i -&gt; Bool) -&gt; i -&gt; i) -&gt; (i -&gt; i -&gt; Bool) -&gt; i -&gt; i -&gt; i
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">i -&gt; i -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(&lt;)</span></span><span class="hs-special">)</span><span>
</span><span id="line-263"></span><span>            </span><span class="annot"><a href="Htcc.Parser.AST.Core.html#ATGT"><span class="hs-identifier hs-type">ATGT</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(i -&gt; i -&gt; i) -&gt; Maybe i
forall a b. (Integral a, Num b) =&gt; (i -&gt; i -&gt; a) -&gt; Maybe b
</span><a href="#local-6989586621679290181"><span class="hs-identifier hs-var">binop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Bool -&gt; i) -&gt; (i -&gt; Bool) -&gt; i -&gt; i
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">(.)</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; i
</span><a href="#local-6989586621679290184"><span class="hs-identifier hs-var">fromBool</span></a></span><span> </span><span class="annot"><span class="annottext">((i -&gt; Bool) -&gt; i -&gt; i) -&gt; (i -&gt; i -&gt; Bool) -&gt; i -&gt; i -&gt; i
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">i -&gt; i -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(&gt;)</span></span><span class="hs-special">)</span><span>
</span><span id="line-264"></span><span>            </span><span class="annot"><a href="Htcc.Parser.AST.Core.html#ATLEQ"><span class="hs-identifier hs-type">ATLEQ</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(i -&gt; i -&gt; i) -&gt; Maybe i
forall a b. (Integral a, Num b) =&gt; (i -&gt; i -&gt; a) -&gt; Maybe b
</span><a href="#local-6989586621679290181"><span class="hs-identifier hs-var">binop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Bool -&gt; i) -&gt; (i -&gt; Bool) -&gt; i -&gt; i
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">(.)</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; i
</span><a href="#local-6989586621679290184"><span class="hs-identifier hs-var">fromBool</span></a></span><span> </span><span class="annot"><span class="annottext">((i -&gt; Bool) -&gt; i -&gt; i) -&gt; (i -&gt; i -&gt; Bool) -&gt; i -&gt; i -&gt; i
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">i -&gt; i -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(&lt;=)</span></span><span class="hs-special">)</span><span>
</span><span id="line-265"></span><span>            </span><span class="annot"><a href="Htcc.Parser.AST.Core.html#ATGEQ"><span class="hs-identifier hs-type">ATGEQ</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(i -&gt; i -&gt; i) -&gt; Maybe i
forall a b. (Integral a, Num b) =&gt; (i -&gt; i -&gt; a) -&gt; Maybe b
</span><a href="#local-6989586621679290181"><span class="hs-identifier hs-var">binop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Bool -&gt; i) -&gt; (i -&gt; Bool) -&gt; i -&gt; i
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">(.)</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; i
</span><a href="#local-6989586621679290184"><span class="hs-identifier hs-var">fromBool</span></a></span><span> </span><span class="annot"><span class="annottext">((i -&gt; Bool) -&gt; i -&gt; i) -&gt; (i -&gt; i -&gt; Bool) -&gt; i -&gt; i -&gt; i
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">i -&gt; i -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(&gt;=)</span></span><span class="hs-special">)</span><span>
</span><span id="line-266"></span><span>            </span><span class="annot"><a href="Htcc.Parser.AST.Core.html#ATConditional"><span class="hs-identifier hs-type">ATConditional</span></a></span><span> </span><span id="local-6989586621679290154"><span class="annot"><span class="annottext">cn :: ATree i
</span><a href="#local-6989586621679290154"><span class="hs-identifier hs-var">cn</span></a></span></span><span> </span><span id="local-6989586621679290153"><span class="annot"><span class="annottext">th :: ATree i
</span><a href="#local-6989586621679290153"><span class="hs-identifier hs-var">th</span></a></span></span><span> </span><span id="local-6989586621679290152"><span class="annot"><span class="annottext">el :: ATree i
</span><a href="#local-6989586621679290152"><span class="hs-identifier hs-var">el</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ATree i -&gt; Maybe i
</span><a href="#local-6989586621679290189"><span class="hs-identifier hs-var">evalConstantExp</span></a></span><span> </span><span class="annot"><span class="annottext">ATree i
</span><a href="#local-6989586621679290154"><span class="hs-identifier hs-var">cn</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe i -&gt; (i -&gt; Maybe i) -&gt; Maybe i
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Maybe i -&gt; Maybe i -&gt; Bool -&gt; Maybe i
forall a. a -&gt; a -&gt; Bool -&gt; a
</span><span class="hs-identifier hs-var">bool</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ATree i -&gt; Maybe i
</span><a href="#local-6989586621679290189"><span class="hs-identifier hs-var">evalConstantExp</span></a></span><span> </span><span class="annot"><span class="annottext">ATree i
</span><a href="#local-6989586621679290152"><span class="hs-identifier hs-var">el</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ATree i -&gt; Maybe i
</span><a href="#local-6989586621679290189"><span class="hs-identifier hs-var">evalConstantExp</span></a></span><span> </span><span class="annot"><span class="annottext">ATree i
</span><a href="#local-6989586621679290153"><span class="hs-identifier hs-var">th</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Maybe i) -&gt; (i -&gt; Bool) -&gt; i -&gt; Maybe i
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">i -&gt; Bool
forall a. (Eq a, Num a) =&gt; a -&gt; Bool
</span><a href="#local-6989586621679290151"><span class="hs-identifier hs-var">castBool</span></a></span><span>
</span><span id="line-267"></span><span>            </span><span class="annot"><a href="Htcc.Parser.AST.Core.html#ATComma"><span class="hs-identifier hs-type">ATComma</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ATree i -&gt; Maybe i
</span><a href="#local-6989586621679290189"><span class="hs-identifier hs-var">evalConstantExp</span></a></span><span> </span><span class="annot"><span class="annottext">ATree i
</span><a href="#local-6989586621679290185"><span class="hs-identifier hs-var">rhs</span></a></span><span>
</span><span id="line-268"></span><span>            </span><span class="annot"><a href="Htcc.Parser.AST.Core.html#ATNot"><span class="hs-identifier hs-type">ATNot</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="annot"><span class="annottext">Int -&gt; i
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; i) -&gt; (i -&gt; Int) -&gt; i -&gt; i
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Int
forall a. Enum a =&gt; a -&gt; Int
</span><span class="hs-identifier hs-var">fromEnum</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Int) -&gt; (i -&gt; Bool) -&gt; i -&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; (i -&gt; Bool) -&gt; i -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">i -&gt; Bool
forall a. (Eq a, Num a) =&gt; a -&gt; Bool
</span><a href="#local-6989586621679290151"><span class="hs-identifier hs-var">castBool</span></a></span><span> </span><span class="annot"><span class="annottext">(i -&gt; i) -&gt; Maybe i -&gt; Maybe i
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ATree i -&gt; Maybe i
</span><a href="#local-6989586621679290189"><span class="hs-identifier hs-var">evalConstantExp</span></a></span><span> </span><span class="annot"><span class="annottext">ATree i
</span><a href="#local-6989586621679290186"><span class="hs-identifier hs-var">lhs</span></a></span><span>
</span><span id="line-269"></span><span>            </span><span class="annot"><a href="Htcc.Parser.AST.Core.html#ATBitNot"><span class="hs-identifier hs-type">ATBitNot</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">i -&gt; i
forall a. Bits a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">complement</span></span><span> </span><span class="annot"><span class="annottext">(i -&gt; i) -&gt; Maybe i -&gt; Maybe i
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ATree i -&gt; Maybe i
</span><a href="#local-6989586621679290189"><span class="hs-identifier hs-var">evalConstantExp</span></a></span><span> </span><span class="annot"><span class="annottext">ATree i
</span><a href="#local-6989586621679290186"><span class="hs-identifier hs-var">lhs</span></a></span><span>
</span><span id="line-270"></span><span>            </span><span class="annot"><a href="Htcc.Parser.AST.Core.html#ATLAnd"><span class="hs-identifier hs-type">ATLAnd</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(i -&gt; i -&gt; i) -&gt; Maybe i
forall a b. (Integral a, Num b) =&gt; (i -&gt; i -&gt; a) -&gt; Maybe b
</span><a href="#local-6989586621679290181"><span class="hs-identifier hs-var">binop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Bool -&gt; i) -&gt; (i -&gt; Bool) -&gt; i -&gt; i
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">(.)</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; i
</span><a href="#local-6989586621679290184"><span class="hs-identifier hs-var">fromBool</span></a></span><span> </span><span class="annot"><span class="annottext">((i -&gt; Bool) -&gt; i -&gt; i) -&gt; (i -&gt; i -&gt; Bool) -&gt; i -&gt; i -&gt; i
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((Bool -&gt; Bool) -&gt; (i -&gt; Bool) -&gt; i -&gt; Bool)
-&gt; (i -&gt; Bool) -&gt; (Bool -&gt; Bool) -&gt; i -&gt; Bool
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; (i -&gt; Bool) -&gt; i -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">(.)</span></span><span> </span><span class="annot"><span class="annottext">i -&gt; Bool
forall a. (Eq a, Num a) =&gt; a -&gt; Bool
</span><a href="#local-6989586621679290151"><span class="hs-identifier hs-var">castBool</span></a></span><span> </span><span class="annot"><span class="annottext">((Bool -&gt; Bool) -&gt; i -&gt; Bool)
-&gt; (i -&gt; Bool -&gt; Bool) -&gt; i -&gt; i -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">(&amp;&amp;)</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool -&gt; Bool) -&gt; (i -&gt; Bool) -&gt; i -&gt; Bool -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">i -&gt; Bool
forall a. (Eq a, Num a) =&gt; a -&gt; Bool
</span><a href="#local-6989586621679290151"><span class="hs-identifier hs-var">castBool</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-271"></span><span>            </span><span class="annot"><a href="Htcc.Parser.AST.Core.html#ATLOr"><span class="hs-identifier hs-type">ATLOr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(i -&gt; i -&gt; i) -&gt; Maybe i
forall a b. (Integral a, Num b) =&gt; (i -&gt; i -&gt; a) -&gt; Maybe b
</span><a href="#local-6989586621679290181"><span class="hs-identifier hs-var">binop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Bool -&gt; i) -&gt; (i -&gt; Bool) -&gt; i -&gt; i
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">(.)</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; i
</span><a href="#local-6989586621679290184"><span class="hs-identifier hs-var">fromBool</span></a></span><span> </span><span class="annot"><span class="annottext">((i -&gt; Bool) -&gt; i -&gt; i) -&gt; (i -&gt; i -&gt; Bool) -&gt; i -&gt; i -&gt; i
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((Bool -&gt; Bool) -&gt; (i -&gt; Bool) -&gt; i -&gt; Bool)
-&gt; (i -&gt; Bool) -&gt; (Bool -&gt; Bool) -&gt; i -&gt; Bool
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; (i -&gt; Bool) -&gt; i -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">(.)</span></span><span> </span><span class="annot"><span class="annottext">i -&gt; Bool
forall a. (Eq a, Num a) =&gt; a -&gt; Bool
</span><a href="#local-6989586621679290151"><span class="hs-identifier hs-var">castBool</span></a></span><span> </span><span class="annot"><span class="annottext">((Bool -&gt; Bool) -&gt; i -&gt; Bool)
-&gt; (i -&gt; Bool -&gt; Bool) -&gt; i -&gt; i -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">(||)</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool -&gt; Bool) -&gt; (i -&gt; Bool) -&gt; i -&gt; Bool -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">i -&gt; Bool
forall a. (Eq a, Num a) =&gt; a -&gt; Bool
</span><a href="#local-6989586621679290151"><span class="hs-identifier hs-var">castBool</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-272"></span><span>            </span><span class="annot"><a href="Htcc.Parser.AST.Core.html#ATNum"><span class="hs-identifier hs-type">ATNum</span></a></span><span> </span><span id="local-6989586621679290140"><span class="annot"><span class="annottext">v :: i
</span><a href="#local-6989586621679290140"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">i -&gt; Maybe i
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679290140"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-273"></span><span>            </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe i
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-274"></span><span>            </span><span class="hs-keyword">where</span><span>
</span><span id="line-275"></span><span>                </span><span id="local-6989586621679290181"><span class="annot"><span class="annottext">binop :: (i -&gt; i -&gt; a) -&gt; Maybe b
</span><a href="#local-6989586621679290181"><span class="hs-identifier hs-var hs-var">binop</span></a></span></span><span> </span><span id="local-6989586621679290139"><span class="annot"><span class="annottext">f :: i -&gt; i -&gt; a
</span><a href="#local-6989586621679290139"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe i -&gt; (i -&gt; Maybe b) -&gt; Maybe b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">(&gt;&gt;=)</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ATree i -&gt; Maybe i
</span><a href="#local-6989586621679290189"><span class="hs-identifier hs-var">evalConstantExp</span></a></span><span> </span><span class="annot"><span class="annottext">ATree i
</span><a href="#local-6989586621679290186"><span class="hs-identifier hs-var">lhs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((i -&gt; Maybe b) -&gt; Maybe b) -&gt; (i -&gt; Maybe b) -&gt; Maybe b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679290138"><span class="annot"><span class="annottext">lhs' :: i
</span><a href="#local-6989586621679290138"><span class="hs-identifier hs-var">lhs'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; b
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; (i -&gt; a) -&gt; i -&gt; b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">i -&gt; i -&gt; a
</span><a href="#local-6989586621679290139"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679290138"><span class="hs-identifier hs-var">lhs'</span></a></span><span> </span><span class="annot"><span class="annottext">(i -&gt; b) -&gt; Maybe i -&gt; Maybe b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ATree i -&gt; Maybe i
</span><a href="#local-6989586621679290189"><span class="hs-identifier hs-var">evalConstantExp</span></a></span><span> </span><span class="annot"><span class="annottext">ATree i
</span><a href="#local-6989586621679290185"><span class="hs-identifier hs-var">rhs</span></a></span><span>
</span><span id="line-276"></span><span>                </span><span id="local-6989586621679290151"><span class="annot"><span class="annottext">castBool :: a -&gt; Bool
</span><a href="#local-6989586621679290151"><span class="hs-identifier hs-var hs-var">castBool</span></a></span></span><span> </span><span id="local-6989586621679290137"><span class="annot"><span class="annottext">x :: a
</span><a href="#local-6989586621679290137"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679290137"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-277"></span><span>        </span><span class="annot"><a href="#local-6989586621679290189"><span class="hs-identifier hs-var">evalConstantExp</span></a></span><span> </span><span class="annot"><a href="Htcc.Parser.AST.Core.html#ATEmpty"><span class="hs-identifier hs-type">ATEmpty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe i
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-278"></span><span>
</span><span id="line-279"></span></pre></body></html>